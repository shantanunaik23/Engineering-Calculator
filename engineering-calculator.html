<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shan's Engineering Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, sans-serif; background: #f5f7fa; min-height: 100vh; padding: 1.5rem; }
        .container { max-width: 1200px; margin: 0 auto; }

        .header { background: white; padding: 1.25rem 2rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); margin-bottom: 1.5rem; border-left: 4px solid #2563eb; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }
        .header-content h1 { color: #1e293b; font-size: 1.6rem; font-weight: 700; }
        .header-content p  { color: #64748b; font-size: 0.875rem; margin-top: 2px; }
        .ai-status { display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap; }
        .ai-badge { padding: 0.45rem 0.9rem; border-radius: 6px; font-size: 0.8rem; font-weight: 600; display: flex; align-items: center; gap: 0.4rem; border: 1px solid; }
        .ai-badge.offline  { background:#f1f5f9; color:#64748b; border-color:#cbd5e1; }
        .ai-badge.online   { background:#dcfce7; color:#166534; border-color:#86efac; }
        .ai-badge.local    { background:#ede9fe; color:#5b21b6; border-color:#c4b5fd; }
        .ai-badge.loading  { background:#fef3c7; color:#92400e; border-color:#fde68a; }
        .hdr-btn { padding: 0.45rem 1rem; border: none; border-radius: 6px; font-size: 0.85rem; font-weight: 500; cursor: pointer; transition: background 0.2s; }
        .hdr-btn.connect    { background:#2563eb; color:white; }
        .hdr-btn.connect:hover { background:#1d4ed8; }
        .hdr-btn.disconnect { background:#64748b; color:white; }
        .hdr-btn.disconnect:hover { background:#475569; }

        #localProgress { display: none; background: white; padding: 1.25rem 1.5rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); margin-bottom: 1.5rem; border-left: 4px solid #7c3aed; }
        #localProgress h4 { color:#1e293b; margin-bottom: 0.75rem; font-size:0.95rem; }
        .progress-bar-wrap { background:#e2e8f0; border-radius:99px; height:10px; overflow:hidden; margin-bottom:0.5rem; }
        .progress-bar-fill { height:100%; background:#7c3aed; border-radius:99px; width:0%; transition: width 0.3s; }
        #progressLabel { font-size:0.8rem; color:#64748b; }

        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; justify-content:center; align-items:center; }
        .modal.show { display:flex; }
        .modal-content { background:white; padding:2rem; border-radius:10px; max-width:560px; width:90%; max-height:85vh; overflow-y:auto; }
        .modal-header { font-size:1.35rem; font-weight:700; color:#1e293b; margin-bottom:0.25rem; }
        .modal-subheader { color:#64748b; font-size:0.875rem; margin-bottom:1.25rem; }
        .provider-grid { display:grid; gap:0.75rem; margin-bottom:1.25rem; }
        .provider-card { padding: 1rem 1.25rem; border: 2px solid #e2e8f0; border-radius: 8px; cursor: pointer; transition: all 0.2s; }
        .provider-card:hover { border-color:#2563eb; background:#f8fafc; }
        .provider-card.selected { border-color:#2563eb; background:#eff6ff; }
        .provider-card.local-card:hover { border-color:#7c3aed; background:#faf5ff; }
        .provider-card.local-card.selected { border-color:#7c3aed; background:#faf5ff; }
        .provider-card-header { display:flex; align-items:center; gap:0.75rem; margin-bottom:0.3rem; }
        .provider-icon { font-size:1.4rem; }
        .provider-name { font-weight:600; color:#1e293b; font-size:0.95rem; }
        .provider-tag  { margin-left:auto; padding:0.2rem 0.6rem; border-radius:99px; font-size:0.7rem; font-weight:600; }
        .tag-free  { background:#dcfce7; color:#166534; }
        .tag-local { background:#ede9fe; color:#5b21b6; }
        .tag-cloud { background:#dbeafe; color:#1e40af; }
        .provider-desc { color:#64748b; font-size:0.82rem; line-height:1.4; }
        .provider-desc a { color:#2563eb; text-decoration:none; }
        .provider-desc a:hover { text-decoration:underline; }
        #localModelSection { display:none; margin-top:0.75rem; }
        .model-select-label { font-size:0.82rem; color:#475569; margin-bottom:0.4rem; font-weight:500; }
        .model-select-wrap select { width:100%; padding:0.6rem; border:2px solid #e2e8f0; border-radius:6px; font-size:0.875rem; }
        .model-note { margin-top:0.5rem; padding:0.75rem; background:#faf5ff; border:1px solid #e9d5ff; border-radius:6px; font-size:0.78rem; color:#5b21b6; line-height:1.5; }
        #cloudKeySection { display:none; margin-top:1rem; }
        .key-label { font-size:0.82rem; color:#475569; font-weight:500; margin-bottom:0.4rem; }
        .key-input { width:100%; padding:0.65rem; border:2px solid #e2e8f0; border-radius:6px; font-size:0.875rem; }
        .key-input:focus { outline:none; border-color:#2563eb; }
        .privacy-note { margin-top:1rem; padding:0.75rem; background:#eff6ff; border:1px solid #bfdbfe; border-radius:6px; font-size:0.78rem; color:#1e40af; line-height:1.5; }
        .modal-footer { display:flex; gap:0.75rem; justify-content:flex-end; margin-top:1.25rem; }
        .modal-btn { padding:0.65rem 1.5rem; border:none; border-radius:6px; font-size:0.9rem; cursor:pointer; }
        .modal-btn.primary   { background:#2563eb; color:white; }
        .modal-btn.primary:hover { background:#1d4ed8; }
        .modal-btn.secondary { background:#f1f5f9; color:#475569; }
        .modal-btn.secondary:hover { background:#e2e8f0; }

        .search-section { background:white; padding:1.5rem; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.08); margin-bottom:1.5rem; }
        .input-group { display:flex; gap:0.75rem; margin-bottom:1rem; }
        input[type="text"] { flex:1; padding:0.7rem 1rem; border:2px solid #e2e8f0; border-radius:6px; font-size:0.95rem; transition:border-color 0.2s; }
        input[type="text"]:focus { outline:none; border-color:#2563eb; }
        button { padding:0.7rem 1.4rem; background:#2563eb; color:white; border:none; border-radius:6px; font-size:0.9rem; font-weight:500; cursor:pointer; transition:background 0.2s; }
        button:hover:not(:disabled) { background:#1d4ed8; }
        button:disabled { background:#94a3b8; cursor:not-allowed; }
        .example-queries { display:flex; flex-wrap:wrap; gap:0.5rem; margin-bottom:1rem; }
        .example-tag { padding:0.4rem 0.8rem; background:#f1f5f9; border:1px solid #cbd5e1; border-radius:6px; font-size:0.8rem; cursor:pointer; color:#475569; transition:all 0.2s; }
        .example-tag:hover { background:#e2e8f0; border-color:#2563eb; color:#2563eb; }
        .advanced-options { margin-top:1rem; padding:1.25rem; background:#f8fafc; border-radius:8px; border:1px solid #e2e8f0; }
        .advanced-toggle { cursor:pointer; color:#2563eb; font-weight:500; display:flex; align-items:center; gap:0.5rem; user-select:none; font-size:0.875rem; }
        .advanced-content { display:none; margin-top:1rem; }
        .advanced-content.open { display:block; }
        .option-row { display:grid; grid-template-columns:1fr 1fr; gap:1rem; }
        .option-group { margin-bottom:0.75rem; }
        .option-label { display:block; font-size:0.82rem; font-weight:500; color:#475569; margin-bottom:0.35rem; }
        select { width:100%; padding:0.6rem; border:2px solid #e2e8f0; border-radius:6px; font-size:0.875rem; background:white; cursor:pointer; }
        select:focus { outline:none; border-color:#2563eb; }

        .loading { text-align:center; padding:2rem; color:#64748b; }
        .spinner { border:3px solid #e2e8f0; border-top:3px solid #2563eb; border-radius:50%; width:36px; height:36px; animation:spin 0.9s linear infinite; margin:0 auto 0.75rem; }
        @keyframes spin { to { transform:rotate(360deg); } }

        .results-section { background:white; padding:1.5rem; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.08); display:none; }
        .results-section.visible { display:block; }
        .standard-info { background:#f8fafc; padding:1.5rem; border-radius:8px; border:1px solid #e2e8f0; margin-bottom:1.5rem; }
        .standard-header { display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:0.75rem; gap:0.75rem; flex-wrap:wrap; }
        .standard-title { font-weight:700; color:#1e293b; font-size:1.05rem; flex:1; }
        .copy-btns { display:flex; gap:0.5rem; flex-wrap:wrap; }
        .copy-btn { padding:0.35rem 0.7rem; background:white; border:1px solid #cbd5e1; border-radius:6px; font-size:0.78rem; cursor:pointer; color:#475569; display:flex; align-items:center; gap:0.3rem; transition:all 0.2s; }
        .copy-btn:hover { border-color:#2563eb; color:#2563eb; }
        .standard-description { color:#475569; line-height:1.6; font-size:0.9rem; margin-bottom:0.75rem; }
        .formula-box { background:white; padding:0.875rem 1rem; border-radius:6px; border:1px solid #cbd5e1; font-family:'Courier New',monospace; margin-top:0.75rem; font-size:0.975rem; overflow-x:auto; }
        .variables-list { margin-top:0.75rem; padding:0.875rem; background:white; border-radius:6px; border:1px solid #e2e8f0; }
        .variable-item { color:#475569; margin:0.2rem 0; font-size:0.875rem; }

        .action-buttons { display:flex; gap:0.75rem; margin-top:1rem; flex-wrap:wrap; }
        .action-btn { flex:1; min-width:170px; padding:0.6rem 1.1rem; font-size:0.875rem; }
        .btn-green  { background:#059669; } .btn-green:hover:not(:disabled)  { background:#047857; }
        .btn-blue   { background:#0284c7; } .btn-blue:hover:not(:disabled)   { background:#0369a1; }
        .btn-amber  { background:#d97706; } .btn-amber:hover:not(:disabled)  { background:#b45309; }
        .btn-locked { background:#cbd5e1 !important; cursor:not-allowed; }

        .calculator-section { margin-top:1.5rem; padding-top:1.5rem; border-top:2px solid #e2e8f0; }
        .calc-header { font-size:1.05rem; font-weight:700; color:#1e293b; margin-bottom:1.1rem; }
        .input-field { margin-bottom:1.1rem; }
        .input-label { display:block; font-weight:500; color:#475569; margin-bottom:0.4rem; font-size:0.875rem; }
        .input-with-unit { display:flex; gap:0.5rem; align-items:center; }
        .input-with-unit input { flex:1; }
        .unit-label { color:#64748b; font-weight:500; min-width:70px; font-size:0.875rem; }
        input[type="number"] { width:100%; padding:0.6rem; border:2px solid #e2e8f0; border-radius:6px; font-size:0.95rem; }
        input[type="number"]:focus { outline:none; border-color:#2563eb; }

        .result-box { background:#1e40af; color:white; padding:1.5rem; border-radius:8px; margin-top:1.25rem; }
        .result-label { font-size:0.82rem; opacity:0.85; margin-bottom:0.3rem; }
        .result-value { font-size:2.2rem; font-weight:700; }
        .result-unit  { font-size:1rem; opacity:0.85; margin-top:0.2rem; }
        .result-steps { margin-top:1.25rem; padding-top:1.25rem; border-top:1px solid rgba(255,255,255,0.25); font-size:0.82rem; }

        .derivation-content { margin-top:1rem; padding:1.25rem; background:#f0fdf4; border-radius:8px; border:1px solid #86efac; }
        .derivation-step { margin:1rem 0; padding:0.875rem; background:white; border-radius:6px; border:1px solid #e2e8f0; }
        .derivation-step h4 { color:#1e293b; margin-bottom:0.5rem; font-size:0.95rem; }
        .derivation-step p  { color:#475569; line-height:1.6; font-size:0.875rem; }
        .derivation-eq { background:#f0fdf4; padding:0.75rem; border-radius:6px; border:1px solid #86efac; font-family:'Courier New',monospace; margin:0.6rem 0; font-size:0.9rem; }
        .step-list { list-style:none; padding:0; }
        .step-list li { padding:0.35rem 0 0.35rem 1.4rem; position:relative; color:#475569; font-size:0.875rem; }
        .step-list li::before { content:"‚Üí"; position:absolute; left:0; color:#059669; font-weight:bold; }

        .graph-section { margin-top:1.25rem; padding:1.25rem; background:#f0f9ff; border-radius:8px; border:1px solid #bae6fd; }
        .graph-section h3 { color:#1e293b; margin-bottom:1rem; font-size:1rem; font-weight:600; }
        .graph-container { background:white; padding:1rem; border-radius:6px; margin-top:0.75rem; min-height:300px; }

        .verification-section { margin-top:1.25rem; padding:1.25rem; background:#fffbeb; border-radius:8px; border:1px solid #fde68a; }
        .verification-section h3 { color:#92400e; margin-bottom:0.75rem; font-size:1rem; font-weight:600; }
        .verification-content { background:white; padding:1.25rem; border-radius:6px; font-size:0.875rem; }
        .verify-example { margin:0.75rem 0; padding:0.875rem; background:#fef3c7; border-radius:6px; border-left:3px solid #f59e0b; color:#78350f; }
        .verify-match    { display:inline-block; padding:0.4rem 0.875rem; background:#10b981; color:white; border-radius:6px; font-weight:600; margin-top:0.75rem; font-size:0.875rem; }
        .verify-mismatch { display:inline-block; padding:0.4rem 0.875rem; background:#ef4444; color:white; border-radius:6px; font-weight:600; margin-top:0.75rem; font-size:0.875rem; }

        .error-msg { background:#fee2e2; color:#991b1b; padding:0.875rem; border-radius:6px; margin-top:0.75rem; border-left:4px solid #dc2626; font-size:0.875rem; }
        .meta-section { margin-top:1.25rem; padding:0.875rem; background:#f8fafc; border-radius:6px; border:1px solid #e2e8f0; font-size:0.8rem; color:#64748b; }
        .meta-row { display:flex; justify-content:space-between; padding:0.35rem 0; border-bottom:1px solid #e2e8f0; }
        .meta-row:last-child { border-bottom:none; }
        .meta-label { font-weight:500; color:#475569; }

        .export-section { margin-top:1.25rem; padding:1.25rem; background:#faf5ff; border-radius:8px; border:1px solid #e9d5ff; }
        .export-section h4 { color:#1e293b; margin-bottom:0.75rem; font-size:0.95rem; font-weight:600; }
        .export-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:0.6rem; }
        .export-btn { background:white; border:1px solid #cbd5e1; color:#475569; padding:0.6rem 0.875rem; display:flex; align-items:center; justify-content:center; gap:0.5rem; font-size:0.82rem; border-radius:6px; }
        .export-btn:hover:not(:disabled) { background:#faf5ff; border-color:#7c3aed; color:#7c3aed; }

        .toast { position:fixed; bottom:1.5rem; right:1.5rem; background:#1e293b; color:white; padding:0.875rem 1.25rem; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.15); display:none; align-items:center; gap:0.75rem; z-index:9999; animation:slideIn 0.3s ease; }
        .toast.show    { display:flex; }
        .toast.success { background:#059669; }
        .toast.fail    { background:#dc2626; }
        @keyframes slideIn { from { transform:translateX(120%); opacity:0; } to { transform:translateX(0); opacity:1; } }

        @media (max-width:640px) { .option-row { grid-template-columns:1fr; } .action-btn { min-width:140px; } .header { flex-direction:column; align-items:flex-start; } }
        @media print { body { background:white; padding:0; } .header,.search-section,.action-buttons,.export-section,.toast,.modal,#localProgress { display:none !important; } button { display:none !important; } .results-section { box-shadow:none; } }
        .cat-tab { padding:0.35rem 0.8rem;border:1px solid #cbd5e1;border-radius:99px;font-size:0.75rem;cursor:pointer;color:#475569;background:white;transition:all 0.15s; }
        .cat-tab:hover { border-color:#2563eb;color:#2563eb; }
        .cat-tab.active { background:#2563eb;color:white;border-color:#2563eb; }
        .formula-card { padding:0.75rem;border:1px solid #e2e8f0;border-radius:6px;cursor:pointer;transition:all 0.15s;background:#fafafa; }
        .formula-card:hover { border-color:#2563eb;background:#eff6ff; }
        .formula-card-title { font-size:0.8rem;font-weight:600;color:#1e293b;margin-bottom:0.2rem; }
        .formula-card-standard { font-size:0.72rem;color:#64748b; }
        .formula-card-formula { font-size:0.72rem;font-family:'Courier New',monospace;color:#2563eb;margin-top:0.2rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis; }
        /* ‚îÄ‚îÄ Multi-formula workflow ‚îÄ‚îÄ */
        .multi-workflow-header { background:white; border-radius:8px; padding:1.25rem 1.5rem; margin-bottom:1rem; box-shadow:0 1px 3px rgba(0,0,0,0.08); border-left:4px solid #2563eb; }
        .multi-step { background:white; border-radius:8px; padding:1.25rem 1.5rem; margin-bottom:0.75rem; box-shadow:0 1px 3px rgba(0,0,0,0.08); border:1.5px solid #e2e8f0; transition:border-color 0.2s; }
        .multi-step:hover { border-color:#bfdbfe; }
        .multi-step-header { display:flex; align-items:center; gap:0.75rem; margin-bottom:0.75rem; flex-wrap:wrap; }
        .step-number { background:#2563eb; color:white; border-radius:50%; width:1.6rem; height:1.6rem; display:flex; align-items:center; justify-content:center; font-size:0.75rem; font-weight:700; flex-shrink:0; }
        .step-title { font-weight:600; color:#1e293b; font-size:0.9rem; flex:1; }
        .step-standard { background:#f1f5f9; color:#475569; padding:0.15rem 0.5rem; border-radius:4px; font-size:0.72rem; white-space:nowrap; }
        .multi-step-formula { background:#f8fafc; border:1px solid #e2e8f0; border-radius:6px; padding:0.6rem 0.875rem; margin-bottom:0.5rem; }
        .multi-inputs { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:0.75rem; margin-bottom:0.75rem; }
        .multi-calc-btn { background:#0f172a; color:white; border:none; border-radius:6px; padding:0.5rem 1.1rem; font-size:0.85rem; font-weight:500; cursor:pointer; transition:background 0.15s; }
        .multi-calc-btn:hover { background:#1e40af; }
        .multi-result-box { margin-top:0.75rem; }
        input[style*="rgb(16, 185, 129)"] { background:#f0fdf4 !important; }
        input:focus { outline:none; border-color:#2563eb !important; }
    </style>
    <script>
        window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/insights/script.js"></script>
</head>
<body>
<div class="container">

    <div class="header">
        <div class="header-content">
            <h1>‚öôÔ∏è Shan's Engineering Calculator</h1>
            <p>Professional engineering calculations ¬∑ Built-in database + optional AI (local or cloud)</p>
        </div>
        <div class="ai-status">
            <div id="aiBadge" class="ai-badge offline"><span>ü§ñ</span><span id="aiStatusText">AI: Not Connected</span></div>
            <button id="aiActionBtn" class="hdr-btn connect" onclick="openModal()">Connect AI</button>
        </div>
    </div>

    <!-- Local model download progress -->
    <div id="localProgress">
        <h4>‚¨áÔ∏è Downloading AI Model ‚Äî happens once, then cached in your browser</h4>
        <div class="progress-bar-wrap"><div class="progress-bar-fill" id="progressFill"></div></div>
        <div id="progressLabel">Preparing‚Ä¶</div>
    </div>

    <!-- AI Modal -->
    <div id="aiModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">Connect an AI Provider</div>
            <div class="modal-subheader">Choose how you'd like to power the AI features</div>

            <div class="provider-grid">

                <div class="provider-card local-card" data-mode="local" onclick="selectProvider(this)">
                    <div class="provider-card-header">
                        <span class="provider-icon">üñ•Ô∏è</span>
                        <span class="provider-name">Local AI ‚Äî Runs in Your Browser</span>
                        <span class="provider-tag tag-local">FREE ¬∑ No Key</span>
                    </div>
                    <div class="provider-desc">
                        Open-source models (Phi-3.5, Llama 3.2, Gemma 2) run <strong>100% on your device</strong> via WebGPU.
                        Nothing leaves your browser. First use downloads the model once (~1‚Äì2 GB) and caches it.
                    </div>
                    <div id="localModelSection">
                        <div style="margin-top:0.75rem">
                            <div class="model-select-label">Choose model:</div>
                            <div class="model-select-wrap">
                                <select id="localModelSelect">
                                    <option value="Phi-3.5-mini-instruct-q4f16_1-MLC">Phi-3.5 Mini ‚Äî Best for engineering (Recommended) ~1.8 GB</option>
                                    <option value="Llama-3.2-3B-Instruct-q4f16_1-MLC">Llama 3.2 3B ‚Äî Fast, lighter ~1.7 GB</option>
                                    <option value="gemma-2-2b-it-q4f16_1-MLC">Gemma 2 2B ‚Äî Google model ~1.5 GB</option>
                                    <option value="SmolLM2-1.7B-Instruct-q4f16_1-MLC">SmolLM2 1.7B ‚Äî Smallest/fastest ~1 GB</option>
                                </select>
                            </div>
                            <div class="model-note">‚ö†Ô∏è Requires Chrome 113+ or Edge 113+ with WebGPU. Downloaded once and cached ‚Äî subsequent uses start instantly.</div>
                        </div>
                    </div>
                </div>

                <div class="provider-card" data-mode="anthropic" onclick="selectProvider(this)">
                    <div class="provider-card-header">
                        <span class="provider-icon">üî∑</span>
                        <span class="provider-name">Anthropic Claude</span>
                        <span class="provider-tag tag-cloud">API Key</span>
                    </div>
                    <div class="provider-desc">Most capable for engineering. Get a free key at <a href="https://console.anthropic.com/" target="_blank">console.anthropic.com</a>. Pay-as-you-go, very cheap per query.</div>
                </div>

                <div class="provider-card" data-mode="openai" onclick="selectProvider(this)">
                    <div class="provider-card-header">
                        <span class="provider-icon">üü¢</span>
                        <span class="provider-name">OpenAI GPT-4o</span>
                        <span class="provider-tag tag-cloud">API Key</span>
                    </div>
                    <div class="provider-desc">Versatile and widely used. Get a key at <a href="https://platform.openai.com/" target="_blank">platform.openai.com</a>.</div>
                </div>

                <div class="provider-card" data-mode="groq" onclick="selectProvider(this)">
                    <div class="provider-card-header">
                        <span class="provider-icon">‚ö°</span>
                        <span class="provider-name">Groq (Llama / Mixtral)</span>
                        <span class="provider-tag tag-free">Free Tier</span>
                    </div>
                    <div class="provider-desc">Ultra-fast open-source models with a generous free tier. Get a key at <a href="https://console.groq.com/" target="_blank">console.groq.com</a>.</div>
                </div>

            </div>

            <div id="cloudKeySection">
                <div class="key-label" id="keyLabel">API Key</div>
                <input type="password" class="key-input" id="apiKeyInput" placeholder="Paste your API key here‚Ä¶">
                <div class="privacy-note">üîí Your key is stored only in your browser and sent directly to the AI provider. It never touches any other server.</div>
            </div>

            <div class="modal-footer">
                <button class="modal-btn secondary" onclick="closeModal()">Cancel</button>
                <button class="modal-btn primary" onclick="connectAI()">Connect</button>
            </div>
        </div>
    </div>

    <div id="toast" class="toast"><span id="toastMsg"></span></div>

    <!-- Search -->
    <div class="search-section">
        <div class="input-group">
            <input type="text" id="queryInput" placeholder="e.g., calculate flow rate through a 40NB pipe" autocomplete="off">
            <button id="searchBtn" onclick="searchFormula()">Find Formula</button>
        </div>
        <div class="example-queries">
            <span class="example-tag" onclick="useExample('calculate flow rate through a 40NB pipe')">Flow rate in pipe</span>
            <span class="example-tag" onclick="useExample('calculate Reynolds number')">Reynolds number</span>
            <span class="example-tag" onclick="useExample('calculate pressure drop in pipe')">Pressure drop</span>
            <span class="example-tag" onclick="useExample('calculate heat transfer through a wall')">Heat transfer</span>
            <span class="example-tag" onclick="useExample('calculate beam deflection')">Beam deflection</span>
        </div>
        <div class="advanced-options">
            <div class="advanced-toggle" onclick="toggleAdvanced()"><span id="advIcon">‚ñ∂</span> Advanced Options</div>
            <div id="advContent" class="advanced-content">
                <div class="option-row">
                    <div class="option-group">
                        <label class="option-label">Preferred Standard</label>
                        <select id="preferredStandard">
                            <option value="">Auto-detect</option>
                            <option value="BS EN">BS EN (British / European)</option>
                            <option value="ASME">ASME</option>
                            <option value="ISO">ISO</option>
                            <option value="API">API</option>
                            <option value="ASTM">ASTM</option>
                            <option value="DIN">DIN</option>
                            <option value="IEEE">IEEE</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label class="option-label">Specific Formula (optional)</label>
                        <input type="text" id="specificFormula" placeholder="e.g., Darcy-Weisbach, Hazen-Williams">
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <div id="loadingSection" class="search-section loading" style="display:none;">
        <div class="spinner"></div><p id="loadingMsg">Searching‚Ä¶</p>
    </div>

    <div id="resultsSection" class="results-section"></div>

    <!-- Formula Browser (collapsed by default, bottom of page) -->
    <div id="formulaBrowser" style="margin-top:2rem;border-top:1px solid #e2e8f0;padding-top:1rem">
        <button onclick="toggleBrowser()" style="display:flex;align-items:center;gap:0.5rem;background:none;border:none;cursor:pointer;color:#64748b;font-size:0.82rem;padding:0;width:100%;text-align:left">
            <span id="browserArrow">‚ñ∂</span>
            <span style="font-weight:600;color:#475569">üìö Formula Browser</span>
            <span id="dbStats" style="margin-left:0.5rem;color:#94a3b8;font-size:0.78rem">Loading‚Ä¶</span>
            <span style="margin-left:auto;font-size:0.72rem;color:#94a3b8">browse all 375+ formulas by category</span>
        </button>
        <div id="browserBody" style="display:none;margin-top:0.75rem">
            <div style="display:flex;gap:0.4rem;flex-wrap:wrap;margin-bottom:0.6rem" id="categoryTabs"></div>
            <div id="formulaGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:0.5rem;max-height:300px;overflow-y:auto"></div>
        </div>
    </div>

</div>

<script>
const FORMULA_DB = {

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 1. FLUID MECHANICS & PIPE FLOW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"flow rate pipe continuity": { cat:"Fluid Mechanics", standard:"ISO 5167-1", standardName:"Measurement of fluid flow ‚Äî Pressure differential devices", description:"Volumetric flow rate through a pipe using the continuity equation. Applies to incompressible, steady, fully-developed flow in circular pipes.", formula:"Q = A √ó v", formulaDescription:"Flow rate equals cross-sectional area multiplied by average velocity.", variables:[{symbol:"A",name:"Cross-sectional Area",description:"Internal cross-sectional area (œÄ r¬≤)",unit:"m¬≤",defaultValue:null},{symbol:"v",name:"Flow Velocity",description:"Average velocity of fluid",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"Q",name:"Volumetric Flow Rate",unit:"m¬≥/s"} },

"mass flow rate": { cat:"Fluid Mechanics", standard:"ISO 5167-1", standardName:"Measurement of fluid flow", description:"Mass flow rate through a pipe or duct.", formula:"·πÅ = œÅ √ó A √ó v", formulaDescription:"Mass flow = density √ó area √ó velocity.", variables:[{symbol:"œÅ",name:"Fluid Density",description:"Density of the fluid",unit:"kg/m¬≥",defaultValue:null},{symbol:"A",name:"Cross-sectional Area",description:"Internal flow area",unit:"m¬≤",defaultValue:null},{symbol:"v",name:"Flow Velocity",description:"Average velocity",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"·πÅ",name:"Mass Flow Rate",unit:"kg/s"} },

"reynolds number": { cat:"Fluid Mechanics", standard:"CIBSE Guide C", standardName:"Reference Data ‚Äî Fluid Mechanics", description:"Dimensionless ratio of inertial to viscous forces. Laminar < 2300, Turbulent > 4000.", formula:"Re = (œÅ √ó v √ó D) / Œº", formulaDescription:"Re < 2300 laminar; 2300‚Äì4000 transitional; > 4000 turbulent.", variables:[{symbol:"œÅ",name:"Fluid Density",description:"Density of the fluid",unit:"kg/m¬≥",defaultValue:null},{symbol:"v",name:"Flow Velocity",description:"Average velocity",unit:"m/s",defaultValue:null},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null},{symbol:"Œº",name:"Dynamic Viscosity",description:"Dynamic viscosity",unit:"Pa¬∑s",defaultValue:null}], resultVariable:{symbol:"Re",name:"Reynolds Number",unit:"dimensionless"} },

"reynolds number kinematic": { cat:"Fluid Mechanics", standard:"CIBSE Guide C", standardName:"Reference Data ‚Äî Fluid Mechanics", description:"Reynolds number using kinematic viscosity.", formula:"Re = (v √ó D) / ŒΩ", formulaDescription:"Kinematic viscosity ŒΩ = Œº/œÅ.", variables:[{symbol:"v",name:"Flow Velocity",description:"Average velocity",unit:"m/s",defaultValue:null},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null},{symbol:"ŒΩ",name:"Kinematic Viscosity",description:"Kinematic viscosity of fluid",unit:"m¬≤/s",defaultValue:null}], resultVariable:{symbol:"Re",name:"Reynolds Number",unit:"dimensionless"} },

"pressure drop darcy weisbach": { cat:"Fluid Mechanics", standard:"ASME B31.3", standardName:"Process Piping", description:"Pressure drop due to friction using the Darcy-Weisbach equation.", formula:"ŒîP = f √ó (L/D) √ó (œÅ √ó v¬≤ / 2)", formulaDescription:"Pressure loss proportional to friction factor, L/D ratio and dynamic pressure.", variables:[{symbol:"f",name:"Darcy Friction Factor",description:"Darcy-Weisbach friction factor (Moody chart)",unit:"dimensionless",defaultValue:null},{symbol:"L",name:"Pipe Length",description:"Length of pipe section",unit:"m",defaultValue:null},{symbol:"D",name:"Internal Diameter",description:"Internal pipe diameter",unit:"m",defaultValue:null},{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:null},{symbol:"v",name:"Flow Velocity",description:"Average flow velocity",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"ŒîP",name:"Pressure Drop",unit:"Pa"} },

"hazen williams flow": { cat:"Fluid Mechanics", standard:"NFPA 13", standardName:"Installation of Sprinkler Systems", description:"Hazen-Williams equation for water flow in pipes. Common in fire protection and water supply design.", formula:"Q = 0.2785 √ó C √ó D^2.63 √ó S^0.54", formulaDescription:"Q in m¬≥/s; C = roughness coefficient; S = head loss per unit length (m/m).", variables:[{symbol:"C",name:"Hazen-Williams Coefficient",description:"Roughness coefficient (150 new steel, 100 old cast iron)",unit:"dimensionless",defaultValue:null},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null},{symbol:"S",name:"Hydraulic Slope",description:"Head loss per unit pipe length",unit:"m/m",defaultValue:null}], resultVariable:{symbol:"Q",name:"Flow Rate",unit:"m¬≥/s"} },

"head loss major hazen": { cat:"Fluid Mechanics", standard:"NFPA 13", standardName:"Installation of Sprinkler Systems", description:"Head loss due to friction using Hazen-Williams.", formula:"h_f = (10.67 √ó L √ó Q^1.852) / (C^1.852 √ó D^4.87)", formulaDescription:"Head loss in metres for water at ~20¬∞C.", variables:[{symbol:"L",name:"Pipe Length",description:"Length of pipe",unit:"m",defaultValue:null},{symbol:"Q",name:"Flow Rate",description:"Volumetric flow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"C",name:"H-W Coefficient",description:"Hazen-Williams roughness coefficient",unit:"dimensionless",defaultValue:null},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null}], resultVariable:{symbol:"h_f",name:"Friction Head Loss",unit:"m"} },

"pipe velocity from flow": { cat:"Fluid Mechanics", standard:"BS EN 806-3", standardName:"Specifications for installations inside buildings conveying water", description:"Average fluid velocity from volumetric flow rate and pipe area.", formula:"v = Q / A", formulaDescription:"Rearrangement of continuity equation.", variables:[{symbol:"Q",name:"Flow Rate",description:"Volumetric flow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"A",name:"Pipe Area",description:"Internal cross-sectional area",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"v",name:"Flow Velocity",unit:"m/s"} },

"pipe internal area": { cat:"Fluid Mechanics", standard:"ISO 4200", standardName:"Plain end steel tubes", description:"Cross-sectional area from internal diameter.", formula:"A = œÄ √ó (D/2)¬≤", formulaDescription:"Circular cross-section area.", variables:[{symbol:"D",name:"Internal Diameter",description:"Internal diameter of pipe",unit:"m",defaultValue:null}], resultVariable:{symbol:"A",name:"Cross-sectional Area",unit:"m¬≤"} },

"bernoulli equation": { cat:"Fluid Mechanics", standard:"ISO 5167-1", standardName:"Measurement of fluid flow", description:"Bernoulli's equation between two points in a flowing fluid (steady, incompressible, inviscid).", formula:"P1 + 0.5√óœÅ√óv1¬≤ + œÅ√óg√óz1 = P2 + 0.5√óœÅ√óv2¬≤ + œÅ√óg√óz2", formulaDescription:"Total energy (pressure + kinetic + potential) conserved along streamline.", variables:[{symbol:"P1",name:"Pressure at Point 1",description:"Static pressure at inlet",unit:"Pa",defaultValue:null},{symbol:"v1",name:"Velocity at Point 1",description:"Flow velocity at inlet",unit:"m/s",defaultValue:null},{symbol:"z1",name:"Elevation Point 1",description:"Height above datum at inlet",unit:"m",defaultValue:null},{symbol:"P2",name:"Pressure at Point 2",description:"Static pressure at outlet",unit:"Pa",defaultValue:null},{symbol:"v2",name:"Velocity at Point 2",description:"Flow velocity at outlet",unit:"m/s",defaultValue:null},{symbol:"z2",name:"Elevation Point 2",description:"Height above datum at outlet",unit:"m",defaultValue:null},{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:null},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81}], resultVariable:{symbol:"ŒîP",name:"Pressure Difference",unit:"Pa"} },

"dynamic pressure": { cat:"Fluid Mechanics", standard:"ISO 5167-1", standardName:"Measurement of fluid flow", description:"Dynamic (velocity) pressure of a flowing fluid.", formula:"q = 0.5 √ó œÅ √ó v¬≤", formulaDescription:"Kinetic energy per unit volume.", variables:[{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:null},{symbol:"v",name:"Flow Velocity",description:"Average velocity",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"q",name:"Dynamic Pressure",unit:"Pa"} },

"hydrostatic pressure": { cat:"Fluid Mechanics", standard:"BS EN 1997-1", standardName:"Eurocode 7 ‚Äî Geotechnical design", description:"Hydrostatic pressure at depth h in a fluid.", formula:"P = œÅ √ó g √ó h", formulaDescription:"Pressure increases linearly with depth.", variables:[{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid (water ~1000 kg/m¬≥)",unit:"kg/m¬≥",defaultValue:1000},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"h",name:"Depth",description:"Depth below free surface",unit:"m",defaultValue:null}], resultVariable:{symbol:"P",name:"Hydrostatic Pressure",unit:"Pa"} },

"pipe friction factor laminar": { cat:"Fluid Mechanics", standard:"CIBSE Guide C", standardName:"Reference Data", description:"Darcy friction factor for laminar pipe flow (Re < 2300).", formula:"f = 64 / Re", formulaDescription:"Exact solution for laminar flow in circular pipes.", variables:[{symbol:"Re",name:"Reynolds Number",description:"Must be < 2300 for this formula",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"f",name:"Darcy Friction Factor",unit:"dimensionless"} },

"colebrook white friction factor": { cat:"Fluid Mechanics", standard:"ASME B36.10M", standardName:"Welded and Seamless Wrought Steel Pipe", description:"Colebrook-White equation for turbulent friction factor (implicit ‚Äî use iterative solution).", formula:"1/‚àöf = -2√ólog10(Œµ/(3.7D) + 2.51/(Re√ó‚àöf))", formulaDescription:"Applies for turbulent flow (Re > 4000). Requires iteration.", variables:[{symbol:"Œµ",name:"Pipe Roughness",description:"Absolute roughness (steel ~0.046 mm)",unit:"m",defaultValue:0.000046},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null},{symbol:"Re",name:"Reynolds Number",description:"Must be > 4000",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"f",name:"Darcy Friction Factor",unit:"dimensionless"} },

"swamee jain friction factor": { cat:"Fluid Mechanics", standard:"ASME B31.3", standardName:"Process Piping", description:"Explicit approximation of Colebrook-White (¬±3% error).", formula:"f = 0.25 / [log10(Œµ/(3.7D) + 5.74/Re^0.9)]¬≤", formulaDescription:"Explicit alternative to Colebrook-White.", variables:[{symbol:"Œµ",name:"Pipe Roughness",description:"Absolute roughness",unit:"m",defaultValue:0.000046},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null},{symbol:"Re",name:"Reynolds Number",description:"Reynolds number",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"f",name:"Darcy Friction Factor",unit:"dimensionless"} },

"pump head": { cat:"Fluid Mechanics", standard:"BS EN ISO 9906", standardName:"Rotodynamic pumps ‚Äî Hydraulic performance tests", description:"Total head developed by a pump.", formula:"H = ŒîP / (œÅ √ó g)", formulaDescription:"Total head in metres of fluid.", variables:[{symbol:"ŒîP",name:"Pressure Rise",description:"Pressure increase across pump",unit:"Pa",defaultValue:null},{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:1000},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81}], resultVariable:{symbol:"H",name:"Pump Head",unit:"m"} },

"pump power": { cat:"Fluid Mechanics", standard:"BS EN ISO 9906", standardName:"Rotodynamic pumps ‚Äî Hydraulic performance tests", description:"Hydraulic power delivered to fluid by a pump.", formula:"P = œÅ √ó g √ó Q √ó H", formulaDescription:"Fluid power; divide by efficiency for shaft power.", variables:[{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:1000},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"Q",name:"Flow Rate",description:"Volumetric flow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"H",name:"Total Head",description:"Total pump head",unit:"m",defaultValue:null}], resultVariable:{symbol:"P",name:"Hydraulic Power",unit:"W"} },

"pump efficiency": { cat:"Fluid Mechanics", standard:"BS EN ISO 9906", standardName:"Rotodynamic pumps ‚Äî Hydraulic performance tests", description:"Overall efficiency of a pump.", formula:"Œ∑ = (œÅ √ó g √ó Q √ó H) / P_shaft", formulaDescription:"Ratio of hydraulic power to shaft input power.", variables:[{symbol:"œÅ",name:"Fluid Density",description:"Density",unit:"kg/m¬≥",defaultValue:1000},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"Q",name:"Flow Rate",description:"Volumetric flow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"H",name:"Pump Head",description:"Total head",unit:"m",defaultValue:null},{symbol:"P_shaft",name:"Shaft Power",description:"Input shaft power",unit:"W",defaultValue:null}], resultVariable:{symbol:"Œ∑",name:"Pump Efficiency",unit:"dimensionless"} },

"orifice flow coefficient": { cat:"Fluid Mechanics", standard:"ISO 5167-2", standardName:"Orifice plates", description:"Flow rate through an orifice plate.", formula:"Q = Cd √ó A_o √ó ‚àö(2 √ó ŒîP / œÅ)", formulaDescription:"Cd typically 0.6‚Äì0.65 for standard orifice plates.", variables:[{symbol:"Cd",name:"Discharge Coefficient",description:"Typically 0.6‚Äì0.65",unit:"dimensionless",defaultValue:0.61},{symbol:"A_o",name:"Orifice Area",description:"Cross-sectional area of orifice",unit:"m¬≤",defaultValue:null},{symbol:"ŒîP",name:"Pressure Differential",description:"Pressure drop across orifice",unit:"Pa",defaultValue:null},{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:null}], resultVariable:{symbol:"Q",name:"Volumetric Flow Rate",unit:"m¬≥/s"} },

"venturi meter flow": { cat:"Fluid Mechanics", standard:"ISO 5167-4", standardName:"Venturi tubes", description:"Flow rate through a venturi meter.", formula:"Q = Cd √ó (œÄ/4) √ó D2¬≤ √ó ‚àö(2√óŒîP / (œÅ√ó(1-(D2/D1)^4)))", formulaDescription:"D1 = upstream diameter, D2 = throat diameter. Cd ‚âà 0.98.", variables:[{symbol:"Cd",name:"Discharge Coefficient",description:"Typically 0.95‚Äì0.985",unit:"dimensionless",defaultValue:0.98},{symbol:"D2",name:"Throat Diameter",description:"Venturi throat diameter",unit:"m",defaultValue:null},{symbol:"D1",name:"Upstream Diameter",description:"Upstream pipe diameter",unit:"m",defaultValue:null},{symbol:"ŒîP",name:"Pressure Differential",description:"Pressure drop throat to upstream",unit:"Pa",defaultValue:null},{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:null}], resultVariable:{symbol:"Q",name:"Volumetric Flow Rate",unit:"m¬≥/s"} },

"water hammer pressure": { cat:"Fluid Mechanics", standard:"BS EN 805", standardName:"Water supply ‚Äî Requirements for systems outside buildings", description:"Joukowsky pressure surge (water hammer) due to sudden valve closure.", formula:"ŒîP = œÅ √ó a √ó Œîv", formulaDescription:"a = wave speed ‚âà 1200 m/s for steel pipes with water.", variables:[{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:1000},{symbol:"a",name:"Wave Speed",description:"Pressure wave speed (~1200 m/s steel)",unit:"m/s",defaultValue:1200},{symbol:"Œîv",name:"Velocity Change",description:"Change in flow velocity",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"ŒîP",name:"Surge Pressure",unit:"Pa"} },

"pipe equivalent length fittings": { cat:"Fluid Mechanics", standard:"CIBSE Guide C", standardName:"Reference Data", description:"Equivalent pipe length for fittings and valves using K-factor method.", formula:"L_eq = K √ó D / f", formulaDescription:"L_eq = equivalent length of straight pipe.", variables:[{symbol:"K",name:"Loss Coefficient",description:"Resistance coefficient K for fitting",unit:"dimensionless",defaultValue:null},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null},{symbol:"f",name:"Friction Factor",description:"Darcy friction factor",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"L_eq",name:"Equivalent Pipe Length",unit:"m"} },

"nozzle exit velocity": { cat:"Fluid Mechanics", standard:"ISO 5167-3", standardName:"Nozzles and Venturi nozzles", description:"Exit velocity from a nozzle using Torricelli's theorem.", formula:"v = Cv √ó ‚àö(2 √ó g √ó h)", formulaDescription:"Cv = velocity coefficient (‚âà0.97 for sharp-edged nozzle).", variables:[{symbol:"Cv",name:"Velocity Coefficient",description:"Typically 0.97‚Äì0.99",unit:"dimensionless",defaultValue:0.97},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"h",name:"Head",description:"Available head above nozzle",unit:"m",defaultValue:null}], resultVariable:{symbol:"v",name:"Exit Velocity",unit:"m/s"} },

"pipe thermal expansion": { cat:"Fluid Mechanics", standard:"BS EN 13480-3", standardName:"Metallic industrial piping", description:"Thermal expansion of a pipe due to temperature change.", formula:"ŒîL = Œ± √ó L √ó ŒîT", formulaDescription:"Œ± = coefficient of thermal expansion.", variables:[{symbol:"Œ±",name:"Thermal Expansion Coefficient",description:"Material CTE (steel ~12√ó10‚Åª‚Å∂ /¬∞C)",unit:"1/¬∞C",defaultValue:0.000012},{symbol:"L",name:"Pipe Length",description:"Original pipe length",unit:"m",defaultValue:null},{symbol:"ŒîT",name:"Temperature Change",description:"Change in temperature",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"ŒîL",name:"Thermal Expansion",unit:"m"} },

"pipe schedules wall thickness": { cat:"Fluid Mechanics", standard:"ASME B36.10M", standardName:"Welded and Seamless Wrought Steel Pipe", description:"Minimum wall thickness for pressure pipe (Barlow formula).", formula:"t = (P √ó D) / (2 √ó S √ó E + 2 √ó P √ó Y)", formulaDescription:"ASME B31.3 Barlow formula. E = weld factor, Y = temperature coefficient.", variables:[{symbol:"P",name:"Design Pressure",description:"Internal design pressure",unit:"Pa",defaultValue:null},{symbol:"D",name:"Outer Diameter",description:"Pipe outer diameter",unit:"m",defaultValue:null},{symbol:"S",name:"Allowable Stress",description:"Allowable hoop stress for material",unit:"Pa",defaultValue:null},{symbol:"E",name:"Weld Joint Efficiency",description:"Typically 0.8‚Äì1.0",unit:"dimensionless",defaultValue:1.0},{symbol:"Y",name:"Temperature Coefficient",description:"Typically 0.4 for T < 900¬∞F",unit:"dimensionless",defaultValue:0.4}], resultVariable:{symbol:"t",name:"Minimum Wall Thickness",unit:"m"} },

"pipe flow 40nb": { cat:"Fluid Mechanics", standard:"ISO 4200 / BS EN 10255", standardName:"Steel tubes for threading ‚Äî Medium series", description:"Flow through a nominal 40NB (DN40) steel pipe. Internal diameter ~40.9 mm (schedule 40).", formula:"Q = A √ó v = œÄ√ó(0.0409/2)¬≤ √ó v", formulaDescription:"Use this for initial velocity-based estimate. Typical water velocity 1‚Äì3 m/s.", variables:[{symbol:"v",name:"Flow Velocity",description:"Average velocity (1‚Äì3 m/s recommended)",unit:"m/s",defaultValue:2.0}], resultVariable:{symbol:"Q",name:"Flow Rate",unit:"m¬≥/s"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 2. HEAT TRANSFER & THERMODYNAMICS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"heat conduction fourier": { cat:"Heat Transfer", standard:"ISO 6946", standardName:"Building components ‚Äî Thermal resistance and transmittance", description:"Heat conduction through a flat wall ‚Äî Fourier's law.", formula:"Q = (k √ó A √ó ŒîT) / L", formulaDescription:"Rate proportional to conductivity, area, and temperature difference.", variables:[{symbol:"k",name:"Thermal Conductivity",description:"Material thermal conductivity",unit:"W/(m¬∑K)",defaultValue:null},{symbol:"A",name:"Area",description:"Surface area",unit:"m¬≤",defaultValue:null},{symbol:"ŒîT",name:"Temperature Difference",description:"Temp. difference across wall",unit:"K",defaultValue:null},{symbol:"L",name:"Thickness",description:"Wall thickness",unit:"m",defaultValue:null}], resultVariable:{symbol:"Q",name:"Heat Transfer Rate",unit:"W"} },

"thermal resistance wall": { cat:"Heat Transfer", standard:"ISO 6946", standardName:"Building components ‚Äî Thermal resistance", description:"Thermal resistance of a homogeneous layer.", formula:"R = L / (k √ó A)", formulaDescription:"Higher R = better insulation.", variables:[{symbol:"L",name:"Thickness",description:"Layer thickness",unit:"m",defaultValue:null},{symbol:"k",name:"Thermal Conductivity",description:"Material conductivity",unit:"W/(m¬∑K)",defaultValue:null},{symbol:"A",name:"Area",description:"Surface area",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"R",name:"Thermal Resistance",unit:"K/W"} },

"overall heat transfer coefficient": { cat:"Heat Transfer", standard:"BS EN ISO 6946", standardName:"Thermal resistance and transmittance", description:"Overall U-value for a multi-layer wall including surface resistances.", formula:"U = 1 / (Rsi + Œ£(L_i/k_i) + Rse)", formulaDescription:"Rsi ‚âà 0.13 m¬≤K/W (inside), Rse ‚âà 0.04 m¬≤K/W (outside).", variables:[{symbol:"Rsi",name:"Internal Surface Resistance",description:"Typically 0.13 m¬≤K/W",unit:"m¬≤K/W",defaultValue:0.13},{symbol:"L_i",name:"Layer Thickness",description:"Sum of L/k for each layer",unit:"m¬≤K/W",defaultValue:null},{symbol:"Rse",name:"External Surface Resistance",description:"Typically 0.04 m¬≤K/W",unit:"m¬≤K/W",defaultValue:0.04}], resultVariable:{symbol:"U",name:"U-value",unit:"W/(m¬≤¬∑K)"} },

"convective heat transfer": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Newton's law of cooling ‚Äî convective heat transfer.", formula:"Q = h √ó A √ó (T_s - T_f)", formulaDescription:"h = convective heat transfer coefficient.", variables:[{symbol:"h",name:"Heat Transfer Coefficient",description:"Convective h (natural air ~5‚Äì25 W/m¬≤K)",unit:"W/(m¬≤¬∑K)",defaultValue:null},{symbol:"A",name:"Surface Area",description:"Exposed surface area",unit:"m¬≤",defaultValue:null},{symbol:"T_s",name:"Surface Temperature",description:"Temperature of surface",unit:"¬∞C",defaultValue:null},{symbol:"T_f",name:"Fluid Temperature",description:"Bulk fluid temperature",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"Q",name:"Heat Transfer Rate",unit:"W"} },

"radiation heat transfer": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Stefan-Boltzmann radiation between a surface and surroundings.", formula:"Q = Œµ √ó œÉ √ó A √ó (T_s^4 - T_surr^4)", formulaDescription:"œÉ = 5.67√ó10‚Åª‚Å∏ W/m¬≤K‚Å¥; Œµ = emissivity (0‚Äì1).", variables:[{symbol:"Œµ",name:"Emissivity",description:"Surface emissivity (black body = 1)",unit:"dimensionless",defaultValue:0.9},{symbol:"œÉ",name:"Stefan-Boltzmann Constant",description:"5.67√ó10‚Åª‚Å∏ W/m¬≤K‚Å¥",unit:"W/(m¬≤¬∑K‚Å¥)",defaultValue:0.0000000567},{symbol:"A",name:"Surface Area",description:"Radiating surface area",unit:"m¬≤",defaultValue:null},{symbol:"T_s",name:"Surface Temperature",description:"Absolute surface temperature",unit:"K",defaultValue:null},{symbol:"T_surr",name:"Surroundings Temperature",description:"Absolute surroundings temperature",unit:"K",defaultValue:null}], resultVariable:{symbol:"Q",name:"Radiation Heat Transfer",unit:"W"} },

"log mean temperature difference": { cat:"Heat Transfer", standard:"TEMA", standardName:"Standards of the Tubular Exchanger Manufacturers Association", description:"Log mean temperature difference for heat exchangers.", formula:"LMTD = (ŒîT1 - ŒîT2) / ln(ŒîT1/ŒîT2)", formulaDescription:"ŒîT1 and ŒîT2 are temp. differences at each end of heat exchanger.", variables:[{symbol:"ŒîT1",name:"Temperature Difference ‚Äî End 1",description:"Hot inlet minus cold outlet",unit:"¬∞C",defaultValue:null},{symbol:"ŒîT2",name:"Temperature Difference ‚Äî End 2",description:"Hot outlet minus cold inlet",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"LMTD",name:"Log Mean Temperature Difference",unit:"¬∞C"} },

"heat exchanger duty": { cat:"Heat Transfer", standard:"TEMA", standardName:"Standards of the Tubular Exchanger Manufacturers Association", description:"Heat exchanger duty using LMTD.", formula:"Q = U √ó A √ó LMTD", formulaDescription:"Q = overall heat transfer; U = overall coefficient; A = area.", variables:[{symbol:"U",name:"Overall HT Coefficient",description:"Overall heat transfer coefficient",unit:"W/(m¬≤¬∑K)",defaultValue:null},{symbol:"A",name:"Heat Transfer Area",description:"Total surface area of exchanger",unit:"m¬≤",defaultValue:null},{symbol:"LMTD",name:"Log Mean Temp. Diff.",description:"LMTD from both ends",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"Q",name:"Heat Duty",unit:"W"} },

"nusselt number forced convection": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook", description:"Nusselt number for turbulent flow in a pipe (Dittus-Boelter).", formula:"Nu = 0.023 √ó Re^0.8 √ó Pr^n", formulaDescription:"n = 0.4 heating, 0.3 cooling. Valid Re > 10,000.", variables:[{symbol:"Re",name:"Reynolds Number",description:"Must be > 10,000",unit:"dimensionless",defaultValue:null},{symbol:"Pr",name:"Prandtl Number",description:"Fluid Prandtl number (water ‚âà7)",unit:"dimensionless",defaultValue:null},{symbol:"n",name:"Exponent",description:"0.4 heating, 0.3 cooling",unit:"dimensionless",defaultValue:0.4}], resultVariable:{symbol:"Nu",name:"Nusselt Number",unit:"dimensionless"} },

"prandtl number": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook", description:"Prandtl number ‚Äî ratio of momentum to thermal diffusivity.", formula:"Pr = (Œº √ó cp) / k", formulaDescription:"Water at 20¬∞C ‚âà 7; Air at 20¬∞C ‚âà 0.71.", variables:[{symbol:"Œº",name:"Dynamic Viscosity",description:"Fluid dynamic viscosity",unit:"Pa¬∑s",defaultValue:null},{symbol:"cp",name:"Specific Heat Capacity",description:"At constant pressure",unit:"J/(kg¬∑K)",defaultValue:null},{symbol:"k",name:"Thermal Conductivity",description:"Fluid thermal conductivity",unit:"W/(m¬∑K)",defaultValue:null}], resultVariable:{symbol:"Pr",name:"Prandtl Number",unit:"dimensionless"} },

"specific heat sensible heat": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook", description:"Sensible heat gain or loss of a fluid.", formula:"Q = ·πÅ √ó cp √ó ŒîT", formulaDescription:"Energy required to change temperature of a mass.", variables:[{symbol:"·πÅ",name:"Mass Flow Rate",description:"Mass flow rate of fluid",unit:"kg/s",defaultValue:null},{symbol:"cp",name:"Specific Heat Capacity",description:"At constant pressure (water 4186 J/kg¬∑K)",unit:"J/(kg¬∑K)",defaultValue:4186},{symbol:"ŒîT",name:"Temperature Change",description:"Temperature rise or fall",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"Q",name:"Heat Transfer Rate",unit:"W"} },

"latent heat phase change": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook", description:"Heat required for phase change (e.g. steam condensation).", formula:"Q = ·πÅ √ó L", formulaDescription:"L = latent heat of vaporisation (steam ‚âà 2257 kJ/kg).", variables:[{symbol:"·πÅ",name:"Mass Flow Rate",description:"Mass flow rate",unit:"kg/s",defaultValue:null},{symbol:"L",name:"Latent Heat",description:"Latent heat of phase change",unit:"J/kg",defaultValue:2257000}], resultVariable:{symbol:"Q",name:"Latent Heat Rate",unit:"W"} },

"fouling factor heat exchanger": { cat:"Heat Transfer", standard:"TEMA", standardName:"Standards of the Tubular Exchanger Manufacturers Association", description:"Overall heat transfer coefficient including fouling.", formula:"1/U_total = 1/U_clean + R_f", formulaDescription:"R_f = fouling resistance (TEMA tables).", variables:[{symbol:"U_clean",name:"Clean U-value",description:"Overall coefficient without fouling",unit:"W/(m¬≤¬∑K)",defaultValue:null},{symbol:"R_f",name:"Total Fouling Resistance",description:"Combined fouling on both sides",unit:"m¬≤¬∑K/W",defaultValue:0.0002}], resultVariable:{symbol:"U_total",name:"Overall U with Fouling",unit:"W/(m¬≤¬∑K)"} },

"fin efficiency": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook", description:"Efficiency of a rectangular fin.", formula:"Œ∑ = tanh(m√óL) / (m√óL)", formulaDescription:"m = ‚àö(h√óP / (k√óA_c)); P = perimeter, A_c = cross-section area.", variables:[{symbol:"m",name:"Fin Parameter m",description:"m = ‚àö(h√óP/(k√óAc))",unit:"1/m",defaultValue:null},{symbol:"L",name:"Fin Length",description:"Length of fin",unit:"m",defaultValue:null}], resultVariable:{symbol:"Œ∑",name:"Fin Efficiency",unit:"dimensionless"} },

"conduction cylinder": { cat:"Heat Transfer", standard:"ISO 6946", standardName:"Thermal resistance", description:"Radial heat conduction through a cylindrical wall (pipe).", formula:"Q = (2√óœÄ√ók√óL√ó(T_i - T_o)) / ln(r_o/r_i)", formulaDescription:"Radial conduction through hollow cylinder.", variables:[{symbol:"k",name:"Thermal Conductivity",description:"Material conductivity",unit:"W/(m¬∑K)",defaultValue:null},{symbol:"L",name:"Pipe Length",description:"Axial length of cylinder",unit:"m",defaultValue:null},{symbol:"T_i",name:"Inner Surface Temp.",description:"Inner surface temperature",unit:"¬∞C",defaultValue:null},{symbol:"T_o",name:"Outer Surface Temp.",description:"Outer surface temperature",unit:"¬∞C",defaultValue:null},{symbol:"r_i",name:"Inner Radius",description:"Internal radius",unit:"m",defaultValue:null},{symbol:"r_o",name:"Outer Radius",description:"External radius",unit:"m",defaultValue:null}], resultVariable:{symbol:"Q",name:"Heat Transfer Rate",unit:"W"} },

"ideal gas law": { cat:"Heat Transfer", standard:"ISO 6976", standardName:"Natural gas ‚Äî Calculation of calorific values", description:"Ideal gas law relating pressure, volume and temperature.", formula:"PV = nRT", formulaDescription:"R = 8.314 J/(mol¬∑K); n = moles.", variables:[{symbol:"n",name:"Amount of Gas",description:"Number of moles",unit:"mol",defaultValue:null},{symbol:"R",name:"Gas Constant",description:"Universal gas constant",unit:"J/(mol¬∑K)",defaultValue:8.314},{symbol:"T",name:"Absolute Temperature",description:"Temperature in Kelvin",unit:"K",defaultValue:null},{symbol:"V",name:"Volume",description:"Volume of gas",unit:"m¬≥",defaultValue:null}], resultVariable:{symbol:"P",name:"Pressure",unit:"Pa"} },

"isentropic compression temperature": { cat:"Heat Transfer", standard:"ISO 5167-1", standardName:"Measurement of fluid flow", description:"Temperature after isentropic compression of ideal gas.", formula:"T2 = T1 √ó (P2/P1)^((Œ≥-1)/Œ≥)", formulaDescription:"Œ≥ = ratio of specific heats (air ‚âà 1.4).", variables:[{symbol:"T1",name:"Initial Temperature",description:"Absolute temperature before compression",unit:"K",defaultValue:null},{symbol:"P2",name:"Final Pressure",description:"Pressure after compression",unit:"Pa",defaultValue:null},{symbol:"P1",name:"Initial Pressure",description:"Pressure before compression",unit:"Pa",defaultValue:null},{symbol:"Œ≥",name:"Specific Heat Ratio",description:"cp/cv (air = 1.4)",unit:"dimensionless",defaultValue:1.4}], resultVariable:{symbol:"T2",name:"Final Temperature",unit:"K"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 3. STRUCTURAL / MECHANICS OF MATERIALS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"beam deflection udl simply supported": { cat:"Structural", standard:"AISC 360 / BS EN 1993-1-1", standardName:"Specification for Structural Steel / Eurocode 3", description:"Maximum deflection of a simply-supported beam with uniformly distributed load.", formula:"Œ¥ = (5 √ó w √ó L‚Å¥) / (384 √ó E √ó I)", formulaDescription:"Mid-span deflection; must be checked against L/360 or client limit.", variables:[{symbol:"w",name:"Distributed Load",description:"Load per unit length",unit:"N/m",defaultValue:null},{symbol:"L",name:"Beam Span",description:"Span between supports",unit:"m",defaultValue:null},{symbol:"E",name:"Modulus of Elasticity",description:"Young's modulus (steel = 200 GPa)",unit:"Pa",defaultValue:200000000000},{symbol:"I",name:"Second Moment of Area",description:"Moment of inertia of cross-section",unit:"m‚Å¥",defaultValue:null}], resultVariable:{symbol:"Œ¥",name:"Maximum Deflection",unit:"m"} },

"beam deflection point load midspan": { cat:"Structural", standard:"AISC 360 / BS EN 1993-1-1", standardName:"Eurocode 3 / AISC 360", description:"Maximum deflection of simply-supported beam with central point load.", formula:"Œ¥ = (P √ó L¬≥) / (48 √ó E √ó I)", formulaDescription:"Deflection at mid-span under single central load.", variables:[{symbol:"P",name:"Point Load",description:"Central applied load",unit:"N",defaultValue:null},{symbol:"L",name:"Beam Span",description:"Span between supports",unit:"m",defaultValue:null},{symbol:"E",name:"Modulus of Elasticity",description:"Young's modulus",unit:"Pa",defaultValue:200000000000},{symbol:"I",name:"Second Moment of Area",description:"Moment of inertia",unit:"m‚Å¥",defaultValue:null}], resultVariable:{symbol:"Œ¥",name:"Maximum Deflection",unit:"m"} },

"beam bending stress": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3 ‚Äî Design of steel structures", description:"Maximum bending stress in a beam at extreme fibre.", formula:"œÉ = M √ó y / I", formulaDescription:"œÉ = M/Z where Z = I/y is elastic section modulus.", variables:[{symbol:"M",name:"Bending Moment",description:"Applied bending moment",unit:"N¬∑m",defaultValue:null},{symbol:"y",name:"Distance to Neutral Axis",description:"Distance from neutral axis to extreme fibre",unit:"m",defaultValue:null},{symbol:"I",name:"Second Moment of Area",description:"Moment of inertia",unit:"m‚Å¥",defaultValue:null}], resultVariable:{symbol:"œÉ",name:"Bending Stress",unit:"Pa"} },

"beam shear stress": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Average shear stress in a beam.", formula:"œÑ = V / A_web", formulaDescription:"More precisely œÑ = VQ/(Ib); average V/A used for preliminary design.", variables:[{symbol:"V",name:"Shear Force",description:"Applied shear force",unit:"N",defaultValue:null},{symbol:"A_web",name:"Web Area",description:"Cross-sectional area of web",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"œÑ",name:"Shear Stress",unit:"Pa"} },

"direct stress": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Direct (axial) stress in a member under tension or compression.", formula:"œÉ = F / A", formulaDescription:"Positive = tension; negative = compression.", variables:[{symbol:"F",name:"Axial Force",description:"Applied axial force",unit:"N",defaultValue:null},{symbol:"A",name:"Cross-sectional Area",description:"Area of member",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"œÉ",name:"Direct Stress",unit:"Pa"} },

"strain direct": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Direct (axial) strain from applied stress.", formula:"Œµ = œÉ / E", formulaDescription:"Hooke's law. Œµ = ŒîL/L.", variables:[{symbol:"œÉ",name:"Direct Stress",description:"Applied axial stress",unit:"Pa",defaultValue:null},{symbol:"E",name:"Modulus of Elasticity",description:"Young's modulus",unit:"Pa",defaultValue:200000000000}], resultVariable:{symbol:"Œµ",name:"Direct Strain",unit:"dimensionless"} },

"axial deformation": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Elongation or shortening of a member under axial load.", formula:"Œ¥ = (F √ó L) / (A √ó E)", formulaDescription:"Linear elastic deformation.", variables:[{symbol:"F",name:"Axial Force",description:"Applied force",unit:"N",defaultValue:null},{symbol:"L",name:"Member Length",description:"Original length",unit:"m",defaultValue:null},{symbol:"A",name:"Cross-sectional Area",description:"Area of member",unit:"m¬≤",defaultValue:null},{symbol:"E",name:"Modulus of Elasticity",description:"Young's modulus",unit:"Pa",defaultValue:200000000000}], resultVariable:{symbol:"Œ¥",name:"Axial Deformation",unit:"m"} },

"euler buckling load": { cat:"Structural", standard:"BS EN 1993-1-1 / AISC 360", standardName:"Eurocode 3 / AISC 360", description:"Critical buckling load for a slender column (Euler).", formula:"P_cr = (œÄ¬≤ √ó E √ó I) / (K √ó L)¬≤", formulaDescription:"K = effective length factor (1.0 pin-pin, 0.5 fixed-fixed, 0.7 fixed-pin).", variables:[{symbol:"E",name:"Modulus of Elasticity",description:"Young's modulus",unit:"Pa",defaultValue:200000000000},{symbol:"I",name:"Minimum Second Moment of Area",description:"About weakest axis",unit:"m‚Å¥",defaultValue:null},{symbol:"K",name:"Effective Length Factor",description:"1.0 pin-pin; 0.5 fixed-fixed; 0.7 fixed-free",unit:"dimensionless",defaultValue:1.0},{symbol:"L",name:"Member Length",description:"Unbraced length",unit:"m",defaultValue:null}], resultVariable:{symbol:"P_cr",name:"Critical Buckling Load",unit:"N"} },

"slenderness ratio": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Slenderness ratio for column buckling check.", formula:"Œª = (K √ó L) / r", formulaDescription:"r = radius of gyration = ‚àö(I/A). Limit typically 200.", variables:[{symbol:"K",name:"Effective Length Factor",description:"1.0 pin-pin, 0.5 fixed-fixed",unit:"dimensionless",defaultValue:1.0},{symbol:"L",name:"Member Length",description:"Unbraced length",unit:"m",defaultValue:null},{symbol:"r",name:"Radius of Gyration",description:"r = ‚àö(I/A)",unit:"m",defaultValue:null}], resultVariable:{symbol:"Œª",name:"Slenderness Ratio",unit:"dimensionless"} },

"radius of gyration": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Radius of gyration for buckling calculations.", formula:"r = ‚àö(I / A)", formulaDescription:"Measure of cross-section distribution about neutral axis.", variables:[{symbol:"I",name:"Second Moment of Area",description:"Moment of inertia",unit:"m‚Å¥",defaultValue:null},{symbol:"A",name:"Cross-sectional Area",description:"Area of section",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"r",name:"Radius of Gyration",unit:"m"} },

"bending moment simply supported udl": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Maximum bending moment in simply-supported beam under UDL.", formula:"M = (w √ó L¬≤) / 8", formulaDescription:"Maximum moment at mid-span.", variables:[{symbol:"w",name:"UDL",description:"Uniformly distributed load",unit:"N/m",defaultValue:null},{symbol:"L",name:"Span",description:"Beam span",unit:"m",defaultValue:null}], resultVariable:{symbol:"M",name:"Maximum Bending Moment",unit:"N¬∑m"} },

"bending moment cantilever udl": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Maximum bending moment in a cantilever beam under UDL.", formula:"M = (w √ó L¬≤) / 2", formulaDescription:"Maximum moment at fixed support.", variables:[{symbol:"w",name:"UDL",description:"Uniformly distributed load",unit:"N/m",defaultValue:null},{symbol:"L",name:"Cantilever Length",description:"Length of cantilever",unit:"m",defaultValue:null}], resultVariable:{symbol:"M",name:"Maximum Bending Moment",unit:"N¬∑m"} },

"bending moment cantilever point load": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Maximum bending moment in a cantilever with tip point load.", formula:"M = P √ó L", formulaDescription:"Maximum moment at fixed support.", variables:[{symbol:"P",name:"Point Load",description:"Applied tip load",unit:"N",defaultValue:null},{symbol:"L",name:"Cantilever Length",description:"Length of cantilever",unit:"m",defaultValue:null}], resultVariable:{symbol:"M",name:"Maximum Bending Moment",unit:"N¬∑m"} },

"section modulus elastic": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Elastic section modulus for rectangular cross-section.", formula:"Z = (b √ó d¬≤) / 6", formulaDescription:"Applies to rectangular cross-section; Z = I/y.", variables:[{symbol:"b",name:"Width",description:"Width of rectangle",unit:"m",defaultValue:null},{symbol:"d",name:"Depth",description:"Depth of rectangle",unit:"m",defaultValue:null}], resultVariable:{symbol:"Z",name:"Elastic Section Modulus",unit:"m¬≥"} },

"second moment of area rectangle": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Second moment of area for a solid rectangle about centroidal axis.", formula:"I = (b √ó d¬≥) / 12", formulaDescription:"About the horizontal centroidal axis.", variables:[{symbol:"b",name:"Width",description:"Width of rectangle",unit:"m",defaultValue:null},{symbol:"d",name:"Depth",description:"Depth of rectangle",unit:"m",defaultValue:null}], resultVariable:{symbol:"I",name:"Second Moment of Area",unit:"m‚Å¥"} },

"second moment of area circle": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Second moment of area for a solid circular cross-section.", formula:"I = œÄ √ó D‚Å¥ / 64", formulaDescription:"About centroidal axis.", variables:[{symbol:"D",name:"Diameter",description:"Diameter of circle",unit:"m",defaultValue:null}], resultVariable:{symbol:"I",name:"Second Moment of Area",unit:"m‚Å¥"} },

"second moment hollow circle": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Second moment of area for hollow circular section (pipe).", formula:"I = œÄ √ó (D_o‚Å¥ - D_i‚Å¥) / 64", formulaDescription:"CHS ‚Äî circular hollow section.", variables:[{symbol:"D_o",name:"Outer Diameter",description:"Outside diameter",unit:"m",defaultValue:null},{symbol:"D_i",name:"Inner Diameter",description:"Inside diameter",unit:"m",defaultValue:null}], resultVariable:{symbol:"I",name:"Second Moment of Area",unit:"m‚Å¥"} },

"torsional shear stress solid shaft": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Shear stress in a solid circular shaft under torque.", formula:"œÑ = T √ó r / J", formulaDescription:"J = polar moment of inertia = œÄ D‚Å¥/32.", variables:[{symbol:"T",name:"Torque",description:"Applied torque",unit:"N¬∑m",defaultValue:null},{symbol:"r",name:"Radius",description:"Outer radius of shaft",unit:"m",defaultValue:null},{symbol:"J",name:"Polar Moment of Inertia",description:"J = œÄ D‚Å¥/32",unit:"m‚Å¥",defaultValue:null}], resultVariable:{symbol:"œÑ",name:"Shear Stress",unit:"Pa"} },

"twist angle shaft": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Angle of twist of a circular shaft under torque.", formula:"œÜ = (T √ó L) / (G √ó J)", formulaDescription:"G = shear modulus (steel ‚âà 80 GPa).", variables:[{symbol:"T",name:"Torque",description:"Applied torque",unit:"N¬∑m",defaultValue:null},{symbol:"L",name:"Shaft Length",description:"Length of shaft",unit:"m",defaultValue:null},{symbol:"G",name:"Shear Modulus",description:"Shear modulus (steel ‚âà 80 GPa)",unit:"Pa",defaultValue:80000000000},{symbol:"J",name:"Polar Moment of Inertia",description:"œÄ D‚Å¥/32",unit:"m‚Å¥",defaultValue:null}], resultVariable:{symbol:"œÜ",name:"Angle of Twist",unit:"rad"} },

"thermal stress": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Thermal stress in a fully restrained member.", formula:"œÉ_T = E √ó Œ± √ó ŒîT", formulaDescription:"Compressive if temperature rises and expansion is restrained.", variables:[{symbol:"E",name:"Modulus of Elasticity",description:"Young's modulus",unit:"Pa",defaultValue:200000000000},{symbol:"Œ±",name:"Thermal Expansion Coefficient",description:"Steel ‚âà 12√ó10‚Åª‚Å∂ /¬∞C",unit:"1/¬∞C",defaultValue:0.000012},{symbol:"ŒîT",name:"Temperature Change",description:"Change in temperature",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"œÉ_T",name:"Thermal Stress",unit:"Pa"} },

"shear modulus": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Shear modulus from Young's modulus and Poisson's ratio.", formula:"G = E / (2 √ó (1 + ŒΩ))", formulaDescription:"ŒΩ = Poisson's ratio (steel ‚âà 0.3).", variables:[{symbol:"E",name:"Modulus of Elasticity",description:"Young's modulus",unit:"Pa",defaultValue:200000000000},{symbol:"ŒΩ",name:"Poisson's Ratio",description:"Poisson's ratio (steel ‚âà 0.3)",unit:"dimensionless",defaultValue:0.3}], resultVariable:{symbol:"G",name:"Shear Modulus",unit:"Pa"} },

"fatigue life basquin": { cat:"Structural", standard:"BS EN 1993-1-9", standardName:"Eurocode 3 ‚Äî Fatigue", description:"Basquin's fatigue life equation (stress‚Äìlife approach).", formula:"N = (ŒîœÉ_c / ŒîœÉ)^3 √ó N_c", formulaDescription:"S-N curve approach. N_c typically 2√ó10‚Å∂ for steel.", variables:[{symbol:"ŒîœÉ_c",name:"Reference Fatigue Strength",description:"Stress range at N_c cycles",unit:"Pa",defaultValue:null},{symbol:"ŒîœÉ",name:"Applied Stress Range",description:"Applied cyclic stress range",unit:"Pa",defaultValue:null},{symbol:"N_c",name:"Reference Cycles",description:"Typically 2√ó10‚Å∂",unit:"cycles",defaultValue:2000000}], resultVariable:{symbol:"N",name:"Fatigue Life",unit:"cycles"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 4. PRESSURE VESSELS & PIPEWORK ‚Äî ASME / BS EN 13480
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"vessel hoop stress barlow": { cat:"Pressure Vessels", standard:"ASME VIII Div.1 / BS EN 13445", standardName:"Unfired Pressure Vessels", description:"Hoop (circumferential) stress in thin-walled pressure vessel.", formula:"œÉ_h = P √ó D / (2 √ó t)", formulaDescription:"Valid when D/t > 20 (thin wall assumption).", variables:[{symbol:"P",name:"Internal Pressure",description:"Gauge pressure",unit:"Pa",defaultValue:null},{symbol:"D",name:"Internal Diameter",description:"Internal diameter",unit:"m",defaultValue:null},{symbol:"t",name:"Wall Thickness",description:"Wall thickness",unit:"m",defaultValue:null}], resultVariable:{symbol:"œÉ_h",name:"Hoop Stress",unit:"Pa"} },

"vessel longitudinal stress": { cat:"Pressure Vessels", standard:"ASME VIII Div.1 / BS EN 13445", standardName:"Unfired Pressure Vessels", description:"Longitudinal (axial) stress in a closed-ended cylindrical vessel.", formula:"œÉ_L = P √ó D / (4 √ó t)", formulaDescription:"Longitudinal stress is half the hoop stress in thin-walled vessels.", variables:[{symbol:"P",name:"Internal Pressure",description:"Gauge pressure",unit:"Pa",defaultValue:null},{symbol:"D",name:"Internal Diameter",description:"Internal diameter",unit:"m",defaultValue:null},{symbol:"t",name:"Wall Thickness",description:"Wall thickness",unit:"m",defaultValue:null}], resultVariable:{symbol:"œÉ_L",name:"Longitudinal Stress",unit:"Pa"} },

"vessel required thickness asme": { cat:"Pressure Vessels", standard:"ASME VIII Div.1", standardName:"ASME Boiler and Pressure Vessel Code ‚Äî Div.1", description:"Required wall thickness for a cylindrical pressure vessel (ASME UG-27).", formula:"t = (P √ó R) / (S √ó E - 0.6 √ó P)", formulaDescription:"R = inside radius; S = allowable stress; E = joint efficiency.", variables:[{symbol:"P",name:"Design Pressure",description:"Maximum allowable working pressure",unit:"Pa",defaultValue:null},{symbol:"R",name:"Inside Radius",description:"Internal radius of shell",unit:"m",defaultValue:null},{symbol:"S",name:"Allowable Stress",description:"Material allowable stress at design temp",unit:"Pa",defaultValue:null},{symbol:"E",name:"Joint Efficiency",description:"Weld joint efficiency (0.7‚Äì1.0)",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"t",name:"Required Wall Thickness",unit:"m"} },

"vessel max allowable pressure": { cat:"Pressure Vessels", standard:"ASME VIII Div.1", standardName:"ASME Boiler and Pressure Vessel Code", description:"Maximum allowable working pressure for existing cylindrical shell.", formula:"P = (S √ó E √ó t) / (R + 0.6 √ó t)", formulaDescription:"Rearranged ASME UG-27 formula.", variables:[{symbol:"S",name:"Allowable Stress",description:"Material allowable stress",unit:"Pa",defaultValue:null},{symbol:"E",name:"Joint Efficiency",description:"Weld joint efficiency",unit:"dimensionless",defaultValue:1.0},{symbol:"t",name:"Wall Thickness",description:"Actual wall thickness",unit:"m",defaultValue:null},{symbol:"R",name:"Inside Radius",description:"Internal radius",unit:"m",defaultValue:null}], resultVariable:{symbol:"P",name:"Max Allowable Pressure",unit:"Pa"} },

"vessel thickness spherical": { cat:"Pressure Vessels", standard:"ASME VIII Div.1", standardName:"ASME Boiler and Pressure Vessel Code", description:"Required wall thickness for a spherical pressure vessel.", formula:"t = (P √ó R) / (2 √ó S √ó E - 0.2 √ó P)", formulaDescription:"Spherical shells have lower stress than cylinders.", variables:[{symbol:"P",name:"Design Pressure",description:"Internal design pressure",unit:"Pa",defaultValue:null},{symbol:"R",name:"Inside Radius",description:"Internal radius",unit:"m",defaultValue:null},{symbol:"S",name:"Allowable Stress",description:"Material allowable stress",unit:"Pa",defaultValue:null},{symbol:"E",name:"Joint Efficiency",description:"Weld joint efficiency",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"t",name:"Wall Thickness",unit:"m"} },

"nozzle reinforcement area": { cat:"Pressure Vessels", standard:"ASME VIII Div.1 UG-37", standardName:"ASME Boiler and Pressure Vessel Code", description:"Area replacement for nozzle reinforcement check.", formula:"A_req = d √ó t_r √ó F", formulaDescription:"d = nozzle bore; t_r = required thickness; F = correction factor (1.0 for radial nozzles).", variables:[{symbol:"d",name:"Nozzle Bore",description:"Inside diameter of nozzle opening",unit:"m",defaultValue:null},{symbol:"t_r",name:"Required Shell Thickness",description:"Minimum required thickness of shell",unit:"m",defaultValue:null},{symbol:"F",name:"Correction Factor",description:"1.0 for radial nozzles",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"A_req",name:"Required Reinforcement Area",unit:"m¬≤"} },

"pressure vessel volume cylinder": { cat:"Pressure Vessels", standard:"ASME VIII Div.1", standardName:"ASME Boiler and Pressure Vessel Code", description:"Volume of a cylindrical pressure vessel shell.", formula:"V = œÄ √ó r¬≤ √ó L", formulaDescription:"r = inside radius; L = shell length.", variables:[{symbol:"r",name:"Inside Radius",description:"Internal radius of vessel",unit:"m",defaultValue:null},{symbol:"L",name:"Shell Length",description:"Tangent-to-tangent length",unit:"m",defaultValue:null}], resultVariable:{symbol:"V",name:"Shell Volume",unit:"m¬≥"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 5. HVAC / BUILDING SERVICES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"hvac sensible cooling load": { cat:"HVAC", standard:"ASHRAE 62.1", standardName:"Ventilation and Acceptable Indoor Air Quality", description:"Sensible cooling load from supply air.", formula:"Q_s = 1.21 √ó V √ó ŒîT", formulaDescription:"Simplified sensible load: 1.21 = œÅ√ócp for standard air.", variables:[{symbol:"V",name:"Air Flow Rate",description:"Supply air volume flow",unit:"m¬≥/s",defaultValue:null},{symbol:"ŒîT",name:"Temperature Difference",description:"Supply vs room temp.",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"Q_s",name:"Sensible Cooling Load",unit:"W"} },

"hvac latent load": { cat:"HVAC", standard:"ASHRAE 62.1", standardName:"Ventilation and Acceptable Indoor Air Quality", description:"Latent cooling load from supply air moisture removal.", formula:"Q_L = 3010 √ó V √ó ŒîW", formulaDescription:"ŒîW = moisture content difference (kg/kg dry air).", variables:[{symbol:"V",name:"Air Flow Rate",description:"Supply air volume flow",unit:"m¬≥/s",defaultValue:null},{symbol:"ŒîW",name:"Moisture Difference",description:"Humidity ratio difference",unit:"kg/kg",defaultValue:null}], resultVariable:{symbol:"Q_L",name:"Latent Load",unit:"W"} },

"hvac duct velocity": { cat:"HVAC", standard:"CIBSE Guide B2", standardName:"Ventilation and Air Conditioning", description:"Air velocity in a rectangular or circular duct.", formula:"v = Q / A", formulaDescription:"Typical supply air duct velocity 5‚Äì8 m/s.", variables:[{symbol:"Q",name:"Air Flow Rate",description:"Volume flow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"A",name:"Duct Cross-section Area",description:"Internal area of duct",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"v",name:"Duct Velocity",unit:"m/s"} },

"hvac duct pressure loss": { cat:"HVAC", standard:"CIBSE Guide B2", standardName:"Ventilation and Air Conditioning", description:"Pressure drop per unit length in circular ductwork.", formula:"ŒîP/L = f √ó (œÅ √ó v¬≤) / (2 √ó D)", formulaDescription:"Typically aim for 1 Pa/m in design.", variables:[{symbol:"f",name:"Friction Factor",description:"Darcy friction factor",unit:"dimensionless",defaultValue:0.02},{symbol:"œÅ",name:"Air Density",description:"Air density at conditions (~1.2 kg/m¬≥)",unit:"kg/m¬≥",defaultValue:1.2},{symbol:"v",name:"Air Velocity",description:"Velocity in duct",unit:"m/s",defaultValue:null},{symbol:"D",name:"Duct Diameter",description:"Hydraulic diameter",unit:"m",defaultValue:null}], resultVariable:{symbol:"ŒîP_L",name:"Pressure Drop per Metre",unit:"Pa/m"} },

"hvac outside air requirement": { cat:"HVAC", standard:"ASHRAE 62.1 / BS EN 15251", standardName:"Ventilation for Acceptable Indoor Air Quality", description:"Minimum outside air supply rate per person.", formula:"Q_oa = Rp √ó Pz + Ra √ó Az", formulaDescription:"Rp = per-person rate; Ra = per-area rate; Pz = occupants; Az = area.", variables:[{symbol:"Rp",name:"Per-person Rate",description:"Min OA per person (typical 10 L/s/person)",unit:"L/s",defaultValue:10},{symbol:"Pz",name:"Number of Occupants",description:"Zone peak occupancy",unit:"persons",defaultValue:null},{symbol:"Ra",name:"Per-area Rate",description:"Min OA per floor area (typical 0.3 L/s/m¬≤)",unit:"L/s/m¬≤",defaultValue:0.3},{symbol:"Az",name:"Zone Floor Area",description:"Zone floor area",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"Q_oa",name:"Outside Air Flow Rate",unit:"L/s"} },

"cooling tower range": { cat:"HVAC", standard:"ASHRAE 90.1", standardName:"Energy Standard for Buildings", description:"Cooling tower thermal range (inlet vs outlet water temperature).", formula:"Range = T_in - T_out", formulaDescription:"Typical range 5‚Äì10¬∞C.", variables:[{symbol:"T_in",name:"Condenser Water Inlet Temp",description:"Warm water entering tower",unit:"¬∞C",defaultValue:null},{symbol:"T_out",name:"Condenser Water Outlet Temp",description:"Cooled water leaving tower",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"Range",name:"Cooling Tower Range",unit:"¬∞C"} },

"chiller cop": { cat:"HVAC", standard:"ASHRAE 90.1", standardName:"Energy Standard for Buildings", description:"Coefficient of performance of a chiller plant.", formula:"COP = Q_evap / W_comp", formulaDescription:"Higher COP = more efficient. Typical range 3‚Äì7.", variables:[{symbol:"Q_evap",name:"Cooling Capacity",description:"Refrigeration effect at evaporator",unit:"W",defaultValue:null},{symbol:"W_comp",name:"Compressor Power",description:"Electrical power input to compressor",unit:"W",defaultValue:null}], resultVariable:{symbol:"COP",name:"Coefficient of Performance",unit:"dimensionless"} },

"refrigeration cycle heat rejection": { cat:"HVAC", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Heat rejected at condenser in refrigeration cycle.", formula:"Q_cond = Q_evap + W_comp", formulaDescription:"Energy balance on refrigerant cycle.", variables:[{symbol:"Q_evap",name:"Cooling Load",description:"Heat absorbed at evaporator",unit:"W",defaultValue:null},{symbol:"W_comp",name:"Compressor Power",description:"Compressor electrical input",unit:"W",defaultValue:null}], resultVariable:{symbol:"Q_cond",name:"Condenser Heat Rejection",unit:"W"} },

"boiler efficiency": { cat:"HVAC", standard:"BS EN 15502", standardName:"Gas-fired central heating boilers", description:"Gross thermal efficiency of a boiler.", formula:"Œ∑ = Q_output / Q_input", formulaDescription:"Q_input = fuel energy input (calorific value √ó fuel flow).", variables:[{symbol:"Q_output",name:"Useful Heat Output",description:"Heat delivered to heating system",unit:"W",defaultValue:null},{symbol:"Q_input",name:"Fuel Energy Input",description:"Lower calorific value √ó fuel flow",unit:"W",defaultValue:null}], resultVariable:{symbol:"Œ∑",name:"Boiler Efficiency",unit:"dimensionless"} },

"radiant panel heat output": { cat:"HVAC", standard:"BS EN 14037", standardName:"Ceiling-mounted radiant heating panels", description:"Heat output of ceiling-mounted radiant panel.", formula:"q = C √ó (T_p - T_r)^1.33", formulaDescription:"T_p = panel surface temp; T_r = room temp; C ‚âà 4.0‚Äì6.0.", variables:[{symbol:"C",name:"Panel Constant",description:"Panel-specific constant (~5.5)",unit:"W/(m¬≤¬∑K^1.33)",defaultValue:5.5},{symbol:"T_p",name:"Panel Surface Temperature",description:"Mean panel temperature",unit:"¬∞C",defaultValue:null},{symbol:"T_r",name:"Room Temperature",description:"Air/MRT temperature",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"q",name:"Specific Heat Output",unit:"W/m¬≤"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 6. ELECTRICAL ENGINEERING
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"ohms law voltage": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Ohm's law ‚Äî relationship between voltage, current and resistance.", formula:"V = I √ó R", formulaDescription:"Fundamental circuit relationship.", variables:[{symbol:"I",name:"Current",description:"Electric current",unit:"A",defaultValue:null},{symbol:"R",name:"Resistance",description:"Circuit resistance",unit:"Œ©",defaultValue:null}], resultVariable:{symbol:"V",name:"Voltage",unit:"V"} },

"ohms law current": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Current from voltage and resistance.", formula:"I = V / R", formulaDescription:"Ohm's law rearranged for current.", variables:[{symbol:"V",name:"Voltage",description:"Applied voltage",unit:"V",defaultValue:null},{symbol:"R",name:"Resistance",description:"Circuit resistance",unit:"Œ©",defaultValue:null}], resultVariable:{symbol:"I",name:"Current",unit:"A"} },

"electrical power dc": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"DC electrical power.", formula:"P = V √ó I", formulaDescription:"Power = voltage √ó current.", variables:[{symbol:"V",name:"Voltage",description:"DC voltage",unit:"V",defaultValue:null},{symbol:"I",name:"Current",description:"DC current",unit:"A",defaultValue:null}], resultVariable:{symbol:"P",name:"Power",unit:"W"} },

"electrical power resistance": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Power dissipated in a resistor.", formula:"P = I¬≤ √ó R", formulaDescription:"Joule heating equation.", variables:[{symbol:"I",name:"Current",description:"Current through resistor",unit:"A",defaultValue:null},{symbol:"R",name:"Resistance",description:"Resistance value",unit:"Œ©",defaultValue:null}], resultVariable:{symbol:"P",name:"Power Dissipated",unit:"W"} },

"3 phase power": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Three-phase electrical power (balanced load).", formula:"P = ‚àö3 √ó V_L √ó I_L √ó cos(œÜ)", formulaDescription:"V_L = line voltage; I_L = line current; cos(œÜ) = power factor.", variables:[{symbol:"V_L",name:"Line Voltage",description:"Line-to-line voltage",unit:"V",defaultValue:null},{symbol:"I_L",name:"Line Current",description:"Line current",unit:"A",defaultValue:null},{symbol:"cos_œÜ",name:"Power Factor",description:"cos(œÜ) typically 0.8‚Äì1.0",unit:"dimensionless",defaultValue:0.85}], resultVariable:{symbol:"P",name:"Active Power",unit:"W"} },

"apparent power": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Apparent power in an AC circuit.", formula:"S = V √ó I", formulaDescription:"S = ‚àö(P¬≤ + Q¬≤); includes reactive component.", variables:[{symbol:"V",name:"Voltage (RMS)",description:"RMS voltage",unit:"V",defaultValue:null},{symbol:"I",name:"Current (RMS)",description:"RMS current",unit:"A",defaultValue:null}], resultVariable:{symbol:"S",name:"Apparent Power",unit:"VA"} },

"power factor": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Power factor of an AC load.", formula:"PF = P / S", formulaDescription:"Ratio of active to apparent power.", variables:[{symbol:"P",name:"Active Power",description:"Real power",unit:"W",defaultValue:null},{symbol:"S",name:"Apparent Power",description:"Apparent power",unit:"VA",defaultValue:null}], resultVariable:{symbol:"PF",name:"Power Factor",unit:"dimensionless"} },

"cable voltage drop": { cat:"Electrical", standard:"BS 7671 / IEC 60364-5-52", standardName:"Requirements for Electrical Installations", description:"Voltage drop in a single-phase cable circuit.", formula:"ŒîV = 2 √ó I √ó (R √ó cos(œÜ) + X √ó sin(œÜ)) √ó L", formulaDescription:"Limit per BS 7671: 3% for lighting, 5% for power. L in km.", variables:[{symbol:"I",name:"Design Current",description:"Circuit current",unit:"A",defaultValue:null},{symbol:"R",name:"Cable Resistance",description:"Resistance per km (from manufacturer)",unit:"Œ©/km",defaultValue:null},{symbol:"cos_œÜ",name:"Power Factor",description:"Load power factor",unit:"dimensionless",defaultValue:0.85},{symbol:"X",name:"Cable Reactance",description:"Reactance per km",unit:"Œ©/km",defaultValue:0.08},{symbol:"sin_œÜ",name:"sin(œÜ)",description:"sin of power factor angle",unit:"dimensionless",defaultValue:0.527},{symbol:"L",name:"Cable Length",description:"One-way cable length",unit:"km",defaultValue:null}], resultVariable:{symbol:"ŒîV",name:"Voltage Drop",unit:"V"} },

"cable ampacity derating": { cat:"Electrical", standard:"BS 7671 / IEC 60364-5-52", standardName:"Requirements for Electrical Installations", description:"Derated cable current-carrying capacity.", formula:"I_z = I_t √ó C_a √ó C_g √ó C_c", formulaDescription:"C_a=ambient temp; C_g=grouping; C_c=soil thermal resistivity.", variables:[{symbol:"I_t",name:"Tabulated Capacity",description:"From cable tables",unit:"A",defaultValue:null},{symbol:"C_a",name:"Ambient Temp Factor",description:"From BS 7671 Table",unit:"dimensionless",defaultValue:1.0},{symbol:"C_g",name:"Grouping Factor",description:"From BS 7671 Table",unit:"dimensionless",defaultValue:0.8},{symbol:"C_c",name:"Soil/Duct Factor",description:"From BS 7671 Table",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"I_z",name:"Derated Current Capacity",unit:"A"} },

"earth fault loop impedance": { cat:"Electrical", standard:"BS 7671", standardName:"Requirements for Electrical Installations (IET Wiring Regs)", description:"Earth fault loop impedance for protective device check.", formula:"Z_s = Z_e + R1 + R2", formulaDescription:"Z_e = external loop; R1 = line conductor; R2 = PE conductor. Must satisfy I_a.", variables:[{symbol:"Z_e",name:"External Impedance",description:"Impedance upstream of installation",unit:"Œ©",defaultValue:null},{symbol:"R1",name:"Line Conductor Resistance",description:"Resistance of phase conductor",unit:"Œ©",defaultValue:null},{symbol:"R2",name:"PE Conductor Resistance",description:"Resistance of protective conductor",unit:"Œ©",defaultValue:null}], resultVariable:{symbol:"Z_s",name:"Earth Fault Loop Impedance",unit:"Œ©"} },

"transformer turns ratio": { cat:"Electrical", standard:"IEC 60076", standardName:"Power transformers", description:"Voltage transformation ratio of an ideal transformer.", formula:"V2/V1 = N2/N1", formulaDescription:"Neglects losses. Actual secondary voltage slightly lower.", variables:[{symbol:"V1",name:"Primary Voltage",description:"Primary winding voltage",unit:"V",defaultValue:null},{symbol:"N1",name:"Primary Turns",description:"Number of primary turns",unit:"turns",defaultValue:null},{symbol:"N2",name:"Secondary Turns",description:"Number of secondary turns",unit:"turns",defaultValue:null}], resultVariable:{symbol:"V2",name:"Secondary Voltage",unit:"V"} },

"motor shaft power": { cat:"Electrical", standard:"IEC 60034", standardName:"Rotating electrical machines", description:"Mechanical shaft power of an electric motor.", formula:"P = T √ó œâ", formulaDescription:"œâ = 2œÄ√ón/60 where n is speed in rpm.", variables:[{symbol:"T",name:"Torque",description:"Shaft torque",unit:"N¬∑m",defaultValue:null},{symbol:"œâ",name:"Angular Velocity",description:"Rotational speed in rad/s",unit:"rad/s",defaultValue:null}], resultVariable:{symbol:"P",name:"Shaft Power",unit:"W"} },

"motor efficiency": { cat:"Electrical", standard:"IEC 60034-30", standardName:"Rotating electrical machines ‚Äî Efficiency classes", description:"Efficiency of an electric motor.", formula:"Œ∑ = P_shaft / P_electrical", formulaDescription:"IE1‚ÄìIE4 efficiency classes. IE3 minimum for 0.75‚Äì375 kW.", variables:[{symbol:"P_shaft",name:"Mechanical Output Power",description:"Shaft power output",unit:"W",defaultValue:null},{symbol:"P_electrical",name:"Electrical Input Power",description:"Electrical power consumed",unit:"W",defaultValue:null}], resultVariable:{symbol:"Œ∑",name:"Motor Efficiency",unit:"dimensionless"} },

"reactive power correction": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Reactive power compensation to improve power factor.", formula:"Q_c = P √ó (tan(œÜ1) - tan(œÜ2))", formulaDescription:"Q_c = capacitor kVAr required.", variables:[{symbol:"P",name:"Active Power",description:"Load active power",unit:"W",defaultValue:null},{symbol:"tan_œÜ1",name:"tan(œÜ‚ÇÅ)",description:"Original power factor angle tangent",unit:"dimensionless",defaultValue:null},{symbol:"tan_œÜ2",name:"tan(œÜ‚ÇÇ)",description:"Target power factor angle tangent",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"Q_c",name:"Reactive Power Required",unit:"VAr"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 7. CIVIL / GEOTECHNICAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"bearing capacity terzaghi": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7 ‚Äî Geotechnical design", description:"Ultimate bearing capacity of a shallow foundation (Terzaghi).", formula:"q_u = c √ó Nc + q √ó Nq + 0.5 √ó Œ≥ √ó B √ó NŒ≥", formulaDescription:"c = cohesion; q = surcharge; Œ≥ = soil unit weight; B = width; Nc/Nq/NŒ≥ = bearing capacity factors.", variables:[{symbol:"c",name:"Cohesion",description:"Undrained soil cohesion",unit:"Pa",defaultValue:null},{symbol:"Nc",name:"Nc Factor",description:"Bearing capacity factor (œÜ=0: Nc=5.14)",unit:"dimensionless",defaultValue:5.14},{symbol:"q",name:"Overburden Pressure",description:"Surcharge = Œ≥ √ó depth",unit:"Pa",defaultValue:null},{symbol:"Nq",name:"Nq Factor",description:"Bearing capacity factor",unit:"dimensionless",defaultValue:1},{symbol:"Œ≥",name:"Soil Unit Weight",description:"Effective unit weight",unit:"N/m¬≥",defaultValue:null},{symbol:"B",name:"Foundation Width",description:"Shorter plan dimension",unit:"m",defaultValue:null},{symbol:"NŒ≥",name:"NŒ≥ Factor",description:"Bearing capacity factor",unit:"dimensionless",defaultValue:0}], resultVariable:{symbol:"q_u",name:"Ultimate Bearing Capacity",unit:"Pa"} },

"settlement consolidation": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Primary consolidation settlement of saturated clay.", formula:"s = (Cc / (1 + e0)) √ó H √ó log10((œÉ'0 + ŒîœÉ') / œÉ'0)", formulaDescription:"Cc = compression index; e0 = initial void ratio; H = layer thickness.", variables:[{symbol:"Cc",name:"Compression Index",description:"Slope of e-log p curve",unit:"dimensionless",defaultValue:null},{symbol:"e0",name:"Initial Void Ratio",description:"In-situ void ratio",unit:"dimensionless",defaultValue:null},{symbol:"H",name:"Layer Thickness",description:"Thickness of compressible layer",unit:"m",defaultValue:null},{symbol:"œÉ'0",name:"Initial Effective Stress",description:"Effective overburden pressure",unit:"Pa",defaultValue:null},{symbol:"ŒîœÉ'",name:"Stress Increment",description:"Added effective stress from loading",unit:"Pa",defaultValue:null}], resultVariable:{symbol:"s",name:"Consolidation Settlement",unit:"m"} },

"active earth pressure rankine": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Active earth pressure coefficient (Rankine).", formula:"Ka = (1 - sin(œÜ)) / (1 + sin(œÜ))", formulaDescription:"For cohesionless soil; total active pressure P_a = 0.5 √ó Ka √ó Œ≥ √ó H¬≤.", variables:[{symbol:"œÜ",name:"Friction Angle",description:"Angle of internal friction (radians)",unit:"rad",defaultValue:null}], resultVariable:{symbol:"Ka",name:"Active Pressure Coefficient",unit:"dimensionless"} },

"passive earth pressure rankine": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Passive earth pressure coefficient (Rankine).", formula:"Kp = (1 + sin(œÜ)) / (1 - sin(œÜ))", formulaDescription:"Passive pressure resists wall movement.", variables:[{symbol:"œÜ",name:"Friction Angle",description:"Angle of internal friction (radians)",unit:"rad",defaultValue:null}], resultVariable:{symbol:"Kp",name:"Passive Pressure Coefficient",unit:"dimensionless"} },

"retaining wall overturning check": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Overturning stability check for a gravity retaining wall.", formula:"FoS = M_stabilising / M_overturning", formulaDescription:"Minimum FoS = 2.0 (unfactored); use partial factors per EC7.", variables:[{symbol:"M_stabilising",name:"Stabilising Moment",description:"Sum of stabilising moments about toe",unit:"N¬∑m",defaultValue:null},{symbol:"M_overturning",name:"Overturning Moment",description:"Sum of overturning moments about toe",unit:"N¬∑m",defaultValue:null}], resultVariable:{symbol:"FoS",name:"Factor of Safety",unit:"dimensionless"} },

"pile capacity end bearing": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"End bearing capacity of a pile.", formula:"Q_b = q_b √ó A_b", formulaDescription:"q_b = unit end bearing; A_b = pile base area.", variables:[{symbol:"q_b",name:"Unit End Bearing",description:"End bearing stress at pile tip",unit:"Pa",defaultValue:null},{symbol:"A_b",name:"Pile Base Area",description:"Cross-sectional area at pile base",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"Q_b",name:"End Bearing Capacity",unit:"N"} },

"concrete cube strength characteristic": { cat:"Geotechnical", standard:"BS EN 206", standardName:"Concrete ‚Äî Specification, performance, production and conformity", description:"Characteristic compressive strength of concrete (5th percentile).", formula:"f_ck = f_cm - 8", formulaDescription:"f_cm = mean cube strength; 8 MPa margin for standard deviation.", variables:[{symbol:"f_cm",name:"Mean Compressive Strength",description:"Mean cylinder strength",unit:"MPa",defaultValue:null}], resultVariable:{symbol:"f_ck",name:"Characteristic Strength",unit:"MPa"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 8. CONCRETE & REINFORCED CONCRETE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"concrete beam moment capacity": { cat:"Concrete", standard:"BS EN 1992-1-1", standardName:"Eurocode 2 ‚Äî Design of concrete structures", description:"Ultimate moment capacity of a singly reinforced rectangular concrete beam.", formula:"M_Rd = A_s √ó f_yd √ó (d - 0.4 √ó x)", formulaDescription:"Simplified rectangular stress block; x = neutral axis depth.", variables:[{symbol:"A_s",name:"Tension Steel Area",description:"Area of tension reinforcement",unit:"m¬≤",defaultValue:null},{symbol:"f_yd",name:"Design Yield Strength",description:"f_yk / Œ≥_s (typically f_yk=500 MPa, Œ≥_s=1.15)",unit:"Pa",defaultValue:434782609},{symbol:"d",name:"Effective Depth",description:"Depth to tension steel centroid",unit:"m",defaultValue:null},{symbol:"x",name:"Neutral Axis Depth",description:"Depth of neutral axis from compression face",unit:"m",defaultValue:null}], resultVariable:{symbol:"M_Rd",name:"Design Moment Resistance",unit:"N¬∑m"} },

"concrete shear capacity": { cat:"Concrete", standard:"BS EN 1992-1-1", standardName:"Eurocode 2", description:"Shear resistance of a reinforced concrete beam without shear links.", formula:"V_Rd,c = [0.12√ók√ó(100√óœÅl√ófck)^(1/3)] √ó bw √ó d", formulaDescription:"k = 1+‚àö(200/d) ‚â§ 2.0; œÅl = As/(bw√ód).", variables:[{symbol:"k",name:"Size Effect Factor",description:"1 + ‚àö(200/d), max 2.0",unit:"dimensionless",defaultValue:null},{symbol:"œÅl",name:"Longitudinal Reinforcement Ratio",description:"As/(bw√ód)",unit:"dimensionless",defaultValue:null},{symbol:"f_ck",name:"Concrete Compressive Strength",description:"Characteristic strength",unit:"MPa",defaultValue:null},{symbol:"bw",name:"Section Width",description:"Web width of section",unit:"m",defaultValue:null},{symbol:"d",name:"Effective Depth",description:"Depth to tension reinforcement",unit:"m",defaultValue:null}], resultVariable:{symbol:"V_Rd_c",name:"Shear Resistance",unit:"N"} },

"concrete column axial capacity": { cat:"Concrete", standard:"BS EN 1992-1-1", standardName:"Eurocode 2", description:"Axial load capacity of a short reinforced concrete column.", formula:"N_Rd = 0.8 √ó (A_c √ó f_cd + A_sc √ó f_yd)", formulaDescription:"Short column (slenderness < 15). f_cd = fck/1.5; f_yd = fyk/1.15.", variables:[{symbol:"A_c",name:"Concrete Area",description:"Net concrete cross-section area",unit:"m¬≤",defaultValue:null},{symbol:"f_cd",name:"Design Concrete Strength",description:"f_ck / 1.5",unit:"Pa",defaultValue:null},{symbol:"A_sc",name:"Steel Area",description:"Total reinforcement area",unit:"m¬≤",defaultValue:null},{symbol:"f_yd",name:"Design Steel Strength",description:"f_yk / 1.15",unit:"Pa",defaultValue:434782609}], resultVariable:{symbol:"N_Rd",name:"Design Axial Capacity",unit:"N"} },

"crack width eurocode": { cat:"Concrete", standard:"BS EN 1992-1-1 Cl.7.3", standardName:"Eurocode 2", description:"Characteristic crack width in reinforced concrete.", formula:"w_k = S_r,max √ó (Œµ_sm - Œµ_cm)", formulaDescription:"S_r,max = maximum crack spacing; Œµ_sm and Œµ_cm are mean strains.", variables:[{symbol:"S_rmax",name:"Max Crack Spacing",description:"From EC2 Eq.7.11",unit:"m",defaultValue:null},{symbol:"Œµ_sm",name:"Mean Strain in Steel",description:"Steel strain between cracks",unit:"dimensionless",defaultValue:null},{symbol:"Œµ_cm",name:"Mean Strain in Concrete",description:"Concrete strain between cracks",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"w_k",name:"Characteristic Crack Width",unit:"m"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 9. FIRE PROTECTION ‚Äî BS EN / NFPA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"sprinkler system flow": { cat:"Fire Protection", standard:"BS EN 12845 / NFPA 13", standardName:"Fixed firefighting systems ‚Äî Automatic sprinkler systems", description:"Flow from a sprinkler head.", formula:"Q = K √ó ‚àöP", formulaDescription:"K-factor from manufacturer; P = inlet pressure.", variables:[{symbol:"K",name:"K-factor",description:"Sprinkler K-factor (80 L/min/bar^0.5 typical)",unit:"L/min/bar^0.5",defaultValue:80},{symbol:"P",name:"Inlet Pressure",description:"Pressure at sprinkler inlet",unit:"bar",defaultValue:null}], resultVariable:{symbol:"Q",name:"Sprinkler Flow",unit:"L/min"} },

"sprinkler area of coverage": { cat:"Fire Protection", standard:"BS EN 12845", standardName:"Fixed firefighting systems ‚Äî Automatic sprinkler systems", description:"Maximum area of coverage per sprinkler head.", formula:"A = S √ó D", formulaDescription:"S = spacing between heads along branch; D = distance between branches.", variables:[{symbol:"S",name:"Head Spacing",description:"Distance between sprinkler heads on branch",unit:"m",defaultValue:null},{symbol:"D",name:"Branch Spacing",description:"Distance between branch lines",unit:"m",defaultValue:null}], resultVariable:{symbol:"A",name:"Coverage Area per Head",unit:"m¬≤"} },

"fire hose reel flow": { cat:"Fire Protection", standard:"BS EN 671-1", standardName:"Fixed firefighting systems ‚Äî Hose reels", description:"Minimum flow rate from fire hose reel.", formula:"Q = 0.4 L/s per hose reel", formulaDescription:"BS EN 671-1 requirement: minimum 0.4 L/s at 400 kPa.", variables:[], resultVariable:{symbol:"Q",name:"Min Flow Rate",unit:"L/s"} },

"fire load density": { cat:"Fire Protection", standard:"BS EN 1991-1-2", standardName:"Eurocode 1 ‚Äî Actions on structures ‚Äî Fire actions", description:"Design fire load density for structural fire design.", formula:"q_fd = Œ¥_q1 √ó Œ¥_q2 √ó Œ¥_n √ó q_f", formulaDescription:"Œ¥_q1/q2 = risk factors for size and activation; Œ¥_n = detection factors.", variables:[{symbol:"Œ¥_q1",name:"Risk Factor q1",description:"Related to floor area",unit:"dimensionless",defaultValue:1.0},{symbol:"Œ¥_q2",name:"Risk Factor q2",description:"Related to fire activation risk",unit:"dimensionless",defaultValue:1.0},{symbol:"Œ¥_n",name:"Active Measure Factor",description:"For sprinklers, detection etc",unit:"dimensionless",defaultValue:0.6},{symbol:"q_f",name:"Fire Load Density",description:"Characteristic fire load per floor area",unit:"MJ/m¬≤",defaultValue:511}], resultVariable:{symbol:"q_fd",name:"Design Fire Load",unit:"MJ/m¬≤"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 10. WATER & DRAINAGE ‚Äî BS EN 752 / BS EN 12056
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"gravity drain sizing": { cat:"Drainage", standard:"BS EN 12056-3", standardName:"Gravity drainage systems inside buildings ‚Äî Roof drainage", description:"Flow capacity of a gravity drain at partial full condition.", formula:"Q = A √ó v √ó (d/D)^(2/3)", formulaDescription:"Manning-based approximation at 75% depth-of-flow criterion.", variables:[{symbol:"A",name:"Pipe Full Area",description:"Cross-sectional area when full",unit:"m¬≤",defaultValue:null},{symbol:"v",name:"Velocity at Full Flow",description:"Manning velocity when full",unit:"m/s",defaultValue:null},{symbol:"d_D",name:"d/D Ratio",description:"Design depth of flow / pipe dia (0.75 typical)",unit:"dimensionless",defaultValue:0.75}], resultVariable:{symbol:"Q",name:"Flow Capacity",unit:"m¬≥/s"} },

"manning velocity": { cat:"Drainage", standard:"BS EN 752 / Sewers for Adoption", standardName:"Drain and Sewer Systems Outside Buildings", description:"Manning's equation for flow velocity in an open channel or partially full drain.", formula:"v = (1/n) √ó R^(2/3) √ó S^(1/2)", formulaDescription:"n = Manning roughness; R = hydraulic radius = A/P; S = hydraulic gradient.", variables:[{symbol:"n",name:"Manning's n",description:"Roughness coefficient (concrete 0.013; PVC 0.010)",unit:"s/m^(1/3)",defaultValue:0.013},{symbol:"R",name:"Hydraulic Radius",description:"Flow area / wetted perimeter",unit:"m",defaultValue:null},{symbol:"S",name:"Hydraulic Slope",description:"Pipe gradient m/m",unit:"m/m",defaultValue:null}], resultVariable:{symbol:"v",name:"Flow Velocity",unit:"m/s"} },

"weir flow": { cat:"Drainage", standard:"BS EN 752", standardName:"Drain and Sewer Systems", description:"Flow over a sharp-crested weir.", formula:"Q = 1.84 √ó L √ó H^1.5", formulaDescription:"Francis formula; L = weir length; H = head over weir crest.", variables:[{symbol:"L",name:"Weir Length",description:"Effective crest length",unit:"m",defaultValue:null},{symbol:"H",name:"Head over Crest",description:"Water depth above weir crest",unit:"m",defaultValue:null}], resultVariable:{symbol:"Q",name:"Weir Flow Rate",unit:"m¬≥/s"} },

"roof drainage area": { cat:"Drainage", standard:"BS EN 12056-3", standardName:"Gravity drainage systems ‚Äî Roof drainage", description:"Design flow from a flat roof catchment.", formula:"Q = i √ó A / 1000", formulaDescription:"i = rainfall intensity (L/min/m¬≤); A = catchment area (m¬≤).", variables:[{symbol:"i",name:"Rainfall Intensity",description:"Design rainfall intensity",unit:"L/min/m¬≤",defaultValue:0.042},{symbol:"A",name:"Catchment Area",description:"Plan area of roof",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"Q",name:"Design Flow Rate",unit:"L/s"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 11. MECHANICAL ‚Äî GENERAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"mechanical power rotational": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics quantities", description:"Mechanical power from torque and rotational speed.", formula:"P = T √ó œâ = T √ó 2œÄ √ó n / 60", formulaDescription:"n in rpm; œâ = angular velocity in rad/s.", variables:[{symbol:"T",name:"Torque",description:"Shaft torque",unit:"N¬∑m",defaultValue:null},{symbol:"n",name:"Rotational Speed",description:"Speed in rpm",unit:"rpm",defaultValue:null}], resultVariable:{symbol:"P",name:"Mechanical Power",unit:"W"} },

"gear ratio": { cat:"Mechanical", standard:"BS ISO 6336", standardName:"Calculation of load capacity of spur and helical gears", description:"Gear ratio between two meshing gears.", formula:"i = n1/n2 = z2/z1", formulaDescription:"Speed ratio inversely proportional to number of teeth.", variables:[{symbol:"n1",name:"Input Speed",description:"Speed of driving gear",unit:"rpm",defaultValue:null},{symbol:"n2",name:"Output Speed",description:"Speed of driven gear",unit:"rpm",defaultValue:null}], resultVariable:{symbol:"i",name:"Gear Ratio",unit:"dimensionless"} },

"belt drive velocity ratio": { cat:"Mechanical", standard:"BS ISO 22:", standardName:"Belt drives", description:"Velocity ratio of a belt drive.", formula:"VR = D2 / D1 = n1 / n2", formulaDescription:"D = pulley diameter.", variables:[{symbol:"D1",name:"Driver Pulley Diameter",description:"Diameter of driving pulley",unit:"m",defaultValue:null},{symbol:"D2",name:"Driven Pulley Diameter",description:"Diameter of driven pulley",unit:"m",defaultValue:null},{symbol:"n1",name:"Driver Speed",description:"Speed of driving pulley",unit:"rpm",defaultValue:null}], resultVariable:{symbol:"n2",name:"Driven Speed",unit:"rpm"} },

"spring deflection hooke": { cat:"Mechanical", standard:"BS EN 13906", standardName:"Cylindrical helical springs ‚Äî Calculation and design", description:"Linear spring deflection under load.", formula:"Œ¥ = F / k", formulaDescription:"Hooke's law for springs.", variables:[{symbol:"F",name:"Applied Load",description:"Force applied to spring",unit:"N",defaultValue:null},{symbol:"k",name:"Spring Stiffness",description:"Spring constant (N/m)",unit:"N/m",defaultValue:null}], resultVariable:{symbol:"Œ¥",name:"Spring Deflection",unit:"m"} },

"spring stiffness helical": { cat:"Mechanical", standard:"BS EN 13906", standardName:"Cylindrical helical springs ‚Äî Calculation and design", description:"Stiffness of a helical compression spring.", formula:"k = (G √ó d‚Å¥) / (8 √ó D¬≥ √ó n_a)", formulaDescription:"G = shear modulus; d = wire dia; D = coil dia; n_a = active coils.", variables:[{symbol:"G",name:"Shear Modulus",description:"Shear modulus of wire (steel ~79 GPa)",unit:"Pa",defaultValue:79000000000},{symbol:"d",name:"Wire Diameter",description:"Diameter of spring wire",unit:"m",defaultValue:null},{symbol:"D",name:"Coil Diameter",description:"Mean coil diameter",unit:"m",defaultValue:null},{symbol:"n_a",name:"Active Coils",description:"Number of active coils",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"k",name:"Spring Stiffness",unit:"N/m"} },

"centripetal force": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Centripetal force on a rotating mass.", formula:"F = m √ó v¬≤ / r", formulaDescription:"Or F = m √ó œâ¬≤ √ó r.", variables:[{symbol:"m",name:"Mass",description:"Rotating mass",unit:"kg",defaultValue:null},{symbol:"v",name:"Tangential Velocity",description:"Velocity at radius r",unit:"m/s",defaultValue:null},{symbol:"r",name:"Radius",description:"Radius of rotation",unit:"m",defaultValue:null}], resultVariable:{symbol:"F",name:"Centripetal Force",unit:"N"} },

"momentum linear": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Linear momentum of a moving body.", formula:"p = m √ó v", formulaDescription:"Newton's second law: F = dp/dt.", variables:[{symbol:"m",name:"Mass",description:"Mass of body",unit:"kg",defaultValue:null},{symbol:"v",name:"Velocity",description:"Velocity of body",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"p",name:"Linear Momentum",unit:"kg¬∑m/s"} },

"kinetic energy": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Kinetic energy of a moving body.", formula:"KE = 0.5 √ó m √ó v¬≤", formulaDescription:"Translational kinetic energy.", variables:[{symbol:"m",name:"Mass",description:"Mass of body",unit:"kg",defaultValue:null},{symbol:"v",name:"Velocity",description:"Velocity of body",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"KE",name:"Kinetic Energy",unit:"J"} },

"potential energy": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Gravitational potential energy.", formula:"PE = m √ó g √ó h", formulaDescription:"Relative to chosen datum.", variables:[{symbol:"m",name:"Mass",description:"Mass of body",unit:"kg",defaultValue:null},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"h",name:"Height",description:"Height above datum",unit:"m",defaultValue:null}], resultVariable:{symbol:"PE",name:"Potential Energy",unit:"J"} },

"impact force": { cat:"Mechanical", standard:"BS EN 1991-1-1", standardName:"Eurocode 1 ‚Äî Actions", description:"Average impact force during a collision assuming constant deceleration.", formula:"F = m √ó v¬≤ / (2 √ó d)", formulaDescription:"d = stopping distance; based on energy method.", variables:[{symbol:"m",name:"Mass",description:"Mass of impacting body",unit:"kg",defaultValue:null},{symbol:"v",name:"Impact Velocity",description:"Velocity at impact",unit:"m/s",defaultValue:null},{symbol:"d",name:"Stopping Distance",description:"Deformation during impact",unit:"m",defaultValue:null}], resultVariable:{symbol:"F",name:"Impact Force",unit:"N"} },

"natural frequency spring mass": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Natural frequency of a simple spring-mass system.", formula:"f_n = (1/(2œÄ)) √ó ‚àö(k/m)", formulaDescription:"Undamped natural frequency.", variables:[{symbol:"k",name:"Spring Stiffness",description:"Stiffness constant",unit:"N/m",defaultValue:null},{symbol:"m",name:"Mass",description:"Suspended mass",unit:"kg",defaultValue:null}], resultVariable:{symbol:"f_n",name:"Natural Frequency",unit:"Hz"} },

"critical speed shaft": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"First critical (resonant) speed of a rotating shaft.", formula:"n_c = 60/(2œÄ) √ó ‚àö(g / Œ¥_st)", formulaDescription:"Œ¥_st = static deflection under own weight.", variables:[{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"Œ¥_st",name:"Static Deflection",description:"Deflection under self-weight",unit:"m",defaultValue:null}], resultVariable:{symbol:"n_c",name:"Critical Speed",unit:"rpm"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 12. GAS & PROCESS ENGINEERING
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"gas pipe sizing": { cat:"Gas Engineering", standard:"BS EN 1775 / IGE/UP/2", standardName:"Gas supply to buildings / Gas installations in commercial catering establishments", description:"Pressure drop in a gas distribution pipe (simplified Weymouth equation).", formula:"P1¬≤ - P2¬≤ = 1.62 √ó 10‚Åª¬≥ √ó S √ó Q¬≤ √ó L / d‚Åµ", formulaDescription:"S = specific gravity; Q = flow in m¬≥/hr; d = diameter in mm; L = length in m.", variables:[{symbol:"S",name:"Gas Specific Gravity",description:"Relative to air (natural gas ‚âà 0.6)",unit:"dimensionless",defaultValue:0.6},{symbol:"Q",name:"Gas Flow Rate",description:"Flow at standard conditions",unit:"m¬≥/hr",defaultValue:null},{symbol:"L",name:"Pipe Length",description:"Pipe length",unit:"m",defaultValue:null},{symbol:"d",name:"Internal Diameter",description:"Internal diameter",unit:"mm",defaultValue:null}], resultVariable:{symbol:"P_diff",name:"P1¬≤-P2¬≤ Pressure Term",unit:"bar¬≤"} },

"gas calorific value": { cat:"Gas Engineering", standard:"BS EN ISO 6976", standardName:"Natural gas ‚Äî Calculation of calorific values", description:"Heat output from gas consumption.", formula:"Q = V √ó CV", formulaDescription:"CV = calorific value of gas (natural gas ‚âà 38.5 MJ/m¬≥).", variables:[{symbol:"V",name:"Gas Volume",description:"Volume of gas consumed at standard conditions",unit:"m¬≥",defaultValue:null},{symbol:"CV",name:"Calorific Value",description:"Gross calorific value (natural gas ‚âà 38.5 MJ/m¬≥)",unit:"MJ/m¬≥",defaultValue:38.5}], resultVariable:{symbol:"Q",name:"Heat Energy",unit:"MJ"} },

"steam flow enthalpy": { cat:"Gas Engineering", standard:"ASME Steam Tables", standardName:"International Steam Tables", description:"Heat transfer from steam condensing at saturation.", formula:"Q = ·πÅ √ó (h_fg)", formulaDescription:"h_fg = latent heat of vaporisation from steam tables.", variables:[{symbol:"·πÅ",name:"Steam Mass Flow",description:"Mass flow of steam",unit:"kg/s",defaultValue:null},{symbol:"h_fg",name:"Latent Heat",description:"From steam tables at saturation pressure",unit:"J/kg",defaultValue:2257000}], resultVariable:{symbol:"Q",name:"Heat Transfer Rate",unit:"W"} },

"compressor power isentropic": { cat:"Gas Engineering", standard:"ASME PTC 10", standardName:"Compressors and Exhausters", description:"Isentropic power required by a gas compressor.", formula:"P = ·πÅ √ó (Œ≥/(Œ≥-1)) √ó R √ó T1 √ó ((P2/P1)^((Œ≥-1)/Œ≥) - 1) / Œ∑_is", formulaDescription:"Ideal isentropic compression. R = specific gas constant.", variables:[{symbol:"·πÅ",name:"Mass Flow Rate",description:"Mass flow of gas",unit:"kg/s",defaultValue:null},{symbol:"Œ≥",name:"Specific Heat Ratio",description:"cp/cv (air = 1.4)",unit:"dimensionless",defaultValue:1.4},{symbol:"R",name:"Specific Gas Constant",description:"Air = 287 J/(kg¬∑K)",unit:"J/(kg¬∑K)",defaultValue:287},{symbol:"T1",name:"Inlet Temperature",description:"Absolute inlet temperature",unit:"K",defaultValue:null},{symbol:"P2_P1",name:"Pressure Ratio",description:"P2/P1",unit:"dimensionless",defaultValue:null},{symbol:"Œ∑_is",name:"Isentropic Efficiency",description:"Typically 0.70‚Äì0.85",unit:"dimensionless",defaultValue:0.78}], resultVariable:{symbol:"P",name:"Compressor Power",unit:"W"} },

"relief valve sizing gas": { cat:"Gas Engineering", standard:"API 520 Part I", standardName:"Sizing, Selection and Installation of Pressure-Relieving Devices", description:"Required orifice area for a vapour/gas PRV (API 520).", formula:"A = W / (C √ó K_d √ó P1 √ó K_b √ó ‚àö(M / (T √ó Z)))", formulaDescription:"W = flow in kg/hr; C = gas constant; K_d = discharge coefficient; M = molecular weight.", variables:[{symbol:"W",name:"Required Flow",description:"Relieving mass flow",unit:"kg/hr",defaultValue:null},{symbol:"C",name:"Gas Constant C",description:"Function of Œ≥; air = 356",unit:"dimensionless",defaultValue:356},{symbol:"K_d",name:"Discharge Coefficient",description:"Typically 0.865 per API",unit:"dimensionless",defaultValue:0.865},{symbol:"P1",name:"Relieving Pressure",description:"Absolute set pressure √ó 1.1",unit:"kPa(abs)",defaultValue:null},{symbol:"K_b",name:"Backpressure Correction",description:"1.0 for conventional PRV",unit:"dimensionless",defaultValue:1.0},{symbol:"M",name:"Molecular Weight",description:"Molecular weight of gas",unit:"kg/kmol",defaultValue:29},{symbol:"T",name:"Temperature",description:"Absolute relieving temperature",unit:"K",defaultValue:null},{symbol:"Z",name:"Compressibility Factor",description:"1.0 for ideal gas",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"A",name:"Required Orifice Area",unit:"mm¬≤"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 13. ACOUSTICS & VIBRATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"sound pressure level": { cat:"Acoustics", standard:"BS EN ISO 3744", standardName:"Acoustics ‚Äî Determination of sound power levels", description:"Sound pressure level in decibels.", formula:"L_p = 20 √ó log10(p / p_ref)", formulaDescription:"p_ref = 20√ó10‚Åª‚Å∂ Pa (threshold of hearing).", variables:[{symbol:"p",name:"Sound Pressure",description:"RMS sound pressure",unit:"Pa",defaultValue:null},{symbol:"p_ref",name:"Reference Pressure",description:"2√ó10‚Åª‚Åµ Pa",unit:"Pa",defaultValue:0.00002}], resultVariable:{symbol:"L_p",name:"Sound Pressure Level",unit:"dB"} },

"noise level combination": { cat:"Acoustics", standard:"BS 4142", standardName:"Rating industrial noise affecting mixed residential and industrial areas", description:"Combination of two sound levels.", formula:"L_total = 10 √ó log10(10^(L1/10) + 10^(L2/10))", formulaDescription:"Logarithmic addition of two noise sources.", variables:[{symbol:"L1",name:"Noise Level 1",description:"First sound level",unit:"dB",defaultValue:null},{symbol:"L2",name:"Noise Level 2",description:"Second sound level",unit:"dB",defaultValue:null}], resultVariable:{symbol:"L_total",name:"Combined Noise Level",unit:"dB"} },

"noise attenuation distance": { cat:"Acoustics", standard:"ISO 9613-2", standardName:"Attenuation of sound during propagation outdoors", description:"Noise attenuation with distance (inverse square law for point source).", formula:"ŒîL = 20 √ó log10(r2/r1)", formulaDescription:"6 dB reduction per doubling of distance for a point source.", variables:[{symbol:"r1",name:"Reference Distance",description:"Distance at which L1 is known",unit:"m",defaultValue:null},{symbol:"r2",name:"Receiver Distance",description:"Distance at which to calculate L",unit:"m",defaultValue:null}], resultVariable:{symbol:"ŒîL",name:"Attenuation",unit:"dB"} },

"vibration transmissibility": { cat:"Acoustics", standard:"BS EN ISO 10816", standardName:"Mechanical vibration ‚Äî Evaluation of machine vibration", description:"Force transmissibility through a vibration isolator.", formula:"TR = ‚àö(1 + (2√óŒ∂√ór)¬≤) / ‚àö((1-r¬≤)¬≤ + (2√óŒ∂√ór)¬≤)", formulaDescription:"r = f/f_n (frequency ratio); Œ∂ = damping ratio.", variables:[{symbol:"r",name:"Frequency Ratio",description:"Excitation / natural frequency",unit:"dimensionless",defaultValue:null},{symbol:"Œ∂",name:"Damping Ratio",description:"Typically 0.05‚Äì0.15 for isolators",unit:"dimensionless",defaultValue:0.05}], resultVariable:{symbol:"TR",name:"Transmissibility",unit:"dimensionless"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// 14. ENERGY / SUSTAINABILITY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"solar irradiance on tilted surface": { cat:"Energy", standard:"BS EN ISO 9806", standardName:"Solar energy ‚Äî Solar thermal collectors", description:"Solar radiation on a tilted surface from horizontal irradiance.", formula:"I_T = I_h √ó (cos(Œ∏_i) / cos(Œ∏_z))", formulaDescription:"Œ∏_i = angle of incidence on surface; Œ∏_z = solar zenith angle.", variables:[{symbol:"I_h",name:"Horizontal Irradiance",description:"Global horizontal irradiance",unit:"W/m¬≤",defaultValue:null},{symbol:"cos_Œ∏i",name:"cos(angle of incidence)",description:"Cosine of angle of incidence on tilted surface",unit:"dimensionless",defaultValue:null},{symbol:"cos_Œ∏z",name:"cos(zenith angle)",description:"Cosine of solar zenith angle",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"I_T",name:"Irradiance on Tilted Surface",unit:"W/m¬≤"} },

"pv panel power output": { cat:"Energy", standard:"IEC 61853", standardName:"Photovoltaic module performance testing", description:"PV panel power output at given irradiance.", formula:"P = P_stc √ó (G / G_stc) √ó (1 + Œ≥ √ó (T_c - 25))", formulaDescription:"G_stc = 1000 W/m¬≤; Œ≥ = temperature coefficient (~-0.004/¬∞C).", variables:[{symbol:"P_stc",name:"STC Power Rating",description:"Rated power at standard test conditions",unit:"W",defaultValue:null},{symbol:"G",name:"Irradiance",description:"Current solar irradiance",unit:"W/m¬≤",defaultValue:null},{symbol:"G_stc",name:"STC Irradiance",description:"1000 W/m¬≤",unit:"W/m¬≤",defaultValue:1000},{symbol:"Œ≥",name:"Temperature Coefficient",description:"Power temp. coefficient (typically -0.004)",unit:"1/¬∞C",defaultValue:-0.004},{symbol:"T_c",name:"Cell Temperature",description:"PV cell temperature",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"P",name:"Panel Power Output",unit:"W"} },

"wind turbine power": { cat:"Energy", standard:"IEC 61400-1", standardName:"Wind energy generation systems", description:"Theoretical power extractable from wind (Betz limit = 59.3%).", formula:"P = 0.5 √ó Cp √ó œÅ √ó A √ó v¬≥", formulaDescription:"Cp = power coefficient (max 0.593 Betz limit; practical 0.35‚Äì0.45).", variables:[{symbol:"Cp",name:"Power Coefficient",description:"Turbine efficiency (typical 0.35‚Äì0.45)",unit:"dimensionless",defaultValue:0.4},{symbol:"œÅ",name:"Air Density",description:"Air density at site (~1.225 kg/m¬≥)",unit:"kg/m¬≥",defaultValue:1.225},{symbol:"A",name:"Rotor Swept Area",description:"œÄ √ó r¬≤ (r = blade radius)",unit:"m¬≤",defaultValue:null},{symbol:"v",name:"Wind Speed",description:"Wind speed at hub height",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"P",name:"Wind Power Output",unit:"W"} },

"energy intensity": { cat:"Energy", standard:"ISO 50001", standardName:"Energy management systems", description:"Site energy use intensity (EUI).", formula:"EUI = E_annual / A_floor", formulaDescription:"Typical offices: 150‚Äì250 kWh/m¬≤/yr.", variables:[{symbol:"E_annual",name:"Annual Energy Consumption",description:"Total energy used per year",unit:"kWh",defaultValue:null},{symbol:"A_floor",name:"Floor Area",description:"Total conditioned floor area",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"EUI",name:"Energy Use Intensity",unit:"kWh/m¬≤/yr"} },

"u value calculation": { cat:"Energy", standard:"BS EN ISO 6946", standardName:"Building components ‚Äî Thermal resistance", description:"U-value (thermal transmittance) of a building element.", formula:"U = 1 / (R_si + R_1 + R_2 + R_n + R_se)", formulaDescription:"Sum all resistances (R = L/k for each layer); R_si=0.13, R_se=0.04.", variables:[{symbol:"R_si",name:"Internal Surface Resistance",description:"0.13 m¬≤K/W for horizontal heat flow",unit:"m¬≤K/W",defaultValue:0.13},{symbol:"R_layers",name:"Sum of Layer Resistances",description:"Sum of L/k for all material layers",unit:"m¬≤K/W",defaultValue:null},{symbol:"R_se",name:"External Surface Resistance",description:"0.04 m¬≤K/W",unit:"m¬≤K/W",defaultValue:0.04}], resultVariable:{symbol:"U",name:"Thermal Transmittance (U-value)",unit:"W/(m¬≤¬∑K)"} },

"carbon emissions energy": { cat:"Energy", standard:"CIBSE TM65", standardName:"Embodied carbon in building services", description:"Carbon emissions from energy consumption.", formula:"CO2 = E √ó EF", formulaDescription:"EF = emission factor (UK grid electricity ‚âà 0.207 kg CO‚ÇÇ/kWh).", variables:[{symbol:"E",name:"Energy Consumed",description:"Energy consumption",unit:"kWh",defaultValue:null},{symbol:"EF",name:"Emission Factor",description:"UK grid electricity ~0.207 kg/kWh; gas ~0.183 kg/kWh",unit:"kg CO‚ÇÇ/kWh",defaultValue:0.207}], resultVariable:{symbol:"CO2",name:"CO‚ÇÇ Emissions",unit:"kg CO‚ÇÇ"} },

"payback period simple": { cat:"Energy", standard:"ISO 17741", standardName:"General technical rules for measurement of energy savings", description:"Simple payback period for an energy efficiency measure.", formula:"SPB = Capital Cost / Annual Savings", formulaDescription:"Does not account for time value of money.", variables:[{symbol:"Capital_Cost",name:"Capital Cost",description:"Investment cost",unit:"¬£",defaultValue:null},{symbol:"Annual_Savings",name:"Annual Savings",description:"Annual energy/cost savings",unit:"¬£/yr",defaultValue:null}], resultVariable:{symbol:"SPB",name:"Simple Payback Period",unit:"years"} }

}; // end FORMULA_DB

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SEARCH ENGINE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function searchDB(query) {
    if (!query || query.length < 2) return [];
    const q = query.toLowerCase().trim();
    const tokens = q.split(/\s+/).filter(t => t.length > 2);
    const results = [];

    for (const [key, formula] of Object.entries(FORMULA_DB)) {
        let score = 0;
        const searchText = (key + ' ' + formula.standard + ' ' + formula.standardName + ' ' + formula.description + ' ' + formula.formula + ' ' + (formula.cat||'')).toLowerCase();

        // Exact key match
        if (key === q || key.includes(q) || q.includes(key)) score += 100;

        // Token matching
        for (const token of tokens) {
            if (key.includes(token)) score += 20;
            if (formula.cat && formula.cat.toLowerCase().includes(token)) score += 15;
            if (formula.standard.toLowerCase().includes(token)) score += 15;
            if (formula.formula.toLowerCase().includes(token)) score += 10;
            if (formula.description.toLowerCase().includes(token)) score += 8;
            if (formula.standardName.toLowerCase().includes(token)) score += 8;
            // Variable symbol match
            if (formula.variables.some(v => v.symbol.toLowerCase() === token)) score += 12;
        }

        if (score > 0) results.push({ key, formula, score });
    }

    return results.sort((a,b) => b.score - a.score).slice(0, 10);
}

// Category list
// CATEGORIES and FORMULA_COUNT computed after FORMULA_DB_EXTRA is merged (see bottom of script)

// FORMULA_DB_EXTRA ‚Äî appended to FORMULA_DB at runtime
// Adds ~600 formulas across all engineering disciplines

const FORMULA_DB_EXTRA = {

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FLUID MECHANICS ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"froude number": { cat:"Fluid Mechanics", standard:"ISO 80000-11", standardName:"Characteristic numbers", description:"Froude number ‚Äî ratio of inertial to gravitational forces. Fr < 1 = subcritical; Fr > 1 = supercritical.", formula:"Fr = v / ‚àö(g √ó d)", variables:[{symbol:"v",name:"Flow Velocity",description:"Mean flow velocity",unit:"m/s",defaultValue:null},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"d",name:"Hydraulic Depth",description:"Flow depth (open channel)",unit:"m",defaultValue:null}], resultVariable:{symbol:"Fr",name:"Froude Number",unit:"dimensionless"} },

"weber number": { cat:"Fluid Mechanics", standard:"ISO 80000-11", standardName:"Characteristic numbers", description:"Weber number ‚Äî ratio of inertial to surface tension forces.", formula:"We = œÅ √ó v¬≤ √ó L / œÉ", variables:[{symbol:"œÅ",name:"Fluid Density",description:"Density",unit:"kg/m¬≥",defaultValue:null},{symbol:"v",name:"Velocity",description:"Flow velocity",unit:"m/s",defaultValue:null},{symbol:"L",name:"Characteristic Length",description:"Length scale",unit:"m",defaultValue:null},{symbol:"œÉ",name:"Surface Tension",description:"Surface tension of fluid",unit:"N/m",defaultValue:null}], resultVariable:{symbol:"We",name:"Weber Number",unit:"dimensionless"} },

"mach number": { cat:"Fluid Mechanics", standard:"ISO 80000-11", standardName:"Characteristic numbers", description:"Mach number ‚Äî ratio of flow speed to speed of sound.", formula:"Ma = v / a", variables:[{symbol:"v",name:"Flow Velocity",description:"Velocity of flow or object",unit:"m/s",defaultValue:null},{symbol:"a",name:"Speed of Sound",description:"Speed of sound in medium (~343 m/s in air at 20¬∞C)",unit:"m/s",defaultValue:343}], resultVariable:{symbol:"Ma",name:"Mach Number",unit:"dimensionless"} },

"stokes settling velocity": { cat:"Fluid Mechanics", standard:"ISO 13317-3", standardName:"Particle size analysis ‚Äî gravitational sedimentation", description:"Terminal settling velocity of a sphere in a viscous fluid (Stokes' law). Valid Re < 0.3.", formula:"v_s = (d_p¬≤ √ó (œÅ_p - œÅ_f) √ó g) / (18 √ó Œº)", variables:[{symbol:"d_p",name:"Particle Diameter",description:"Particle diameter",unit:"m",defaultValue:null},{symbol:"œÅ_p",name:"Particle Density",description:"Density of particle",unit:"kg/m¬≥",defaultValue:null},{symbol:"œÅ_f",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:1000},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"Œº",name:"Dynamic Viscosity",description:"Fluid dynamic viscosity",unit:"Pa¬∑s",defaultValue:0.001}], resultVariable:{symbol:"v_s",name:"Settling Velocity",unit:"m/s"} },

"hydraulic diameter": { cat:"Fluid Mechanics", standard:"CIBSE Guide C", standardName:"Reference Data", description:"Hydraulic diameter for non-circular ducts/channels.", formula:"D_h = 4 √ó A / P", variables:[{symbol:"A",name:"Flow Area",description:"Cross-sectional flow area",unit:"m¬≤",defaultValue:null},{symbol:"P",name:"Wetted Perimeter",description:"Wetted perimeter of section",unit:"m",defaultValue:null}], resultVariable:{symbol:"D_h",name:"Hydraulic Diameter",unit:"m"} },

"rectangular duct hydraulic diameter": { cat:"Fluid Mechanics", standard:"CIBSE Guide B2", standardName:"Ventilation and Air Conditioning", description:"Hydraulic diameter for a rectangular duct.", formula:"D_h = (2 √ó a √ó b) / (a + b)", variables:[{symbol:"a",name:"Duct Width",description:"Width of rectangular duct",unit:"m",defaultValue:null},{symbol:"b",name:"Duct Height",description:"Height of rectangular duct",unit:"m",defaultValue:null}], resultVariable:{symbol:"D_h",name:"Hydraulic Diameter",unit:"m"} },

"chezy flow velocity": { cat:"Fluid Mechanics", standard:"BS EN 752", standardName:"Drain and sewer systems", description:"Ch√©zy formula for open channel flow velocity.", formula:"v = C √ó ‚àö(R √ó S)", variables:[{symbol:"C",name:"Ch√©zy Coefficient",description:"Typically 30‚Äì90 m^0.5/s",unit:"m^0.5/s",defaultValue:60},{symbol:"R",name:"Hydraulic Radius",description:"A/P = area / wetted perimeter",unit:"m",defaultValue:null},{symbol:"S",name:"Hydraulic Slope",description:"Channel bed gradient",unit:"m/m",defaultValue:null}], resultVariable:{symbol:"v",name:"Flow Velocity",unit:"m/s"} },

"pipe volume": { cat:"Fluid Mechanics", standard:"ISO 4200", standardName:"Plain end steel tubes", description:"Volume of fluid in a cylindrical pipe.", formula:"V = œÄ √ó (D/2)¬≤ √ó L", variables:[{symbol:"D",name:"Internal Diameter",description:"Internal pipe diameter",unit:"m",defaultValue:null},{symbol:"L",name:"Pipe Length",description:"Length of pipe",unit:"m",defaultValue:null}], resultVariable:{symbol:"V",name:"Pipe Volume",unit:"m¬≥"} },

"specific weight fluid": { cat:"Fluid Mechanics", standard:"ISO 80000-4", standardName:"Mechanics", description:"Specific weight (unit weight) of a fluid.", formula:"Œ≥ = œÅ √ó g", variables:[{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:1000},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81}], resultVariable:{symbol:"Œ≥",name:"Specific Weight",unit:"N/m¬≥"} },

"relative density specific gravity": { cat:"Fluid Mechanics", standard:"ISO 758", standardName:"Liquid chemical products ‚Äî Determination of density", description:"Relative density (specific gravity) of a fluid relative to water.", formula:"SG = œÅ_fluid / œÅ_water", variables:[{symbol:"œÅ_fluid",name:"Fluid Density",description:"Density of the fluid",unit:"kg/m¬≥",defaultValue:null},{symbol:"œÅ_water",name:"Water Density",description:"Density of water at 4¬∞C = 1000 kg/m¬≥",unit:"kg/m¬≥",defaultValue:1000}], resultVariable:{symbol:"SG",name:"Specific Gravity",unit:"dimensionless"} },

"surge tank volume": { cat:"Fluid Mechanics", standard:"BS EN 805", standardName:"Water supply", description:"Minimum surge tank volume to limit pressure rise.", formula:"V_tank = Q √ó t_c / 2", variables:[{symbol:"Q",name:"Flow Rate",description:"System flow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"t_c",name:"Closure Time",description:"Valve closure time",unit:"s",defaultValue:null}], resultVariable:{symbol:"V_tank",name:"Minimum Tank Volume",unit:"m¬≥"} },

"expansion vessel volume": { cat:"Fluid Mechanics", standard:"BS EN 12828", standardName:"Heating systems in buildings", description:"Expansion vessel volume for a closed heating system.", formula:"V_exp = V_s √ó (e / (1 - P0/P_max))", variables:[{symbol:"V_s",name:"System Water Volume",description:"Total water volume in system",unit:"L",defaultValue:null},{symbol:"e",name:"Expansion Factor",description:"e = ŒîV/V; water 0-80¬∞C ‚âà 0.0289",unit:"dimensionless",defaultValue:0.0289},{symbol:"P0",name:"Initial Pressure (abs)",description:"Pre-charge pressure absolute",unit:"bar",defaultValue:null},{symbol:"P_max",name:"Maximum Pressure (abs)",description:"System maximum pressure absolute",unit:"bar",defaultValue:null}], resultVariable:{symbol:"V_exp",name:"Expansion Vessel Volume",unit:"L"} },

"bernoulli velocity from pressure": { cat:"Fluid Mechanics", standard:"ISO 5167-1", standardName:"Measurement of fluid flow", description:"Flow velocity from differential pressure (Pitot tube principle).", formula:"v = ‚àö(2 √ó ŒîP / œÅ)", variables:[{symbol:"ŒîP",name:"Differential Pressure",description:"Stagnation minus static pressure",unit:"Pa",defaultValue:null},{symbol:"œÅ",name:"Fluid Density",description:"Density of fluid",unit:"kg/m¬≥",defaultValue:1.2}], resultVariable:{symbol:"v",name:"Flow Velocity",unit:"m/s"} },

"pump specific speed": { cat:"Fluid Mechanics", standard:"BS EN ISO 9906", standardName:"Rotodynamic pumps", description:"Specific speed ‚Äî classifies pump type (centrifugal, mixed-flow, axial).", formula:"N_s = n √ó Q^0.5 / H^0.75", variables:[{symbol:"n",name:"Rotational Speed",description:"Pump speed",unit:"rpm",defaultValue:null},{symbol:"Q",name:"Flow Rate",description:"Volumetric flow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"H",name:"Total Head",description:"Total pump head",unit:"m",defaultValue:null}], resultVariable:{symbol:"N_s",name:"Specific Speed",unit:"rpm¬∑(m¬≥/s)^0.5/m^0.75"} },

"affinity law flow speed": { cat:"Fluid Mechanics", standard:"BS EN ISO 9906", standardName:"Rotodynamic pumps", description:"Pump affinity law ‚Äî flow varies linearly with speed.", formula:"Q2 = Q1 √ó (n2/n1)", variables:[{symbol:"Q1",name:"Original Flow Rate",description:"Flow at original speed",unit:"m¬≥/s",defaultValue:null},{symbol:"n1",name:"Original Speed",description:"Original rotational speed",unit:"rpm",defaultValue:null},{symbol:"n2",name:"New Speed",description:"New rotational speed",unit:"rpm",defaultValue:null}], resultVariable:{symbol:"Q2",name:"New Flow Rate",unit:"m¬≥/s"} },

"affinity law head speed": { cat:"Fluid Mechanics", standard:"BS EN ISO 9906", standardName:"Rotodynamic pumps", description:"Pump affinity law ‚Äî head varies as square of speed.", formula:"H2 = H1 √ó (n2/n1)¬≤", variables:[{symbol:"H1",name:"Original Head",description:"Head at original speed",unit:"m",defaultValue:null},{symbol:"n1",name:"Original Speed",description:"Original rotational speed",unit:"rpm",defaultValue:null},{symbol:"n2",name:"New Speed",description:"New rotational speed",unit:"rpm",defaultValue:null}], resultVariable:{symbol:"H2",name:"New Head",unit:"m"} },

"affinity law power speed": { cat:"Fluid Mechanics", standard:"BS EN ISO 9906", standardName:"Rotodynamic pumps", description:"Pump affinity law ‚Äî power varies as cube of speed (key for VSD savings).", formula:"P2 = P1 √ó (n2/n1)¬≥", variables:[{symbol:"P1",name:"Original Power",description:"Power at original speed",unit:"W",defaultValue:null},{symbol:"n1",name:"Original Speed",description:"Original rotational speed",unit:"rpm",defaultValue:null},{symbol:"n2",name:"New Speed",description:"New rotational speed",unit:"rpm",defaultValue:null}], resultVariable:{symbol:"P2",name:"New Power",unit:"W"} },

"net positive suction head": { cat:"Fluid Mechanics", standard:"BS EN ISO 9906", standardName:"Rotodynamic pumps", description:"Net Positive Suction Head Available (NPSHa) ‚Äî must exceed NPSHr to avoid cavitation.", formula:"NPSHa = (P_atm - P_vap)/(œÅ√óg) + z_s - h_f", variables:[{symbol:"P_atm",name:"Atmospheric Pressure",description:"Absolute pressure at fluid surface",unit:"Pa",defaultValue:101325},{symbol:"P_vap",name:"Vapour Pressure",description:"Saturation pressure of fluid at temperature",unit:"Pa",defaultValue:2337},{symbol:"œÅ",name:"Fluid Density",description:"Density",unit:"kg/m¬≥",defaultValue:1000},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"z_s",name:"Suction Head",description:"Height of fluid surface above pump centreline (negative if below)",unit:"m",defaultValue:null},{symbol:"h_f",name:"Suction Line Losses",description:"Friction losses in suction pipework",unit:"m",defaultValue:null}], resultVariable:{symbol:"NPSHa",name:"NPSHa",unit:"m"} },

"flow through valve cv": { cat:"Fluid Mechanics", standard:"ISA 75.01", standardName:"Flow equations for sizing control valves", description:"Flow through a valve using Cv (imperial) or Kv (metric) coefficient.", formula:"Q = Cv √ó ‚àö(ŒîP / SG)", variables:[{symbol:"Cv",name:"Valve Flow Coefficient",description:"Cv from manufacturer (US gal/min at 1 psi ŒîP)",unit:"US gal/min/psi^0.5",defaultValue:null},{symbol:"ŒîP",name:"Pressure Drop",description:"Pressure drop across valve",unit:"psi",defaultValue:null},{symbol:"SG",name:"Specific Gravity",description:"Relative to water",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"Q",name:"Flow Rate",unit:"US gal/min"} },

"flow kv metric valve": { cat:"Fluid Mechanics", standard:"IEC 60534", standardName:"Industrial-process control valves", description:"Flow through valve using metric Kv coefficient.", formula:"Q = Kv √ó ‚àö(ŒîP / œÅ_rel)", variables:[{symbol:"Kv",name:"Kv Coefficient",description:"From manufacturer (m¬≥/h at 1 bar ŒîP, water)",unit:"m¬≥/h",defaultValue:null},{symbol:"ŒîP",name:"Pressure Drop",description:"Pressure drop across valve",unit:"bar",defaultValue:null},{symbol:"œÅ_rel",name:"Relative Density",description:"Specific gravity relative to water",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"Q",name:"Flow Rate",unit:"m¬≥/h"} },

"colebrook iteration": { cat:"Fluid Mechanics", standard:"ASME B31.3", standardName:"Process Piping", description:"Moody friction factor by direct substitution (first iteration start). Use f = 0.02 as initial guess.", formula:"f = 1 / (-2 √ó log10(Œµ/(3.7√óD) + 2.51/(Re√ó‚àöf)))¬≤", variables:[{symbol:"Œµ",name:"Pipe Roughness",description:"Absolute roughness (steel 0.046 mm, PVC 0.0015 mm)",unit:"m",defaultValue:0.000046},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null},{symbol:"Re",name:"Reynolds Number",description:"Turbulent flow Re > 4000",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"f",name:"Darcy Friction Factor",unit:"dimensionless"} },

"minor loss coefficient": { cat:"Fluid Mechanics", standard:"CIBSE Guide C", standardName:"Reference Data", description:"Head loss from a fitting using K-factor.", formula:"h_L = K √ó v¬≤ / (2 √ó g)", variables:[{symbol:"K",name:"Loss Coefficient K",description:"90¬∞ elbow ~0.9; gate valve fully open ~0.1; globe valve ~6",unit:"dimensionless",defaultValue:null},{symbol:"v",name:"Flow Velocity",description:"Velocity in pipe",unit:"m/s",defaultValue:null},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81}], resultVariable:{symbol:"h_L",name:"Minor Head Loss",unit:"m"} },

"submerged orifice flow": { cat:"Fluid Mechanics", standard:"ISO 5167-2", standardName:"Orifice plates", description:"Flow through a submerged (drowned) orifice.", formula:"Q = Cd √ó A √ó ‚àö(2 √ó g √ó Œîh)", variables:[{symbol:"Cd",name:"Discharge Coefficient",description:"Typically 0.61 for sharp-edged orifice",unit:"dimensionless",defaultValue:0.61},{symbol:"A",name:"Orifice Area",description:"Cross-sectional area of orifice",unit:"m¬≤",defaultValue:null},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"Œîh",name:"Head Difference",description:"Difference in water levels",unit:"m",defaultValue:null}], resultVariable:{symbol:"Q",name:"Flow Rate",unit:"m¬≥/s"} },

"parallel pipe systems flow": { cat:"Fluid Mechanics", standard:"ASME B31.3", standardName:"Process Piping", description:"Total flow in parallel pipe branches (pressure drop equal in each branch).", formula:"Q_total = Q1 + Q2 + Q3", variables:[{symbol:"Q1",name:"Branch 1 Flow",description:"Flow in pipe branch 1",unit:"m¬≥/s",defaultValue:null},{symbol:"Q2",name:"Branch 2 Flow",description:"Flow in pipe branch 2",unit:"m¬≥/s",defaultValue:null},{symbol:"Q3",name:"Branch 3 Flow",description:"Flow in pipe branch 3 (0 if only 2 branches)",unit:"m¬≥/s",defaultValue:0}], resultVariable:{symbol:"Q_total",name:"Total Flow Rate",unit:"m¬≥/s"} },

"viscosity kinematic from dynamic": { cat:"Fluid Mechanics", standard:"ISO 3104", standardName:"Petroleum products ‚Äî Kinematic viscosity", description:"Kinematic viscosity from dynamic viscosity and density.", formula:"ŒΩ = Œº / œÅ", variables:[{symbol:"Œº",name:"Dynamic Viscosity",description:"Dynamic viscosity",unit:"Pa¬∑s",defaultValue:null},{symbol:"œÅ",name:"Fluid Density",description:"Fluid density",unit:"kg/m¬≥",defaultValue:null}], resultVariable:{symbol:"ŒΩ",name:"Kinematic Viscosity",unit:"m¬≤/s"} },

"pipe roughness relative": { cat:"Fluid Mechanics", standard:"ASME B36.10M", standardName:"Welded and Seamless Wrought Steel Pipe", description:"Relative roughness used in Moody diagram.", formula:"Œµ_r = Œµ / D", variables:[{symbol:"Œµ",name:"Absolute Roughness",description:"Material roughness (steel 0.046 mm, concrete 0.3‚Äì3 mm)",unit:"m",defaultValue:0.000046},{symbol:"D",name:"Internal Diameter",description:"Pipe internal diameter",unit:"m",defaultValue:null}], resultVariable:{symbol:"Œµ_r",name:"Relative Roughness",unit:"dimensionless"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HEAT TRANSFER ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"stanton number": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Stanton number ‚Äî ratio of heat transfer to thermal capacity of fluid flow.", formula:"St = Nu / (Re √ó Pr)", variables:[{symbol:"Nu",name:"Nusselt Number",description:"Convective heat transfer",unit:"dimensionless",defaultValue:null},{symbol:"Re",name:"Reynolds Number",description:"Flow Reynolds number",unit:"dimensionless",defaultValue:null},{symbol:"Pr",name:"Prandtl Number",description:"Fluid Prandtl number",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"St",name:"Stanton Number",unit:"dimensionless"} },

"biot number": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Biot number ‚Äî ratio of internal conductive resistance to external convective resistance.", formula:"Bi = h √ó L_c / k", variables:[{symbol:"h",name:"Convective HT Coefficient",description:"External convection coefficient",unit:"W/(m¬≤¬∑K)",defaultValue:null},{symbol:"L_c",name:"Characteristic Length",description:"V/A for solid bodies",unit:"m",defaultValue:null},{symbol:"k",name:"Thermal Conductivity",description:"Conductivity of the solid",unit:"W/(m¬∑K)",defaultValue:null}], resultVariable:{symbol:"Bi",name:"Biot Number",unit:"dimensionless"} },

"fourier number": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Fourier number ‚Äî dimensionless time for transient heat conduction.", formula:"Fo = Œ± √ó t / L_c¬≤", variables:[{symbol:"Œ±",name:"Thermal Diffusivity",description:"Œ± = k/(œÅ cp)",unit:"m¬≤/s",defaultValue:null},{symbol:"t",name:"Time",description:"Elapsed time",unit:"s",defaultValue:null},{symbol:"L_c",name:"Characteristic Length",description:"Half-thickness for slab, radius for cylinder/sphere",unit:"m",defaultValue:null}], resultVariable:{symbol:"Fo",name:"Fourier Number",unit:"dimensionless"} },

"thermal diffusivity": { cat:"Heat Transfer", standard:"ISO 22007-1", standardName:"Plastics ‚Äî Determination of thermal conductivity and diffusivity", description:"Thermal diffusivity of a material.", formula:"Œ± = k / (œÅ √ó cp)", variables:[{symbol:"k",name:"Thermal Conductivity",description:"Material conductivity",unit:"W/(m¬∑K)",defaultValue:null},{symbol:"œÅ",name:"Density",description:"Material density",unit:"kg/m¬≥",defaultValue:null},{symbol:"cp",name:"Specific Heat Capacity",description:"At constant pressure",unit:"J/(kg¬∑K)",defaultValue:null}], resultVariable:{symbol:"Œ±",name:"Thermal Diffusivity",unit:"m¬≤/s"} },

"grashof number": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook", description:"Grashof number ‚Äî drives natural convection, analogous to Re for forced convection.", formula:"Gr = g √ó Œ≤ √ó ŒîT √ó L¬≥ / ŒΩ¬≤", variables:[{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"Œ≤",name:"Thermal Expansion Coefficient",description:"1/T (K‚Åª¬π) for ideal gas",unit:"1/K",defaultValue:null},{symbol:"ŒîT",name:"Temperature Difference",description:"Surface to bulk fluid",unit:"K",defaultValue:null},{symbol:"L",name:"Characteristic Length",description:"Vertical height of surface",unit:"m",defaultValue:null},{symbol:"ŒΩ",name:"Kinematic Viscosity",description:"Fluid kinematic viscosity",unit:"m¬≤/s",defaultValue:null}], resultVariable:{symbol:"Gr",name:"Grashof Number",unit:"dimensionless"} },

"rayleigh number": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook", description:"Rayleigh number ‚Äî governs onset of natural convection (Ra > 10‚Åπ ‚Üí turbulent).", formula:"Ra = Gr √ó Pr", variables:[{symbol:"Gr",name:"Grashof Number",description:"Computed from Gr formula",unit:"dimensionless",defaultValue:null},{symbol:"Pr",name:"Prandtl Number",description:"Fluid Prandtl number",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"Ra",name:"Rayleigh Number",unit:"dimensionless"} },

"heat pipe capacity": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook", description:"Maximum heat transport capacity of a heat pipe.", formula:"Q_max = ·πÅ √ó h_fg", variables:[{symbol:"·πÅ",name:"Fluid Circulation Rate",description:"Working fluid mass flow",unit:"kg/s",defaultValue:null},{symbol:"h_fg",name:"Latent Heat",description:"Latent heat of working fluid",unit:"J/kg",defaultValue:null}], resultVariable:{symbol:"Q_max",name:"Maximum Heat Capacity",unit:"W"} },

"stefan boltzmann blackbody": { cat:"Heat Transfer", standard:"ISO 80000-7", standardName:"Optics and photonics", description:"Total power radiated per unit area from a perfect black body.", formula:"E_b = œÉ √ó T‚Å¥", variables:[{symbol:"œÉ",name:"Stefan-Boltzmann Constant",description:"5.67√ó10‚Åª‚Å∏ W/(m¬≤¬∑K‚Å¥)",unit:"W/(m¬≤¬∑K‚Å¥)",defaultValue:0.0000000567},{symbol:"T",name:"Absolute Temperature",description:"Surface temperature in Kelvin",unit:"K",defaultValue:null}], resultVariable:{symbol:"E_b",name:"Blackbody Emissive Power",unit:"W/m¬≤"} },

"view factor reciprocity": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook", description:"Radiation view factor reciprocity relation.", formula:"A1 √ó F12 = A2 √ó F21", variables:[{symbol:"A1",name:"Area 1",description:"Area of surface 1",unit:"m¬≤",defaultValue:null},{symbol:"F12",name:"View Factor 1‚Üí2",description:"Fraction of radiation from 1 reaching 2",unit:"dimensionless",defaultValue:null},{symbol:"A2",name:"Area 2",description:"Area of surface 2",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"F21",name:"View Factor 2‚Üí1",unit:"dimensionless"} },

"effectiveness ntu method": { cat:"Heat Transfer", standard:"TEMA", standardName:"Tubular Exchanger Manufacturers Association", description:"Heat exchanger effectiveness by NTU method.", formula:"Œµ = 1 - exp(-NTU √ó (1 + C*))", variables:[{symbol:"NTU",name:"Number of Transfer Units",description:"NTU = UA/C_min",unit:"dimensionless",defaultValue:null},{symbol:"C_star",name:"Heat Capacity Ratio",description:"C_min/C_max",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"Œµ",name:"Effectiveness",unit:"dimensionless"} },

"ntu from uae": { cat:"Heat Transfer", standard:"TEMA", standardName:"Tubular Exchanger Manufacturers Association", description:"Number of Transfer Units for a heat exchanger.", formula:"NTU = U √ó A / C_min", variables:[{symbol:"U",name:"Overall HT Coefficient",description:"Overall heat transfer coefficient",unit:"W/(m¬≤¬∑K)",defaultValue:null},{symbol:"A",name:"Heat Transfer Area",description:"Total surface area",unit:"m¬≤",defaultValue:null},{symbol:"C_min",name:"Minimum Heat Capacity Rate",description:"·πÅ√ócp of smaller stream",unit:"W/K",defaultValue:null}], resultVariable:{symbol:"NTU",name:"Number of Transfer Units",unit:"dimensionless"} },

"insulation thickness optimal": { cat:"Heat Transfer", standard:"BS EN ISO 12241", standardName:"Thermal insulation for building equipment and industrial installations", description:"Critical insulation radius for cylindrical pipe ‚Äî below this, more insulation increases heat loss.", formula:"r_cr = k / h", variables:[{symbol:"k",name:"Insulation Conductivity",description:"Thermal conductivity of insulation material",unit:"W/(m¬∑K)",defaultValue:null},{symbol:"h",name:"Convection Coefficient",description:"External convective coefficient",unit:"W/(m¬≤¬∑K)",defaultValue:null}], resultVariable:{symbol:"r_cr",name:"Critical Insulation Radius",unit:"m"} },

"composite wall resistance series": { cat:"Heat Transfer", standard:"ISO 6946", standardName:"Building components ‚Äî Thermal resistance", description:"Total thermal resistance of layers in series.", formula:"R_total = R1 + R2 + R3 + R4", variables:[{symbol:"R1",name:"Layer 1 Resistance",description:"R = L/k for each layer",unit:"m¬≤K/W",defaultValue:null},{symbol:"R2",name:"Layer 2 Resistance",description:"R = L/k",unit:"m¬≤K/W",defaultValue:null},{symbol:"R3",name:"Layer 3 Resistance",description:"R = L/k (set 0 if unused)",unit:"m¬≤K/W",defaultValue:0},{symbol:"R4",name:"Layer 4 Resistance",description:"R = L/k (set 0 if unused)",unit:"m¬≤K/W",defaultValue:0}], resultVariable:{symbol:"R_total",name:"Total Thermal Resistance",unit:"m¬≤K/W"} },

"heat loss pipe insulated": { cat:"Heat Transfer", standard:"BS EN ISO 12241", standardName:"Thermal insulation for building equipment", description:"Heat loss per metre from an insulated pipe.", formula:"q = 2œÄ √ó (T_pipe - T_amb) / (ln(r2/r1)/k_ins + 1/(h_ext √ó r2))", variables:[{symbol:"T_pipe",name:"Pipe Surface Temperature",description:"Temperature of pipe outer surface",unit:"¬∞C",defaultValue:null},{symbol:"T_amb",name:"Ambient Temperature",description:"Surrounding air temperature",unit:"¬∞C",defaultValue:null},{symbol:"r1",name:"Inner Insulation Radius",description:"Pipe outer radius",unit:"m",defaultValue:null},{symbol:"r2",name:"Outer Insulation Radius",description:"Outer radius of insulation",unit:"m",defaultValue:null},{symbol:"k_ins",name:"Insulation Conductivity",description:"Thermal conductivity of insulation",unit:"W/(m¬∑K)",defaultValue:0.04},{symbol:"h_ext",name:"External Convection Coeff",description:"External convective heat transfer coefficient",unit:"W/(m¬≤¬∑K)",defaultValue:10}], resultVariable:{symbol:"q",name:"Heat Loss per Metre",unit:"W/m"} },

"dittus boelter hcoeff pipe": { cat:"Heat Transfer", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Convective heat transfer coefficient inside a turbulent pipe flow (Dittus-Boelter).", formula:"h = Nu √ó k / D = 0.023 √ó Re^0.8 √ó Pr^n √ó k / D", variables:[{symbol:"Re",name:"Reynolds Number",description:"Must be > 10,000",unit:"dimensionless",defaultValue:null},{symbol:"Pr",name:"Prandtl Number",description:"Fluid Prandtl number",unit:"dimensionless",defaultValue:null},{symbol:"n",name:"Exponent",description:"0.4 heating, 0.3 cooling",unit:"dimensionless",defaultValue:0.4},{symbol:"k",name:"Fluid Thermal Conductivity",description:"Fluid conductivity",unit:"W/(m¬∑K)",defaultValue:0.6},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null}], resultVariable:{symbol:"h",name:"Convection Coefficient",unit:"W/(m¬≤¬∑K)"} },

"heat storage tank": { cat:"Heat Transfer", standard:"BS EN 12977-3", standardName:"Thermal solar systems ‚Äî Performance characterisation", description:"Heat stored in a thermal storage tank.", formula:"Q_stored = m √ó cp √ó (T_hot - T_cold)", variables:[{symbol:"m",name:"Mass of Storage Medium",description:"Mass of water or material",unit:"kg",defaultValue:null},{symbol:"cp",name:"Specific Heat Capacity",description:"Water = 4186 J/(kg¬∑K)",unit:"J/(kg¬∑K)",defaultValue:4186},{symbol:"T_hot",name:"Storage Temperature",description:"Temperature of stored fluid",unit:"¬∞C",defaultValue:null},{symbol:"T_cold",name:"Draw-off Temperature",description:"Temperature of cold feed",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"Q_stored",name:"Stored Heat",unit:"J"} },

"carnot efficiency": { cat:"Heat Transfer", standard:"ISO 80000-5", standardName:"Thermodynamics", description:"Maximum thermodynamic efficiency of a heat engine (Carnot cycle).", formula:"Œ∑_Carnot = 1 - T_cold / T_hot", variables:[{symbol:"T_cold",name:"Cold Reservoir Temperature",description:"Absolute temperature of cold reservoir",unit:"K",defaultValue:null},{symbol:"T_hot",name:"Hot Reservoir Temperature",description:"Absolute temperature of hot reservoir",unit:"K",defaultValue:null}], resultVariable:{symbol:"Œ∑_Carnot",name:"Carnot Efficiency",unit:"dimensionless"} },

"entropy change": { cat:"Heat Transfer", standard:"ISO 80000-5", standardName:"Thermodynamics", description:"Entropy change for a reversible heat transfer process.", formula:"ŒîS = Q / T", variables:[{symbol:"Q",name:"Heat Transferred",description:"Heat added to system",unit:"J",defaultValue:null},{symbol:"T",name:"Absolute Temperature",description:"Temperature at which heat transfer occurs",unit:"K",defaultValue:null}], resultVariable:{symbol:"ŒîS",name:"Entropy Change",unit:"J/K"} },

"heat exchanger area required": { cat:"Heat Transfer", standard:"TEMA", standardName:"Tubular Exchanger Manufacturers Association", description:"Heat exchanger surface area required for given duty.", formula:"A = Q / (U √ó LMTD)", variables:[{symbol:"Q",name:"Heat Duty",description:"Required heat transfer rate",unit:"W",defaultValue:null},{symbol:"U",name:"Overall HT Coefficient",description:"Overall heat transfer coefficient",unit:"W/(m¬≤¬∑K)",defaultValue:null},{symbol:"LMTD",name:"Log Mean Temp. Difference",description:"LMTD corrected for flow arrangement",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"A",name:"Required Surface Area",unit:"m¬≤"} },

"temperature correction factor F": { cat:"Heat Transfer", standard:"TEMA", standardName:"Tubular Exchanger Manufacturers Association", description:"LMTD correction factor F for shell-and-tube exchangers.", formula:"Q = U √ó A √ó F √ó LMTD_cf", variables:[{symbol:"U",name:"Overall HT Coefficient",description:"Overall coefficient",unit:"W/(m¬≤¬∑K)",defaultValue:null},{symbol:"A",name:"Heat Transfer Area",description:"Surface area",unit:"m¬≤",defaultValue:null},{symbol:"F",name:"Correction Factor",description:"F from charts based on P and R (typically 0.75‚Äì1.0)",unit:"dimensionless",defaultValue:0.9},{symbol:"LMTD_cf",name:"Counter-flow LMTD",description:"LMTD assuming pure counter-flow",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"Q",name:"Heat Duty",unit:"W"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STRUCTURAL ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"combined stress von mises": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Von Mises equivalent stress for combined loading check.", formula:"œÉ_eq = ‚àö(œÉx¬≤ + œÉy¬≤ - œÉx√óœÉy + 3√óœÑ¬≤)", variables:[{symbol:"œÉx",name:"Stress in x-direction",description:"Normal stress in x",unit:"Pa",defaultValue:null},{symbol:"œÉy",name:"Stress in y-direction",description:"Normal stress in y (0 for uniaxial)",unit:"Pa",defaultValue:0},{symbol:"œÑ",name:"Shear Stress",description:"Applied shear stress",unit:"Pa",defaultValue:null}], resultVariable:{symbol:"œÉ_eq",name:"Von Mises Equivalent Stress",unit:"Pa"} },

"plastic section modulus rectangle": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Plastic section modulus for a solid rectangle.", formula:"Z_p = b √ó d¬≤ / 4", variables:[{symbol:"b",name:"Width",description:"Section width",unit:"m",defaultValue:null},{symbol:"d",name:"Depth",description:"Section depth",unit:"m",defaultValue:null}], resultVariable:{symbol:"Z_p",name:"Plastic Section Modulus",unit:"m¬≥"} },

"shape factor plastic": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Shape factor (ratio of plastic to elastic section modulus).", formula:"f_s = Z_p / Z_e", variables:[{symbol:"Z_p",name:"Plastic Section Modulus",description:"Plastic section modulus",unit:"m¬≥",defaultValue:null},{symbol:"Z_e",name:"Elastic Section Modulus",description:"Elastic section modulus",unit:"m¬≥",defaultValue:null}], resultVariable:{symbol:"f_s",name:"Shape Factor",unit:"dimensionless"} },

"polar moment of inertia solid shaft": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Polar moment of inertia for a solid circular cross-section.", formula:"J = œÄ √ó D‚Å¥ / 32", variables:[{symbol:"D",name:"Shaft Diameter",description:"Diameter of solid shaft",unit:"m",defaultValue:null}], resultVariable:{symbol:"J",name:"Polar Moment of Inertia",unit:"m‚Å¥"} },

"polar moment hollow shaft": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Polar moment of inertia for hollow circular shaft.", formula:"J = œÄ √ó (D_o‚Å¥ - D_i‚Å¥) / 32", variables:[{symbol:"D_o",name:"Outer Diameter",description:"Outside diameter",unit:"m",defaultValue:null},{symbol:"D_i",name:"Inner Diameter",description:"Inside diameter",unit:"m",defaultValue:null}], resultVariable:{symbol:"J",name:"Polar Moment of Inertia",unit:"m‚Å¥"} },

"shear flow": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Shear flow in a thin-walled section.", formula:"q = V √ó Q_stat / I", variables:[{symbol:"V",name:"Shear Force",description:"Applied shear force",unit:"N",defaultValue:null},{symbol:"Q_stat",name:"First Moment of Area",description:"A' √ó »≥ above cut point",unit:"m¬≥",defaultValue:null},{symbol:"I",name:"Second Moment of Area",description:"Moment of inertia of full section",unit:"m‚Å¥",defaultValue:null}], resultVariable:{symbol:"q",name:"Shear Flow",unit:"N/m"} },

"weld throat size": { cat:"Structural", standard:"BS EN 1993-1-8", standardName:"Eurocode 3 ‚Äî Design of joints", description:"Effective throat thickness of a fillet weld.", formula:"a = 0.707 √ó s", variables:[{symbol:"s",name:"Leg Length",description:"Fillet weld leg length",unit:"m",defaultValue:null}], resultVariable:{symbol:"a",name:"Throat Thickness",unit:"m"} },

"weld strength fillet": { cat:"Structural", standard:"BS EN 1993-1-8", standardName:"Eurocode 3 ‚Äî Design of joints", description:"Design strength of a fillet weld per unit length.", formula:"F_w = f_vw √ó a", variables:[{symbol:"f_vw",name:"Weld Shear Strength",description:"Design shear strength of weld = fu/(‚àö3√óŒ≤w√óŒ≥M2)",unit:"Pa",defaultValue:null},{symbol:"a",name:"Throat Thickness",description:"Effective throat thickness",unit:"m",defaultValue:null}], resultVariable:{symbol:"F_w",name:"Weld Strength per Unit Length",unit:"N/m"} },

"bolt shear capacity": { cat:"Structural", standard:"BS EN 1993-1-8", standardName:"Eurocode 3 ‚Äî Design of joints", description:"Shear capacity of a bolt (single shear).", formula:"F_v,Rd = 0.6 √ó f_ub √ó A_s / Œ≥_M2", variables:[{symbol:"f_ub",name:"Ultimate Bolt Tensile Strength",description:"Grade 8.8 = 800 MPa; 10.9 = 1000 MPa",unit:"Pa",defaultValue:800000000},{symbol:"A_s",name:"Tensile Stress Area",description:"Stress area of bolt",unit:"m¬≤",defaultValue:null},{symbol:"Œ≥_M2",name:"Partial Factor",description:"Typically 1.25 per EC3",unit:"dimensionless",defaultValue:1.25}], resultVariable:{symbol:"F_v_Rd",name:"Bolt Shear Capacity",unit:"N"} },

"bolt bearing capacity": { cat:"Structural", standard:"BS EN 1993-1-8", standardName:"Eurocode 3 ‚Äî Design of joints", description:"Bearing capacity of a bolt on a connected plate.", formula:"F_b,Rd = 2.5 √ó Œ±_b √ó f_u √ó d √ó t / Œ≥_M2", variables:[{symbol:"Œ±_b",name:"Alpha Factor",description:"min(e1/3d0, p1/3d0-0.25, fub/fu, 1.0)",unit:"dimensionless",defaultValue:null},{symbol:"f_u",name:"Ultimate Plate Strength",description:"Ultimate tensile strength of plate",unit:"Pa",defaultValue:null},{symbol:"d",name:"Bolt Diameter",description:"Nominal bolt diameter",unit:"m",defaultValue:null},{symbol:"t",name:"Plate Thickness",description:"Thickness of connected part",unit:"m",defaultValue:null},{symbol:"Œ≥_M2",name:"Partial Factor",description:"1.25 per EC3",unit:"dimensionless",defaultValue:1.25}], resultVariable:{symbol:"F_b_Rd",name:"Bearing Capacity",unit:"N"} },

"connection eccentricity moment": { cat:"Structural", standard:"BS EN 1993-1-8", standardName:"Eurocode 3 ‚Äî Design of joints", description:"Additional shear in bolt group due to eccentric loading.", formula:"V_add = M √ó r_max / Œ£r¬≤", variables:[{symbol:"M",name:"Eccentric Moment",description:"Force √ó eccentricity",unit:"N¬∑m",defaultValue:null},{symbol:"r_max",name:"Max Bolt Distance",description:"Distance from group centroid to farthest bolt",unit:"m",defaultValue:null},{symbol:"Œ£r¬≤",name:"Sum of r-squared",description:"Sum of squared distances for all bolts",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"V_add",name:"Additional Bolt Shear",unit:"N"} },

"propped cantilever max moment": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Maximum bending moment in a propped cantilever with UDL.", formula:"M_max = 9 √ó w √ó L¬≤ / 128", variables:[{symbol:"w",name:"UDL",description:"Uniformly distributed load",unit:"N/m",defaultValue:null},{symbol:"L",name:"Span",description:"Total span length",unit:"m",defaultValue:null}], resultVariable:{symbol:"M_max",name:"Maximum Bending Moment",unit:"N¬∑m"} },

"fixed beam max moment udl": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Maximum (fixed-end) moment in a fixed-fixed beam under UDL.", formula:"M_fixed = w √ó L¬≤ / 12", variables:[{symbol:"w",name:"UDL",description:"Uniformly distributed load",unit:"N/m",defaultValue:null},{symbol:"L",name:"Span",description:"Beam span",unit:"m",defaultValue:null}], resultVariable:{symbol:"M_fixed",name:"Fixed End Moment",unit:"N¬∑m"} },

"combined axial bending check": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3 ‚Äî Cross-section check", description:"Unity check for combined axial load and bending (Class 1 or 2 cross-section).", formula:"UC = N_Ed/N_Rd + M_Ed/M_Rd", variables:[{symbol:"N_Ed",name:"Design Axial Force",description:"Applied axial compression",unit:"N",defaultValue:null},{symbol:"N_Rd",name:"Axial Resistance",description:"Cross-section axial resistance",unit:"N",defaultValue:null},{symbol:"M_Ed",name:"Design Bending Moment",description:"Applied bending moment",unit:"N¬∑m",defaultValue:null},{symbol:"M_Rd",name:"Moment Resistance",description:"Cross-section moment resistance",unit:"N¬∑m",defaultValue:null}], resultVariable:{symbol:"UC",name:"Unity Check (‚â§ 1.0)",unit:"dimensionless"} },

"moment of inertia i section": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Second moment of area of an I-section (simplified ‚Äî flanges + web).", formula:"I = 2√ó(b_f√ót_f√ó(d/2)¬≤) + (t_w√ód_w¬≥)/12", variables:[{symbol:"b_f",name:"Flange Width",description:"Width of one flange",unit:"m",defaultValue:null},{symbol:"t_f",name:"Flange Thickness",description:"Thickness of one flange",unit:"m",defaultValue:null},{symbol:"d",name:"Overall Depth",description:"Total section depth",unit:"m",defaultValue:null},{symbol:"t_w",name:"Web Thickness",description:"Web thickness",unit:"m",defaultValue:null},{symbol:"d_w",name:"Clear Web Depth",description:"Clear depth of web between flanges",unit:"m",defaultValue:null}], resultVariable:{symbol:"I",name:"Second Moment of Area",unit:"m‚Å¥"} },

"lateral torsional buckling check": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Lateral-torsional buckling resistance moment.", formula:"M_b,Rd = œá_LT √ó W_y √ó f_y / Œ≥_M1", variables:[{symbol:"œá_LT",name:"LTB Reduction Factor",description:"From EC3 buckling curves based on Œª_LT",unit:"dimensionless",defaultValue:null},{symbol:"W_y",name:"Section Modulus",description:"Plastic (Class 1/2) or elastic (Class 3/4)",unit:"m¬≥",defaultValue:null},{symbol:"f_y",name:"Yield Strength",description:"Material yield strength",unit:"Pa",defaultValue:275000000},{symbol:"Œ≥_M1",name:"Partial Factor",description:"Typically 1.0 per EC3",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"M_b_Rd",name:"LTB Design Moment",unit:"N¬∑m"} },

"plate buckling check": { cat:"Structural", standard:"BS EN 1993-1-5", standardName:"Eurocode 3 ‚Äî Plated structural elements", description:"Plate slenderness for local buckling check.", formula:"Œª_p = (b/t) / (28.4 √ó Œµ √ó ‚àök_œÉ)", variables:[{symbol:"b",name:"Plate Width",description:"Width between longitudinal stiffeners",unit:"m",defaultValue:null},{symbol:"t",name:"Plate Thickness",description:"Plate thickness",unit:"m",defaultValue:null},{symbol:"Œµ",name:"Material Factor",description:"‚àö(235/fy) in MPa",unit:"dimensionless",defaultValue:1.0},{symbol:"k_œÉ",name:"Buckling Factor",description:"4.0 for uniform compression",unit:"dimensionless",defaultValue:4.0}], resultVariable:{symbol:"Œª_p",name:"Plate Slenderness",unit:"dimensionless"} },

"beam reaction simply supported point": { cat:"Structural", standard:"BS EN 1993-1-1", standardName:"Eurocode 3", description:"Support reactions for a simply-supported beam with offset point load.", formula:"R_A = P √ó b / L", variables:[{symbol:"P",name:"Point Load",description:"Applied load",unit:"N",defaultValue:null},{symbol:"b",name:"Distance to Right Support",description:"Distance from load to support B",unit:"m",defaultValue:null},{symbol:"L",name:"Span",description:"Total span",unit:"m",defaultValue:null}], resultVariable:{symbol:"R_A",name:"Left Support Reaction",unit:"N"} },

"slab design moment per metre": { cat:"Structural", standard:"BS EN 1992-1-1", standardName:"Eurocode 2", description:"Design moment per unit width of a simply-supported one-way slab.", formula:"m = (w √ó l¬≤) / 8", variables:[{symbol:"w",name:"Load per Unit Area",description:"Factored load (kN/m¬≤)",unit:"N/m¬≤",defaultValue:null},{symbol:"l",name:"Slab Span",description:"Clear span of slab",unit:"m",defaultValue:null}], resultVariable:{symbol:"m",name:"Design Moment per Metre Width",unit:"N¬∑m/m"} },

"punching shear check": { cat:"Structural", standard:"BS EN 1992-1-1 Cl.6.4", standardName:"Eurocode 2", description:"Punching shear stress around column-slab junction.", formula:"v_Ed = V_Ed / (u1 √ó d)", variables:[{symbol:"V_Ed",name:"Design Punching Force",description:"Column load minus upward pressure within perimeter",unit:"N",defaultValue:null},{symbol:"u1",name:"Control Perimeter",description:"Basic control perimeter at 2d from column face",unit:"m",defaultValue:null},{symbol:"d",name:"Effective Depth",description:"Average effective depth of slab reinforcement",unit:"m",defaultValue:null}], resultVariable:{symbol:"v_Ed",name:"Punching Shear Stress",unit:"Pa"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PRESSURE VESSELS ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"vessel ellipsoidal head thickness": { cat:"Pressure Vessels", standard:"ASME VIII Div.1 UG-32", standardName:"ASME Boiler and Pressure Vessel Code", description:"Required thickness of a 2:1 semi-ellipsoidal head.", formula:"t = (P √ó D) / (2 √ó S √ó E - 0.2 √ó P)", variables:[{symbol:"P",name:"Design Pressure",description:"Internal design pressure",unit:"Pa",defaultValue:null},{symbol:"D",name:"Inside Diameter",description:"Inside diameter of head",unit:"m",defaultValue:null},{symbol:"S",name:"Allowable Stress",description:"Material allowable stress at temperature",unit:"Pa",defaultValue:null},{symbol:"E",name:"Joint Efficiency",description:"Weld joint efficiency",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"t",name:"Head Thickness",unit:"m"} },

"vessel conical head thickness": { cat:"Pressure Vessels", standard:"ASME VIII Div.1 UG-32", standardName:"ASME Boiler and Pressure Vessel Code", description:"Required thickness of a conical head or section.", formula:"t = (P √ó D) / (2 √ó cos(Œ±) √ó (S √ó E - 0.6 √ó P))", variables:[{symbol:"P",name:"Design Pressure",description:"Internal design pressure",unit:"Pa",defaultValue:null},{symbol:"D",name:"Inside Diameter at Cone",description:"Inside diameter at junction",unit:"m",defaultValue:null},{symbol:"Œ±",name:"Half Apex Angle",description:"Half-apex angle of cone (radians)",unit:"rad",defaultValue:null},{symbol:"S",name:"Allowable Stress",description:"Material allowable stress",unit:"Pa",defaultValue:null},{symbol:"E",name:"Joint Efficiency",description:"Weld joint efficiency",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"t",name:"Cone Thickness",unit:"m"} },

"vessel hydrostatic test pressure": { cat:"Pressure Vessels", standard:"ASME VIII Div.1 UG-99", standardName:"ASME Boiler and Pressure Vessel Code", description:"Required hydrostatic test pressure.", formula:"P_test = 1.3 √ó MAWP √ó (S_test / S_design)", variables:[{symbol:"MAWP",name:"Max Allowable Working Pressure",description:"Design MAWP",unit:"Pa",defaultValue:null},{symbol:"S_test",name:"Stress at Test Temp.",description:"Material allowable at test temperature",unit:"Pa",defaultValue:null},{symbol:"S_design",name:"Stress at Design Temp.",description:"Material allowable at design temperature",unit:"Pa",defaultValue:null}], resultVariable:{symbol:"P_test",name:"Test Pressure",unit:"Pa"} },

"vessel wind load": { cat:"Pressure Vessels", standard:"ASME VIII Div.1 / ASCE 7", standardName:"Minimum Design Loads for Buildings", description:"Wind overturning moment on a vertical vessel.", formula:"M_wind = q √ó Cd √ó A_proj √ó H/2", variables:[{symbol:"q",name:"Dynamic Wind Pressure",description:"Design wind pressure",unit:"Pa",defaultValue:null},{symbol:"Cd",name:"Drag Coefficient",description:"~0.7 for cylindrical vessels",unit:"dimensionless",defaultValue:0.7},{symbol:"A_proj",name:"Projected Area",description:"Diameter √ó height",unit:"m¬≤",defaultValue:null},{symbol:"H",name:"Vessel Height",description:"Height of vessel",unit:"m",defaultValue:null}], resultVariable:{symbol:"M_wind",name:"Wind Overturning Moment",unit:"N¬∑m"} },

"vessel leg support reaction": { cat:"Pressure Vessels", standard:"ASME VIII Div.1", standardName:"ASME Boiler and Pressure Vessel Code", description:"Load per leg for a vertical vessel on leg supports.", formula:"F_leg = (W_total + W_liquid) / n_legs", variables:[{symbol:"W_total",name:"Vessel + Attachments Weight",description:"Empty vessel weight + attachments",unit:"N",defaultValue:null},{symbol:"W_liquid",name:"Liquid Weight",description:"Weight of contained fluid",unit:"N",defaultValue:null},{symbol:"n_legs",name:"Number of Legs",description:"Number of support legs",unit:"dimensionless",defaultValue:4}], resultVariable:{symbol:"F_leg",name:"Load per Leg",unit:"N"} },

"pipe expansion loop length": { cat:"Pressure Vessels", standard:"BS EN 13480-3", standardName:"Metallic industrial piping", description:"Minimum leg length for a U-bend expansion loop.", formula:"L_loop = ‚àö(3 √ó E √ó D_o √ó ŒîL / œÉ_allow)", variables:[{symbol:"E",name:"Modulus of Elasticity",description:"Young's modulus of pipe material",unit:"Pa",defaultValue:200000000000},{symbol:"D_o",name:"Pipe Outer Diameter",description:"Outside diameter of pipe",unit:"m",defaultValue:null},{symbol:"ŒîL",name:"Thermal Expansion",description:"Expected thermal expansion",unit:"m",defaultValue:null},{symbol:"œÉ_allow",name:"Allowable Stress",description:"Allowable bending stress",unit:"Pa",defaultValue:null}], resultVariable:{symbol:"L_loop",name:"Loop Leg Length",unit:"m"} },

"pressure vessel weight": { cat:"Pressure Vessels", standard:"ASME VIII Div.1", standardName:"ASME Boiler and Pressure Vessel Code", description:"Approximate weight of cylindrical vessel shell.", formula:"W = œÄ √ó D_m √ó t √ó L √ó œÅ_steel", variables:[{symbol:"D_m",name:"Mean Diameter",description:"Mean shell diameter",unit:"m",defaultValue:null},{symbol:"t",name:"Shell Thickness",description:"Wall thickness",unit:"m",defaultValue:null},{symbol:"L",name:"Shell Length",description:"Length of shell",unit:"m",defaultValue:null},{symbol:"œÅ_steel",name:"Steel Density",description:"Steel ~7850 kg/m¬≥",unit:"kg/m¬≥",defaultValue:7850}], resultVariable:{symbol:"W",name:"Shell Weight",unit:"kg"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ELECTRICAL ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"capacitor energy stored": { cat:"Electrical", standard:"IEC 60068", standardName:"Environmental testing", description:"Energy stored in a capacitor.", formula:"E = 0.5 √ó C √ó V¬≤", variables:[{symbol:"C",name:"Capacitance",description:"Capacitance value",unit:"F",defaultValue:null},{symbol:"V",name:"Voltage",description:"Voltage across capacitor",unit:"V",defaultValue:null}], resultVariable:{symbol:"E",name:"Stored Energy",unit:"J"} },

"inductor energy stored": { cat:"Electrical", standard:"IEC 60076", standardName:"Power transformers", description:"Energy stored in an inductor.", formula:"E = 0.5 √ó L √ó I¬≤", variables:[{symbol:"L",name:"Inductance",description:"Inductor inductance",unit:"H",defaultValue:null},{symbol:"I",name:"Current",description:"Current through inductor",unit:"A",defaultValue:null}], resultVariable:{symbol:"E",name:"Stored Energy",unit:"J"} },

"capacitive reactance": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Reactance of a capacitor at a given frequency.", formula:"X_C = 1 / (2 √ó œÄ √ó f √ó C)", variables:[{symbol:"f",name:"Frequency",description:"Supply frequency",unit:"Hz",defaultValue:50},{symbol:"C",name:"Capacitance",description:"Capacitor value",unit:"F",defaultValue:null}], resultVariable:{symbol:"X_C",name:"Capacitive Reactance",unit:"Œ©"} },

"inductive reactance": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Reactance of an inductor at a given frequency.", formula:"X_L = 2 √ó œÄ √ó f √ó L", variables:[{symbol:"f",name:"Frequency",description:"Supply frequency",unit:"Hz",defaultValue:50},{symbol:"L",name:"Inductance",description:"Inductor value",unit:"H",defaultValue:null}], resultVariable:{symbol:"X_L",name:"Inductive Reactance",unit:"Œ©"} },

"impedance series rlc": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Total impedance of a series RLC circuit.", formula:"Z = ‚àö(R¬≤ + (X_L - X_C)¬≤)", variables:[{symbol:"R",name:"Resistance",description:"Circuit resistance",unit:"Œ©",defaultValue:null},{symbol:"X_L",name:"Inductive Reactance",description:"Inductive reactance",unit:"Œ©",defaultValue:null},{symbol:"X_C",name:"Capacitive Reactance",description:"Capacitive reactance",unit:"Œ©",defaultValue:null}], resultVariable:{symbol:"Z",name:"Impedance",unit:"Œ©"} },

"resonant frequency rlc": { cat:"Electrical", standard:"IEC 60364", standardName:"Low-voltage electrical installations", description:"Resonant frequency of a series or parallel RLC circuit.", formula:"f_r = 1 / (2 √ó œÄ √ó ‚àö(L √ó C))", variables:[{symbol:"L",name:"Inductance",description:"Circuit inductance",unit:"H",defaultValue:null},{symbol:"C",name:"Capacitance",description:"Circuit capacitance",unit:"F",defaultValue:null}], resultVariable:{symbol:"f_r",name:"Resonant Frequency",unit:"Hz"} },

"fault level mva": { cat:"Electrical", standard:"IEC 60909", standardName:"Short-circuit currents in three-phase AC systems", description:"Symmetrical three-phase fault level at a bus.", formula:"S_sc = V_n¬≤ / Z_sc", variables:[{symbol:"V_n",name:"Nominal Voltage",description:"System nominal voltage (line-to-line)",unit:"V",defaultValue:null},{symbol:"Z_sc",name:"Thevenin Impedance",description:"Thevenin impedance at fault point",unit:"Œ©",defaultValue:null}], resultVariable:{symbol:"S_sc",name:"Fault Level",unit:"VA"} },

"short circuit current 3phase": { cat:"Electrical", standard:"IEC 60909", standardName:"Short-circuit currents in three-phase AC systems", description:"Symmetrical three-phase short-circuit current.", formula:"I_sc = V_n / (‚àö3 √ó Z_total)", variables:[{symbol:"V_n",name:"Nominal Voltage",description:"Line-to-line voltage",unit:"V",defaultValue:null},{symbol:"Z_total",name:"Total Fault Impedance",description:"Source + transformer + cable impedance",unit:"Œ©",defaultValue:null}], resultVariable:{symbol:"I_sc",name:"Short-circuit Current",unit:"A"} },

"transformer losses load": { cat:"Electrical", standard:"IEC 60076-1", standardName:"Power transformers ‚Äî General", description:"Load losses of a transformer at given load.", formula:"P_load = P_k √ó (I/I_r)¬≤", variables:[{symbol:"P_k",name:"Short-circuit Losses",description:"Rated load losses from nameplate",unit:"W",defaultValue:null},{symbol:"I",name:"Actual Load Current",description:"Actual operating current",unit:"A",defaultValue:null},{symbol:"I_r",name:"Rated Current",description:"Transformer rated current",unit:"A",defaultValue:null}], resultVariable:{symbol:"P_load",name:"Load Losses",unit:"W"} },

"cable resistance ac": { cat:"Electrical", standard:"BS 7671 / IEC 60228", standardName:"Conductors of insulated cables", description:"AC resistance of a cable at operating temperature.", formula:"R_ac = R_dc √ó (1 + Œ± √ó (T - 20))", variables:[{symbol:"R_dc",name:"DC Resistance at 20¬∞C",description:"From cable data sheet",unit:"Œ©/km",defaultValue:null},{symbol:"Œ±",name:"Temperature Coefficient",description:"Copper = 0.00393 /¬∞C; Aluminium = 0.00403 /¬∞C",unit:"1/¬∞C",defaultValue:0.00393},{symbol:"T",name:"Operating Temperature",description:"Cable operating temperature",unit:"¬∞C",defaultValue:70}], resultVariable:{symbol:"R_ac",name:"AC Resistance",unit:"Œ©/km"} },

"lighting lux level": { cat:"Electrical", standard:"CIBSE SLL Lighting Guide / EN 12464-1", standardName:"Light and lighting ‚Äî Workplace lighting", description:"Average illuminance on a horizontal workplane.", formula:"E = (N √ó F √ó MF √ó UF) / A", variables:[{symbol:"N",name:"Number of Luminaires",description:"Total number of fittings",unit:"dimensionless",defaultValue:null},{symbol:"F",name:"Luminous Flux per Fitting",description:"Lumens per luminaire",unit:"lm",defaultValue:null},{symbol:"MF",name:"Maintenance Factor",description:"Typically 0.67‚Äì0.80",unit:"dimensionless",defaultValue:0.75},{symbol:"UF",name:"Utilisation Factor",description:"From manufacturer's data",unit:"dimensionless",defaultValue:0.5},{symbol:"A",name:"Room Area",description:"Floor area of room",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"E",name:"Average Illuminance",unit:"lux"} },

"number of luminaires": { cat:"Electrical", standard:"CIBSE SLL / EN 12464-1", standardName:"Light and lighting ‚Äî Workplace lighting", description:"Number of luminaires required to achieve target illuminance.", formula:"N = (E √ó A) / (F √ó MF √ó UF)", variables:[{symbol:"E",name:"Target Illuminance",description:"Required lux level",unit:"lux",defaultValue:500},{symbol:"A",name:"Room Area",description:"Floor area",unit:"m¬≤",defaultValue:null},{symbol:"F",name:"Lumens per Fitting",description:"Luminous flux per luminaire",unit:"lm",defaultValue:null},{symbol:"MF",name:"Maintenance Factor",description:"Typically 0.67‚Äì0.80",unit:"dimensionless",defaultValue:0.75},{symbol:"UF",name:"Utilisation Factor",description:"From photometric data",unit:"dimensionless",defaultValue:0.5}], resultVariable:{symbol:"N",name:"Number of Luminaires",unit:"dimensionless"} },

"motor starting torque": { cat:"Electrical", standard:"IEC 60034-1", standardName:"Rotating electrical machines ‚Äî Rating and performance", description:"Starting (locked rotor) torque of an induction motor.", formula:"T_start = P_rated √ó 9550 / n_rated √ó T_ratio", variables:[{symbol:"P_rated",name:"Rated Power",description:"Motor rated power",unit:"kW",defaultValue:null},{symbol:"n_rated",name:"Rated Speed",description:"Motor rated speed",unit:"rpm",defaultValue:null},{symbol:"T_ratio",name:"Starting Torque Ratio",description:"T_start/T_rated (typically 1.5‚Äì3.0)",unit:"dimensionless",defaultValue:2.0}], resultVariable:{symbol:"T_start",name:"Starting Torque",unit:"N¬∑m"} },

"motor slip": { cat:"Electrical", standard:"IEC 60034-1", standardName:"Rotating electrical machines", description:"Slip of an induction motor.", formula:"s = (n_s - n) / n_s", variables:[{symbol:"n_s",name:"Synchronous Speed",description:"ns = 120f/P (f=freq, P=poles)",unit:"rpm",defaultValue:null},{symbol:"n",name:"Rotor Speed",description:"Actual shaft speed",unit:"rpm",defaultValue:null}], resultVariable:{symbol:"s",name:"Slip",unit:"dimensionless"} },

"synchronous speed motor": { cat:"Electrical", standard:"IEC 60034-1", standardName:"Rotating electrical machines", description:"Synchronous speed of an induction motor.", formula:"n_s = 120 √ó f / P", variables:[{symbol:"f",name:"Supply Frequency",description:"Mains frequency (50 Hz in UK)",unit:"Hz",defaultValue:50},{symbol:"P",name:"Number of Poles",description:"Total pole count (2, 4, 6, 8‚Ä¶)",unit:"poles",defaultValue:4}], resultVariable:{symbol:"n_s",name:"Synchronous Speed",unit:"rpm"} },

"protective conductor size": { cat:"Electrical", standard:"BS 7671 Appx C / IEC 60364-5-54", standardName:"Requirements for Electrical Installations", description:"Minimum protective conductor cross-section by adiabatic equation.", formula:"S = ‚àö(I¬≤ √ó t) / k", variables:[{symbol:"I",name:"Fault Current",description:"Prospective fault current",unit:"A",defaultValue:null},{symbol:"t",name:"Disconnection Time",description:"Protective device operating time",unit:"s",defaultValue:null},{symbol:"k",name:"Material Factor k",description:"Copper/PVC = 115; Copper/XLPE = 143",unit:"A¬∑s^0.5/mm¬≤",defaultValue:115}], resultVariable:{symbol:"S",name:"Min Conductor Area",unit:"mm¬≤"} },

"earth electrode resistance hemisphere": { cat:"Electrical", standard:"BS EN 62305-3", standardName:"Protection against lightning", description:"Resistance of a hemispherical earth electrode.", formula:"R = œÅ / (2 √ó œÄ √ó r)", variables:[{symbol:"œÅ",name:"Soil Resistivity",description:"Soil resistivity (typical 50‚Äì500 Œ©¬∑m)",unit:"Œ©¬∑m",defaultValue:100},{symbol:"r",name:"Electrode Radius",description:"Effective radius of electrode",unit:"m",defaultValue:null}], resultVariable:{symbol:"R",name:"Earth Resistance",unit:"Œ©"} },

"power cable derating high temp": { cat:"Electrical", standard:"IEC 60287-1-1", standardName:"Electric cables ‚Äî Calculation of current rating", description:"Cable current rating derating factor for high ambient temperatures.", formula:"C_a = ‚àö((T_max - T_amb) / (T_max - 30))", variables:[{symbol:"T_max",name:"Max Conductor Temperature",description:"XLPE = 90¬∞C; PVC = 70¬∞C",unit:"¬∞C",defaultValue:70},{symbol:"T_amb",name:"Actual Ambient Temperature",description:"Site ambient temperature",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"C_a",name:"Temperature Derating Factor",unit:"dimensionless"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HVAC ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"hvac room air changes": { cat:"HVAC", standard:"CIBSE Guide A", standardName:"Environmental Design", description:"Number of air changes per hour in a room.", formula:"ACH = Q / V_room", variables:[{symbol:"Q",name:"Supply Air Flow Rate",description:"Volume flow of supply air",unit:"m¬≥/h",defaultValue:null},{symbol:"V_room",name:"Room Volume",description:"Volume of room",unit:"m¬≥",defaultValue:null}], resultVariable:{symbol:"ACH",name:"Air Changes per Hour",unit:"ACH"} },

"hvac supply air flow rate": { cat:"HVAC", standard:"CIBSE Guide A / ASHRAE 62.1", standardName:"Environmental Design", description:"Supply air flow required to offset a sensible cooling load.", formula:"Q_sa = Q_sensible / (œÅ √ó cp √ó (T_room - T_supply))", variables:[{symbol:"Q_sensible",name:"Sensible Cooling Load",description:"Room sensible heat gain",unit:"W",defaultValue:null},{symbol:"œÅ",name:"Air Density",description:"~1.2 kg/m¬≥ at standard conditions",unit:"kg/m¬≥",defaultValue:1.2},{symbol:"cp",name:"Specific Heat of Air",description:"~1005 J/(kg¬∑K)",unit:"J/(kg¬∑K)",defaultValue:1005},{symbol:"T_room",name:"Room Temperature",description:"Design room temperature",unit:"¬∞C",defaultValue:22},{symbol:"T_supply",name:"Supply Air Temperature",description:"Design supply air temperature",unit:"¬∞C",defaultValue:13}], resultVariable:{symbol:"Q_sa",name:"Supply Air Flow Rate",unit:"m¬≥/s"} },

"refrigerant mass flow": { cat:"HVAC", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Refrigerant mass flow for a given cooling capacity.", formula:"·πÅ_r = Q_evap / (h1 - h4)", variables:[{symbol:"Q_evap",name:"Evaporator Capacity",description:"Cooling capacity",unit:"W",defaultValue:null},{symbol:"h1",name:"Evaporator Outlet Enthalpy",description:"Enthalpy of refrigerant leaving evaporator",unit:"J/kg",defaultValue:null},{symbol:"h4",name:"Evaporator Inlet Enthalpy",description:"Enthalpy of refrigerant entering evaporator",unit:"J/kg",defaultValue:null}], resultVariable:{symbol:"·πÅ_r",name:"Refrigerant Mass Flow",unit:"kg/s"} },

"psychrometric dew point": { cat:"HVAC", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Approximate dew point temperature from dry-bulb and relative humidity.", formula:"T_dp = T_db - ((100 - RH) / 5)", variables:[{symbol:"T_db",name:"Dry-Bulb Temperature",description:"Air dry-bulb temperature",unit:"¬∞C",defaultValue:null},{symbol:"RH",name:"Relative Humidity",description:"Relative humidity as percentage",unit:"%",defaultValue:null}], resultVariable:{symbol:"T_dp",name:"Approximate Dew Point",unit:"¬∞C"} },

"psychrometric wet bulb": { cat:"HVAC", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Approximate wet-bulb temperature (Sprung's formula).", formula:"T_wb ‚âà T_db √ó atan(0.151977 √ó (RH+8.313659)^0.5) + atan(T_db+RH) - atan(RH-1.676331) + 0.00391838 √ó RH^1.5 √ó atan(0.023101√óRH) - 4.686035", variables:[{symbol:"T_db",name:"Dry-Bulb Temperature",description:"Air dry-bulb temperature",unit:"¬∞C",defaultValue:null},{symbol:"RH",name:"Relative Humidity",description:"Relative humidity as percentage",unit:"%",defaultValue:null}], resultVariable:{symbol:"T_wb",name:"Wet-Bulb Temperature (approx)",unit:"¬∞C"} },

"moisture content humid air": { cat:"HVAC", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Humidity ratio (moisture content) of moist air.", formula:"W = 0.622 √ó P_v / (P_total - P_v)", variables:[{symbol:"P_v",name:"Vapour Pressure",description:"Partial pressure of water vapour",unit:"Pa",defaultValue:null},{symbol:"P_total",name:"Total Pressure",description:"Atmospheric pressure (101325 Pa at sea level)",unit:"Pa",defaultValue:101325}], resultVariable:{symbol:"W",name:"Humidity Ratio",unit:"kg/kg dry air"} },

"specific enthalpy moist air": { cat:"HVAC", standard:"ASHRAE Fundamentals", standardName:"ASHRAE Handbook of Fundamentals", description:"Specific enthalpy of moist air per kg dry air.", formula:"h = 1006 √ó T_db + W √ó (2501000 + 1860 √ó T_db)", variables:[{symbol:"T_db",name:"Dry-Bulb Temperature",description:"Temperature of moist air",unit:"¬∞C",defaultValue:null},{symbol:"W",name:"Humidity Ratio",description:"kg water per kg dry air",unit:"kg/kg",defaultValue:null}], resultVariable:{symbol:"h",name:"Specific Enthalpy",unit:"J/kg dry air"} },

"hvac duct equivalent diameter": { cat:"HVAC", standard:"CIBSE Guide B2", standardName:"Ventilation and Air Conditioning", description:"Circular equivalent diameter of a rectangular duct for pressure loss calculations.", formula:"D_e = 1.3 √ó (a √ó b)^0.625 / (a + b)^0.25", variables:[{symbol:"a",name:"Duct Width",description:"Width of rectangular duct",unit:"m",defaultValue:null},{symbol:"b",name:"Duct Height",description:"Height of rectangular duct",unit:"m",defaultValue:null}], resultVariable:{symbol:"D_e",name:"Equivalent Diameter",unit:"m"} },

"boiler heat output": { cat:"HVAC", standard:"BS EN 12828", standardName:"Heating systems in buildings", description:"Heat output from a hot water boiler to the heating system.", formula:"Q = ·πÅ √ó cp √ó (T_flow - T_return)", variables:[{symbol:"·πÅ",name:"Water Mass Flow Rate",description:"Circulating water flow rate",unit:"kg/s",defaultValue:null},{symbol:"cp",name:"Specific Heat Capacity",description:"Water = 4186 J/(kg¬∑K)",unit:"J/(kg¬∑K)",defaultValue:4186},{symbol:"T_flow",name:"Flow Temperature",description:"Boiler flow temperature",unit:"¬∞C",defaultValue:80},{symbol:"T_return",name:"Return Temperature",description:"System return temperature",unit:"¬∞C",defaultValue:60}], resultVariable:{symbol:"Q",name:"Heat Output",unit:"W"} },

"fan pressure rise": { cat:"Fluid Mechanics", standard:"BS EN ISO 5801", standardName:"Fans ‚Äî Performance testing using standardised airways", description:"Total pressure rise developed by a fan.", formula:"ŒîP_total = ŒîP_static + œÅ √ó v¬≤/2", variables:[{symbol:"ŒîP_static",name:"Static Pressure Rise",description:"Static pressure developed by fan",unit:"Pa",defaultValue:null},{symbol:"œÅ",name:"Air Density",description:"Air density at fan conditions",unit:"kg/m¬≥",defaultValue:1.2},{symbol:"v",name:"Outlet Velocity",description:"Mean velocity at fan outlet",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"ŒîP_total",name:"Total Pressure Rise",unit:"Pa"} },

"fan power input": { cat:"Fluid Mechanics", standard:"BS EN ISO 5801", standardName:"Fans ‚Äî Performance testing", description:"Fan shaft power input.", formula:"P_fan = Q √ó ŒîP / Œ∑_fan", variables:[{symbol:"Q",name:"Volume Flow Rate",description:"Air volume flow",unit:"m¬≥/s",defaultValue:null},{symbol:"ŒîP",name:"Total Pressure Rise",description:"Fan total pressure",unit:"Pa",defaultValue:null},{symbol:"Œ∑_fan",name:"Fan Efficiency",description:"Overall fan efficiency (0.5‚Äì0.85)",unit:"dimensionless",defaultValue:0.7}], resultVariable:{symbol:"P_fan",name:"Fan Shaft Power",unit:"W"} },

"hvac pipe sizing index circuit": { cat:"HVAC", standard:"CIBSE Guide B1", standardName:"Heating", description:"Index pipe sizing ‚Äî pipe diameter from velocity.", formula:"D = ‚àö(4 √ó Q / (œÄ √ó v))", variables:[{symbol:"Q",name:"Water Flow Rate",description:"Design water flow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"v",name:"Design Velocity",description:"Target velocity (typically 1‚Äì1.5 m/s for LPHW)",unit:"m/s",defaultValue:1.2}], resultVariable:{symbol:"D",name:"Required Internal Diameter",unit:"m"} },

"heat emitter output": { cat:"HVAC", standard:"BS EN 442", standardName:"Radiators and convectors", description:"Heat output from a radiator/convector using mean water temperature.", formula:"Q = K √ó n √ó (LMTD)^n", variables:[{symbol:"K",name:"Radiator Constant",description:"From manufacturer at standard Œît",unit:"W/K^n",defaultValue:null},{symbol:"n",name:"Radiator Exponent",description:"Typically 1.3 for panel radiators",unit:"dimensionless",defaultValue:1.3},{symbol:"LMTD",name:"Log Mean Temperature Difference",description:"(T_flow-T_return)/ln((T_flow-T_room)/(T_return-T_room))",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"Q",name:"Radiator Heat Output",unit:"W"} },

"cooling degree days": { cat:"Energy", standard:"CIBSE Guide A", standardName:"Environmental Design", description:"Annual cooling degree days ‚Äî estimate of cooling energy demand.", formula:"CDD = Œ£ max(T_daily_mean - T_base, 0)", variables:[{symbol:"T_daily_mean",name:"Daily Mean Temperature",description:"Average of max and min temperature for the day",unit:"¬∞C",defaultValue:null},{symbol:"T_base",name:"Base Temperature",description:"Base temperature (typically 22¬∞C)",unit:"¬∞C",defaultValue:22}], resultVariable:{symbol:"CDD",name:"Cooling Degree Days",unit:"¬∞C¬∑days"} },

"heating degree days": { cat:"Energy", standard:"CIBSE Guide A", standardName:"Environmental Design", description:"Annual heating degree days ‚Äî estimate of heating energy demand.", formula:"HDD = Œ£ max(T_base - T_daily_mean, 0)", variables:[{symbol:"T_base",name:"Base Temperature",description:"Typically 15.5¬∞C in UK",unit:"¬∞C",defaultValue:15.5},{symbol:"T_daily_mean",name:"Daily Mean Temperature",description:"Average of daily max and min",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"HDD",name:"Heating Degree Days",unit:"¬∞C¬∑days"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// GEOTECHNICAL / CIVIL ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"soil hydraulic conductivity darcy": { cat:"Geotechnical", standard:"BS EN ISO 17892-11", standardName:"Geotechnical investigation ‚Äî Permeability by constant head", description:"Darcy's law for seepage velocity through soil.", formula:"v = k √ó i", variables:[{symbol:"k",name:"Hydraulic Conductivity",description:"Permeability of soil (sand ~10‚Åª¬≥, clay ~10‚Åª‚Å∏ m/s)",unit:"m/s",defaultValue:null},{symbol:"i",name:"Hydraulic Gradient",description:"Head loss / flow path length",unit:"m/m",defaultValue:null}], resultVariable:{symbol:"v",name:"Seepage Velocity",unit:"m/s"} },

"dewatering flow dupuit": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Flow into a circular excavation (unconfined Dupuit-Forchheimer).", formula:"Q = œÄ √ó k √ó (H¬≤ - h_w¬≤) / ln(R/r)", variables:[{symbol:"k",name:"Hydraulic Conductivity",description:"Soil permeability",unit:"m/s",defaultValue:null},{symbol:"H",name:"Aquifer Height",description:"Saturated aquifer thickness",unit:"m",defaultValue:null},{symbol:"h_w",name:"Water Level in Well",description:"Depth of water in dewatered area",unit:"m",defaultValue:null},{symbol:"R",name:"Radius of Influence",description:"R ‚âà 3000√ós√ó‚àök (Sichardt)",unit:"m",defaultValue:null},{symbol:"r",name:"Excavation Radius",description:"Radius of excavation or well",unit:"m",defaultValue:null}], resultVariable:{symbol:"Q",name:"Inflow Rate",unit:"m¬≥/s"} },

"slope stability factor": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Factor of safety against slip circle failure (simplified Bishop).", formula:"FoS = (c' √ó L + (W √ó cos Œ± - u √ó L) √ó tan œÜ') / (W √ó sin Œ±)", variables:[{symbol:"c'",name:"Effective Cohesion",description:"Effective cohesion",unit:"Pa",defaultValue:null},{symbol:"L",name:"Arc Length",description:"Length of slip arc",unit:"m",defaultValue:null},{symbol:"W",name:"Slice Weight",description:"Weight of soil slice",unit:"N",defaultValue:null},{symbol:"Œ±",name:"Base Inclination",description:"Angle of base of slice to horizontal",unit:"rad",defaultValue:null},{symbol:"u",name:"Pore Water Pressure",description:"Average pore pressure on slice base",unit:"Pa",defaultValue:null},{symbol:"œÜ'",name:"Effective Friction Angle",description:"Effective internal friction angle",unit:"rad",defaultValue:null}], resultVariable:{symbol:"FoS",name:"Factor of Safety",unit:"dimensionless"} },

"at rest pressure coefficient": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"At-rest earth pressure coefficient K‚ÇÄ (normally consolidated soil).", formula:"K0 = 1 - sin(œÜ')", variables:[{symbol:"œÜ'",name:"Effective Friction Angle",description:"Angle of internal friction (radians)",unit:"rad",defaultValue:null}], resultVariable:{symbol:"K0",name:"At-Rest Pressure Coefficient",unit:"dimensionless"} },

"pressuremeter modulus": { cat:"Geotechnical", standard:"BS EN ISO 22476-4", standardName:"M√©nard pressuremeter test", description:"M√©nard pressuremeter modulus.", formula:"E_m = 2(1+ŒΩ) √ó V_c √ó (ŒîP/ŒîV)", variables:[{symbol:"ŒΩ",name:"Poisson's Ratio",description:"Typically 0.33 assumed",unit:"dimensionless",defaultValue:0.33},{symbol:"V_c",name:"Volume at Reference Pressure",description:"Volume at centre of linear section",unit:"m¬≥",defaultValue:null},{symbol:"ŒîP_ŒîV",name:"Pressure/Volume Slope",description:"Slope of linear portion of pressuremeter curve",unit:"Pa/m¬≥",defaultValue:null}], resultVariable:{symbol:"E_m",name:"Pressuremeter Modulus",unit:"Pa"} },

"ground improvement densification": { cat:"Geotechnical", standard:"BS EN 14731", standardName:"Execution of special geotechnical works ‚Äî Ground treatment by deep vibration", description:"Relative density after vibrocompaction (theoretical limit).", formula:"D_r = (e_max - e) / (e_max - e_min)", variables:[{symbol:"e_max",name:"Maximum Void Ratio",description:"Void ratio in loosest state",unit:"dimensionless",defaultValue:null},{symbol:"e",name:"Current Void Ratio",description:"In-situ void ratio",unit:"dimensionless",defaultValue:null},{symbol:"e_min",name:"Minimum Void Ratio",description:"Void ratio in densest state",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"D_r",name:"Relative Density",unit:"dimensionless"} },

"pile skin friction": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Shaft friction capacity of a pile.", formula:"Q_s = f_s √ó A_s", variables:[{symbol:"f_s",name:"Unit Skin Friction",description:"Average unit skin friction (from soil investigation)",unit:"Pa",defaultValue:null},{symbol:"A_s",name:"Shaft Surface Area",description:"Pile perimeter √ó embedded length",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"Q_s",name:"Shaft Friction Capacity",unit:"N"} },

"pile total capacity": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Total pile compressive resistance.", formula:"R_c = Q_b + Q_s", variables:[{symbol:"Q_b",name:"End Bearing Capacity",description:"Base resistance",unit:"N",defaultValue:null},{symbol:"Q_s",name:"Shaft Friction Capacity",description:"Skin friction resistance",unit:"N",defaultValue:null}], resultVariable:{symbol:"R_c",name:"Total Pile Capacity",unit:"N"} },

"foundation settlement elastic": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Elastic (immediate) settlement of a uniformly loaded foundation.", formula:"s_i = q √ó B √ó (1 - ŒΩ¬≤) √ó I_s / E", variables:[{symbol:"q",name:"Foundation Pressure",description:"Net contact pressure",unit:"Pa",defaultValue:null},{symbol:"B",name:"Foundation Width",description:"Shorter dimension of foundation",unit:"m",defaultValue:null},{symbol:"ŒΩ",name:"Poisson's Ratio",description:"Soil Poisson's ratio (clay ~0.5; sand ~0.3)",unit:"dimensionless",defaultValue:0.3},{symbol:"I_s",name:"Settlement Influence Factor",description:"From tables based on L/B and depth",unit:"dimensionless",defaultValue:0.82},{symbol:"E",name:"Young's Modulus of Soil",description:"Drained elastic modulus of soil",unit:"Pa",defaultValue:null}], resultVariable:{symbol:"s_i",name:"Immediate Settlement",unit:"m"} },

"consolidation coefficient cv": { cat:"Geotechnical", standard:"BS EN ISO 17892-5", standardName:"Oedometer testing", description:"Coefficient of consolidation from oedometer test.", formula:"c_v = 0.197 √ó H_dr¬≤ / t_50", variables:[{symbol:"H_dr",name:"Drainage Path Length",description:"Half layer thickness (double drainage)",unit:"m",defaultValue:null},{symbol:"t_50",name:"Time for 50% Consolidation",description:"From log-time or root-time plot",unit:"s",defaultValue:null}], resultVariable:{symbol:"c_v",name:"Coefficient of Consolidation",unit:"m¬≤/s"} },

"degree of consolidation": { cat:"Geotechnical", standard:"BS EN 1997-1", standardName:"Eurocode 7", description:"Degree of consolidation at time t (for uniform initial distribution).", formula:"U = 1 - exp(-œÄ¬≤ √ó T_v / 4)", variables:[{symbol:"T_v",name:"Time Factor",description:"T_v = c_v √ó t / H_dr¬≤",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"U",name:"Degree of Consolidation",unit:"dimensionless"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FIRE PROTECTION ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"fire compartment size": { cat:"Fire Protection", standard:"BS 9999 / ADB", standardName:"Approved Document B ‚Äî Fire Safety", description:"Maximum compartment area for a given occupancy and sprinkler provision.", formula:"Compartment area per ADB Table 12", variables:[], resultVariable:{symbol:"A_max",name:"Max Compartment Area",unit:"m¬≤"} },

"smoke exhaust flow": { cat:"Fire Protection", standard:"BS EN 12101-6", standardName:"Smoke and heat control systems", description:"Required smoke exhaust flow rate from a fire compartment.", formula:"Q_smoke = A_fire √ó C √ó Œîh^1.5", variables:[{symbol:"A_fire",name:"Fire Area",description:"Expected fire area",unit:"m¬≤",defaultValue:null},{symbol:"C",name:"Fire Growth Coefficient",description:"Sprinklered: 0.07; unsprinklered: varies",unit:"kg/(m¬≤¬∑s¬∑m^1.5)",defaultValue:0.07},{symbol:"Œîh",name:"Smoke Layer Depth",description:"Depth of smoke below exhaust inlet",unit:"m",defaultValue:null}], resultVariable:{symbol:"Q_smoke",name:"Smoke Exhaust Rate",unit:"kg/s"} },

"fire resistance concrete cover": { cat:"Fire Protection", standard:"BS EN 1992-1-2", standardName:"Eurocode 2 ‚Äî Structural fire design", description:"Minimum cover depth for required fire resistance of a beam.", formula:"c_min,fire per Table 5.5", variables:[], resultVariable:{symbol:"c_min",name:"Minimum Cover",unit:"mm"} },

"sprinkler system demand pressure": { cat:"Fire Protection", standard:"BS EN 12845", standardName:"Fixed firefighting systems ‚Äî Automatic sprinkler systems", description:"System design pressure to deliver required flow at most remote head.", formula:"P_design = P_residual + ŒîP_pipe + ŒîP_fittings", variables:[{symbol:"P_residual",name:"Residual Pressure at Head",description:"Minimum at most remote sprinkler",unit:"bar",defaultValue:null},{symbol:"ŒîP_pipe",name:"Pipe Friction Loss",description:"Total loss in distribution pipework",unit:"bar",defaultValue:null},{symbol:"ŒîP_fittings",name:"Fitting Losses",description:"Equivalent pipe losses for fittings",unit:"bar",defaultValue:null}], resultVariable:{symbol:"P_design",name:"System Design Pressure",unit:"bar"} },

"fire water storage tank": { cat:"Fire Protection", standard:"BS EN 12845", standardName:"Fixed firefighting systems ‚Äî Automatic sprinkler systems", description:"Minimum water storage volume for automatic sprinkler system.", formula:"V_tank = Q_system √ó t_operation", variables:[{symbol:"Q_system",name:"System Design Flow",description:"Total design flow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"t_operation",name:"Operation Duration",description:"Required duration (60‚Äì90 min typical)",unit:"s",defaultValue:3600}], resultVariable:{symbol:"V_tank",name:"Minimum Tank Volume",unit:"m¬≥"} },

"timber char rate fire": { cat:"Fire Protection", standard:"BS EN 1995-1-2", standardName:"Eurocode 5 ‚Äî Structural fire design", description:"Charring depth of timber under standard fire exposure.", formula:"d_char = Œ≤‚ÇÄ √ó t", variables:[{symbol:"Œ≤0",name:"Charring Rate",description:"Softwood ~0.8 mm/min; hardwood ~0.5 mm/min",unit:"mm/min",defaultValue:0.8},{symbol:"t",name:"Fire Exposure Time",description:"Duration of fire exposure",unit:"min",defaultValue:null}], resultVariable:{symbol:"d_char",name:"Charring Depth",unit:"mm"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// GAS ENGINEERING ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"gas pipe pressure drop low pressure": { cat:"Gas Engineering", standard:"IGE/UP/2", standardName:"Gas installations in commercial catering establishments", description:"Pressure drop in low-pressure gas pipe (‚â§75 mbar) using simplified formula.", formula:"ŒîP = 11.5 √ó 10‚Åª‚Å∂ √ó S √ó Q¬≤ √ó L / d‚Åµ", variables:[{symbol:"S",name:"Specific Gravity",description:"Relative to air (natural gas ‚âà 0.6)",unit:"dimensionless",defaultValue:0.6},{symbol:"Q",name:"Gas Flow Rate",description:"Flow at standard conditions",unit:"m¬≥/hr",defaultValue:null},{symbol:"L",name:"Pipe Length",description:"Total equivalent pipe length",unit:"m",defaultValue:null},{symbol:"d",name:"Internal Diameter",description:"Pipe internal diameter",unit:"mm",defaultValue:null}], resultVariable:{symbol:"ŒîP",name:"Pressure Drop",unit:"mbar"} },

"gas valve body sizing": { cat:"Gas Engineering", standard:"BS EN 334", standardName:"Gas pressure regulators for inlet pressures up to 100 bar", description:"Body size coefficient Av for a gas regulator valve.", formula:"Av = Q √ó ‚àö(T1 √ó S) / (514 √ó P1 √ó Y)", variables:[{symbol:"Q",name:"Flow Rate",description:"Flow at standard conditions",unit:"m¬≥/hr",defaultValue:null},{symbol:"T1",name:"Upstream Temperature",description:"Absolute upstream temperature",unit:"K",defaultValue:288},{symbol:"S",name:"Specific Gravity",description:"Gas specific gravity vs air",unit:"dimensionless",defaultValue:0.6},{symbol:"P1",name:"Upstream Pressure",description:"Absolute upstream pressure",unit:"bar(abs)",defaultValue:null},{symbol:"Y",name:"Expansion Factor",description:"1.0 for non-critical flow",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"Av",name:"Regulator Flow Coefficient Av",unit:"m¬≥/hr/bar^0.5"} },

"combustion air requirement": { cat:"Gas Engineering", standard:"BS EN 1991-1-2", standardName:"Combustion and ventilation", description:"Theoretical combustion air required for natural gas.", formula:"V_air = 9.52 √ó V_fuel", variables:[{symbol:"V_fuel",name:"Fuel Volume Flow",description:"Volume of natural gas burned",unit:"m¬≥/hr",defaultValue:null}], resultVariable:{symbol:"V_air",name:"Theoretical Air Required",unit:"m¬≥/hr"} },

"flue gas volume": { cat:"Gas Engineering", standard:"BS 6400", standardName:"Specification for installation of domestic gas appliances", description:"Volume of combustion products from burning natural gas.", formula:"V_flue = 10.4 √ó V_fuel", variables:[{symbol:"V_fuel",name:"Fuel Volume Flow",description:"Volume of natural gas burned",unit:"m¬≥/hr",defaultValue:null}], resultVariable:{symbol:"V_flue",name:"Flue Gas Volume",unit:"m¬≥/hr"} },

"gas adiabatic flame temperature": { cat:"Gas Engineering", standard:"ISO 6976", standardName:"Natural gas ‚Äî Calorific values", description:"Approximate adiabatic flame temperature of natural gas in air.", formula:"T_ad = T_initial + CV_net / (m_products √ó cp_products)", variables:[{symbol:"T_initial",name:"Reactant Temperature",description:"Initial temperature of gas and air",unit:"K",defaultValue:293},{symbol:"CV_net",name:"Net Calorific Value",description:"Net calorific value of fuel per m¬≥",unit:"J/m¬≥",defaultValue:35800000},{symbol:"m_products",name:"Mass of Products per m¬≥",description:"Combustion products mass per m¬≥ fuel",unit:"kg/m¬≥",defaultValue:1.2},{symbol:"cp_products",name:"Specific Heat of Products",description:"Specific heat of flue gases ~1.1 kJ/(kg¬∑K)",unit:"J/(kg¬∑K)",defaultValue:1100}], resultVariable:{symbol:"T_ad",name:"Adiabatic Flame Temperature",unit:"K"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ACOUSTICS ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"room reverberation time sabine": { cat:"Acoustics", standard:"BS EN ISO 3382-2", standardName:"Measurement of room acoustic parameters", description:"Reverberation time by Sabine's formula.", formula:"T60 = 0.161 √ó V / A_room", variables:[{symbol:"V",name:"Room Volume",description:"Volume of room",unit:"m¬≥",defaultValue:null},{symbol:"A_room",name:"Total Absorption",description:"Sum of (area √ó absorption coefficient) for all surfaces",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"T60",name:"Reverberation Time",unit:"s"} },

"room reverberation eyring": { cat:"Acoustics", standard:"BS EN ISO 3382-2", standardName:"Measurement of room acoustic parameters", description:"Reverberation time by Eyring's formula (more accurate for high absorption).", formula:"T60 = 0.161 √ó V / (-S √ó ln(1 - ·æ±))", variables:[{symbol:"V",name:"Room Volume",description:"Volume of room",unit:"m¬≥",defaultValue:null},{symbol:"S",name:"Total Room Surface Area",description:"Total surface area of room",unit:"m¬≤",defaultValue:null},{symbol:"·æ±",name:"Mean Absorption Coefficient",description:"Area-weighted average absorption",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"T60",name:"Reverberation Time",unit:"s"} },

"airborne sound insulation": { cat:"Acoustics", standard:"BS EN ISO 717-1", standardName:"Rating of sound insulation ‚Äî Airborne sound", description:"Sound level difference between rooms.", formula:"D = L1 - L2", variables:[{symbol:"L1",name:"Source Room Level",description:"Sound level in source room",unit:"dB",defaultValue:null},{symbol:"L2",name:"Receiver Room Level",description:"Sound level in receiving room",unit:"dB",defaultValue:null}], resultVariable:{symbol:"D",name:"Level Difference",unit:"dB"} },

"impact sound level": { cat:"Acoustics", standard:"BS EN ISO 717-2", standardName:"Rating of sound insulation ‚Äî Impact sound", description:"Normalised impact sound pressure level.", formula:"L_nT = L_n - 10 √ó log10(T/T0)", variables:[{symbol:"L_n",name:"Measured Impact Level",description:"Measured impact sound level",unit:"dB",defaultValue:null},{symbol:"T",name:"Reverberation Time",description:"Measured reverberation time",unit:"s",defaultValue:null},{symbol:"T0",name:"Reference RT",description:"0.5 s for dwellings",unit:"s",defaultValue:0.5}], resultVariable:{symbol:"L_nT",name:"Standardised Impact Sound Level",unit:"dB"} },

"noise dose exposure": { cat:"Acoustics", standard:"BS EN ISO 9612", standardName:"Acoustics ‚Äî Determination of occupational noise exposure", description:"Daily noise exposure level (LEP,d) from noise doses.", formula:"L_EP,d = 10 √ó log10(Œ£(C_i/T_i)) + 85", variables:[{symbol:"C1",name:"Time at Level 1",description:"Exposure time at noise level 1",unit:"h",defaultValue:null},{symbol:"T1",name:"Permissible Time 1",description:"Max permissible time at level 1",unit:"h",defaultValue:null}], resultVariable:{symbol:"L_EPd",name:"Daily Noise Exposure",unit:"dB(A)"} },

"sound power from pressure": { cat:"Acoustics", standard:"BS EN ISO 3744", standardName:"Determination of sound power levels", description:"Sound power level from measured pressure level and measurement surface.", formula:"L_W = L_p + 10 √ó log10(S / S_ref)", variables:[{symbol:"L_p",name:"Mean Sound Pressure Level",description:"Average over measurement surface",unit:"dB",defaultValue:null},{symbol:"S",name:"Measurement Surface Area",description:"Area of measurement surface",unit:"m¬≤",defaultValue:null},{symbol:"S_ref",name:"Reference Surface",description:"1 m¬≤ reference",unit:"m¬≤",defaultValue:1}], resultVariable:{symbol:"L_W",name:"Sound Power Level",unit:"dB"} },

"noise barrier insertion loss": { cat:"Acoustics", standard:"ISO 9613-2", standardName:"Attenuation of sound during propagation outdoors", description:"Approximate insertion loss of a noise barrier (Maekawa method).", formula:"IL ‚âà 10 √ó log10(3 + 20 √ó N)", variables:[{symbol:"N",name:"Fresnel Number",description:"N = 2Œ¥/Œª (Œ¥ = path difference; Œª = wavelength)",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"IL",name:"Insertion Loss",unit:"dB"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ENERGY / SUSTAINABILITY ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"net present value": { cat:"Energy", standard:"ISO 15686-5", standardName:"Buildings and constructed assets ‚Äî Service life planning", description:"Net present value of future cash flows.", formula:"NPV = Œ£ (C_t / (1+r)^t)", variables:[{symbol:"C_t",name:"Annual Cash Flow",description:"Net benefit in year t",unit:"¬£",defaultValue:null},{symbol:"r",name:"Discount Rate",description:"Real discount rate (e.g. 0.035)",unit:"dimensionless",defaultValue:0.035},{symbol:"t",name:"Year",description:"Year of cash flow (1,2,3‚Ä¶n)",unit:"years",defaultValue:null}], resultVariable:{symbol:"NPV",name:"Net Present Value",unit:"¬£"} },

"whole life cost": { cat:"Energy", standard:"ISO 15686-5", standardName:"Buildings and constructed assets ‚Äî Service life planning", description:"Whole life cost including capital, operation, maintenance, and end-of-life.", formula:"WLC = C_capital + PV(C_opex) + PV(C_maintenance) + PV(C_disposal)", variables:[{symbol:"C_capital",name:"Capital Cost",description:"Initial capital expenditure",unit:"¬£",defaultValue:null},{symbol:"PV_opex",name:"PV of Operating Costs",description:"Present value of energy and operating costs",unit:"¬£",defaultValue:null},{symbol:"PV_maint",name:"PV of Maintenance",description:"Present value of maintenance costs",unit:"¬£",defaultValue:null},{symbol:"PV_disp",name:"PV of Disposal",description:"Present value of disposal / decommissioning",unit:"¬£",defaultValue:null}], resultVariable:{symbol:"WLC",name:"Whole Life Cost",unit:"¬£"} },

"solar thermal collector output": { cat:"Energy", standard:"BS EN ISO 9806", standardName:"Solar energy ‚Äî Solar thermal collectors", description:"Useful heat output from a solar thermal collector.", formula:"Q_useful = A_c √ó [G √ó Œ∑_0 - a1 √ó (T_m - T_amb) - a2 √ó (T_m - T_amb)¬≤]", variables:[{symbol:"A_c",name:"Collector Area",description:"Aperture area of collector",unit:"m¬≤",defaultValue:null},{symbol:"G",name:"Solar Irradiance",description:"Global solar irradiance on collector plane",unit:"W/m¬≤",defaultValue:null},{symbol:"Œ∑_0",name:"Zero-Loss Efficiency",description:"Optical efficiency at zero temperature difference",unit:"dimensionless",defaultValue:0.78},{symbol:"a1",name:"Linear Heat Loss Coefficient",description:"From BS EN ISO 9806 test",unit:"W/(m¬≤¬∑K)",defaultValue:3.5},{symbol:"T_m",name:"Mean Fluid Temperature",description:"Mean fluid temperature (inlet+outlet)/2",unit:"¬∞C",defaultValue:null},{symbol:"T_amb",name:"Ambient Temperature",description:"Outdoor air temperature",unit:"¬∞C",defaultValue:null},{symbol:"a2",name:"Quadratic Heat Loss Coefficient",description:"From BS EN ISO 9806 test",unit:"W/(m¬≤¬∑K¬≤)",defaultValue:0.015}], resultVariable:{symbol:"Q_useful",name:"Useful Heat Output",unit:"W"} },

"embodied carbon material": { cat:"Energy", standard:"CIBSE TM65 / BS EN 15978", standardName:"Sustainability of construction works", description:"Embodied carbon from a material quantity.", formula:"EC = m √ó EF_material", variables:[{symbol:"m",name:"Material Mass",description:"Mass of material used",unit:"kg",defaultValue:null},{symbol:"EF_material",name:"Embodied Carbon Factor",description:"kgCO‚ÇÇe/kg (steel ~1.37; concrete ~0.1; aluminium ~8.0)",unit:"kgCO‚ÇÇe/kg",defaultValue:1.37}], resultVariable:{symbol:"EC",name:"Embodied Carbon",unit:"kgCO‚ÇÇe"} },

"operational carbon annual": { cat:"Energy", standard:"CIBSE TM65", standardName:"Embodied and operational carbon", description:"Annual operational carbon from building energy use.", formula:"C_op = E_elec √ó EF_elec + E_gas √ó EF_gas", variables:[{symbol:"E_elec",name:"Annual Electricity",description:"Annual electricity consumption",unit:"kWh",defaultValue:null},{symbol:"EF_elec",name:"Electricity Emission Factor",description:"UK grid ~0.207 kgCO‚ÇÇe/kWh",unit:"kgCO‚ÇÇe/kWh",defaultValue:0.207},{symbol:"E_gas",name:"Annual Gas",description:"Annual gas consumption",unit:"kWh",defaultValue:null},{symbol:"EF_gas",name:"Gas Emission Factor",description:"Natural gas ~0.183 kgCO‚ÇÇe/kWh",unit:"kgCO‚ÇÇe/kWh",defaultValue:0.183}], resultVariable:{symbol:"C_op",name:"Annual Operational Carbon",unit:"kgCO‚ÇÇe"} },

"global warming potential": { cat:"Energy", standard:"ISO 14064-1", standardName:"Greenhouse gases ‚Äî Quantification at organisation level", description:"Global warming potential in CO‚ÇÇ equivalents.", formula:"GWP = Œ£ (m_i √ó GWP_i)", variables:[{symbol:"m_i",name:"Mass of Greenhouse Gas",description:"Quantity of each greenhouse gas",unit:"kg",defaultValue:null},{symbol:"GWP_i",name:"GWP Factor",description:"CO‚ÇÇ=1; CH‚ÇÑ=27; N‚ÇÇO=273; HFC-134a=1530",unit:"kgCO‚ÇÇe/kg",defaultValue:null}], resultVariable:{symbol:"GWP",name:"Total GWP",unit:"kgCO‚ÇÇe"} },

"photovoltaic annual yield": { cat:"Energy", standard:"IEC 61724-1", standardName:"Photovoltaic system performance", description:"Annual electricity yield from a PV installation.", formula:"E_annual = P_peak √ó H_annual √ó PR", variables:[{symbol:"P_peak",name:"Installed Capacity",description:"Peak DC power at STC",unit:"kWp",defaultValue:null},{symbol:"H_annual",name:"Annual Peak Sun Hours",description:"Annual solar irradiation at site (typical UK: 900‚Äì1100 kWh/m¬≤)",unit:"kWh/m¬≤/yr",defaultValue:1000},{symbol:"PR",name:"Performance Ratio",description:"System efficiency (typically 0.75‚Äì0.85)",unit:"dimensionless",defaultValue:0.80}], resultVariable:{symbol:"E_annual",name:"Annual Electricity Yield",unit:"kWh/yr"} },

"battery storage capacity": { cat:"Energy", standard:"IEC 62619", standardName:"Secondary cells and batteries", description:"Usable capacity of a battery storage system.", formula:"E_usable = E_nominal √ó DoD √ó Œ∑_round", variables:[{symbol:"E_nominal",name:"Nominal Capacity",description:"Battery nameplate capacity",unit:"kWh",defaultValue:null},{symbol:"DoD",name:"Depth of Discharge",description:"Maximum usable fraction (0.8‚Äì0.9 for Li-ion)",unit:"dimensionless",defaultValue:0.85},{symbol:"Œ∑_round",name:"Round-Trip Efficiency",description:"Charge/discharge efficiency",unit:"dimensionless",defaultValue:0.9}], resultVariable:{symbol:"E_usable",name:"Usable Energy Capacity",unit:"kWh"} },

"heat pump cop heating": { cat:"Energy", standard:"BS EN 14511", standardName:"Air conditioners, liquid chilling packages and heat pumps", description:"Seasonal COP of a heat pump in heating mode.", formula:"COP_h = Q_output / W_input", variables:[{symbol:"Q_output",name:"Heat Output",description:"Heat delivered to building",unit:"W",defaultValue:null},{symbol:"W_input",name:"Electrical Input",description:"Compressor electrical power",unit:"W",defaultValue:null}], resultVariable:{symbol:"COP_h",name:"Heating COP",unit:"dimensionless"} },

"epc rating calculation": { cat:"Energy", standard:"SAP 2012 / RdSAP", standardName:"Standard Assessment Procedure for Energy Rating of Dwellings", description:"Energy Performance Certificate rating from SAP score.", formula:"EPC = 117 - 121 √ó log10(SAP_score) if SAP‚â•1", variables:[{symbol:"SAP_score",name:"SAP Score",description:"SAP 2012 energy score (1‚Äì100+)",unit:"points",defaultValue:null}], resultVariable:{symbol:"EPC",name:"EPC Band Score",unit:"points"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MECHANICAL ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"flywheel energy storage": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Kinetic energy stored in a rotating flywheel.", formula:"E = 0.5 √ó I √ó œâ¬≤", variables:[{symbol:"I",name:"Moment of Inertia",description:"Mass moment of inertia of flywheel",unit:"kg¬∑m¬≤",defaultValue:null},{symbol:"œâ",name:"Angular Velocity",description:"Rotational speed in rad/s",unit:"rad/s",defaultValue:null}], resultVariable:{symbol:"E",name:"Stored Kinetic Energy",unit:"J"} },

"moment of inertia solid disk": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Mass moment of inertia of a solid disk (flywheel).", formula:"I = 0.5 √ó m √ó r¬≤", variables:[{symbol:"m",name:"Mass",description:"Total mass of disk",unit:"kg",defaultValue:null},{symbol:"r",name:"Radius",description:"Outer radius of disk",unit:"m",defaultValue:null}], resultVariable:{symbol:"I",name:"Mass Moment of Inertia",unit:"kg¬∑m¬≤"} },

"moment of inertia ring": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Mass moment of inertia of a hollow cylinder (ring).", formula:"I = 0.5 √ó m √ó (r_o¬≤ + r_i¬≤)", variables:[{symbol:"m",name:"Mass",description:"Total mass of ring",unit:"kg",defaultValue:null},{symbol:"r_o",name:"Outer Radius",description:"Outer radius of ring",unit:"m",defaultValue:null},{symbol:"r_i",name:"Inner Radius",description:"Inner radius of ring",unit:"m",defaultValue:null}], resultVariable:{symbol:"I",name:"Mass Moment of Inertia",unit:"kg¬∑m¬≤"} },

"angular momentum": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Angular momentum of a rotating body.", formula:"L = I √ó œâ", variables:[{symbol:"I",name:"Moment of Inertia",description:"Mass moment of inertia",unit:"kg¬∑m¬≤",defaultValue:null},{symbol:"œâ",name:"Angular Velocity",description:"Rotational speed",unit:"rad/s",defaultValue:null}], resultVariable:{symbol:"L",name:"Angular Momentum",unit:"kg¬∑m¬≤/s"} },

"gear tooth bending stress lewis": { cat:"Mechanical", standard:"BS ISO 6336-3", standardName:"Calculation of load capacity of spur and helical gears", description:"Bending stress at gear tooth root (Lewis equation).", formula:"œÉ_b = W_t / (b √ó m √ó Y)", variables:[{symbol:"W_t",name:"Tangential Force",description:"Transmitted tangential force",unit:"N",defaultValue:null},{symbol:"b",name:"Face Width",description:"Gear face width",unit:"m",defaultValue:null},{symbol:"m",name:"Module",description:"Gear module (m = D/z)",unit:"m",defaultValue:null},{symbol:"Y",name:"Lewis Form Factor",description:"From Lewis Y tables (~0.35 for 20 teeth)",unit:"dimensionless",defaultValue:0.35}], resultVariable:{symbol:"œÉ_b",name:"Root Bending Stress",unit:"Pa"} },

"hertzian contact stress": { cat:"Mechanical", standard:"BS ISO 6336-2", standardName:"Calculation of load capacity of spur and helical gears", description:"Maximum contact (Hertzian) stress between two cylinders.", formula:"œÉ_H = ‚àö(F / (œÄ √ó L) √ó (1/E' √ó (1/R1 + 1/R2) √ó E_reduced))", variables:[{symbol:"F",name:"Contact Force",description:"Normal contact force",unit:"N",defaultValue:null},{symbol:"L",name:"Contact Length",description:"Length of contact",unit:"m",defaultValue:null},{symbol:"R1",name:"Radius of Body 1",description:"Radius of first cylinder",unit:"m",defaultValue:null},{symbol:"R2",name:"Radius of Body 2",description:"Radius of second cylinder",unit:"m",defaultValue:null},{symbol:"E_reduced",name:"Reduced Modulus",description:"2/((1-ŒΩ1¬≤)/E1 + (1-ŒΩ2¬≤)/E2)",unit:"Pa",defaultValue:110000000000}], resultVariable:{symbol:"œÉ_H",name:"Hertzian Contact Stress",unit:"Pa"} },

"belt tension ratio": { cat:"Mechanical", standard:"BS ISO 22:", standardName:"Belt drives", description:"Belt drive tension ratio (Euler-Eytelwein equation).", formula:"T1/T2 = e^(Œº √ó Œ∏)", variables:[{symbol:"Œº",name:"Coefficient of Friction",description:"Belt on pulley friction (leather/steel ~0.3)",unit:"dimensionless",defaultValue:0.3},{symbol:"Œ∏",name:"Wrap Angle",description:"Angle of wrap on smaller pulley (radians)",unit:"rad",defaultValue:3.14}], resultVariable:{symbol:"T_ratio",name:"Tension Ratio T1/T2",unit:"dimensionless"} },

"conveyor power": { cat:"Mechanical", standard:"BS ISO 5048", standardName:"Continuous mechanical handling equipment ‚Äî Belt conveyors", description:"Power required to drive a belt conveyor.", formula:"P = (F_L + F_G + F_A) √ó v", variables:[{symbol:"F_L",name:"Load Friction Force",description:"Material + belt friction force",unit:"N",defaultValue:null},{symbol:"F_G",name:"Gravitational Force Component",description:"For inclined conveyors: m_load √ó g √ó sin(Œ≤)",unit:"N",defaultValue:0},{symbol:"F_A",name:"Acceleration Force",description:"Force to accelerate material",unit:"N",defaultValue:0},{symbol:"v",name:"Belt Speed",description:"Conveyor belt speed",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"P",name:"Drive Power",unit:"W"} },

"brake horsepower": { cat:"Mechanical", standard:"BS EN ISO 80000-4", standardName:"Mechanics", description:"Brake horsepower (shaft power) of a rotating machine.", formula:"BHP = T √ó n / 9550", variables:[{symbol:"T",name:"Torque",description:"Shaft torque",unit:"N¬∑m",defaultValue:null},{symbol:"n",name:"Rotational Speed",description:"Speed in rpm",unit:"rpm",defaultValue:null}], resultVariable:{symbol:"BHP",name:"Shaft Power (kW)",unit:"kW"} },

"vibration frequency undamped": { cat:"Mechanical", standard:"BS EN ISO 10816", standardName:"Mechanical vibration ‚Äî Evaluation of machine vibration", description:"Undamped natural frequency of a system.", formula:"œâ_n = ‚àö(k / m)", variables:[{symbol:"k",name:"Stiffness",description:"System spring stiffness",unit:"N/m",defaultValue:null},{symbol:"m",name:"Mass",description:"Vibrating mass",unit:"kg",defaultValue:null}], resultVariable:{symbol:"œâ_n",name:"Undamped Natural Frequency",unit:"rad/s"} },

"damped natural frequency": { cat:"Mechanical", standard:"BS EN ISO 10816", standardName:"Mechanical vibration", description:"Damped natural frequency of a system.", formula:"œâ_d = œâ_n √ó ‚àö(1 - Œ∂¬≤)", variables:[{symbol:"œâ_n",name:"Undamped Natural Frequency",description:"From ‚àö(k/m)",unit:"rad/s",defaultValue:null},{symbol:"Œ∂",name:"Damping Ratio",description:"c/(2‚àö(km))",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"œâ_d",name:"Damped Natural Frequency",unit:"rad/s"} },

"critical damping coefficient": { cat:"Mechanical", standard:"BS EN ISO 10816", standardName:"Mechanical vibration", description:"Critical damping coefficient for a spring-mass system.", formula:"c_cr = 2 √ó ‚àö(k √ó m)", variables:[{symbol:"k",name:"Stiffness",description:"Spring stiffness",unit:"N/m",defaultValue:null},{symbol:"m",name:"Mass",description:"Vibrating mass",unit:"kg",defaultValue:null}], resultVariable:{symbol:"c_cr",name:"Critical Damping Coefficient",unit:"N¬∑s/m"} },

"bearing life L10": { cat:"Mechanical", standard:"ISO 281", standardName:"Rolling bearings ‚Äî Dynamic load ratings and rating life", description:"Basic rating life of a rolling bearing (L10 at 90% reliability).", formula:"L10 = (C / P)^p √ó 10‚Å∂ / (60 √ó n)", variables:[{symbol:"C",name:"Basic Dynamic Load Rating",description:"From bearing catalogue",unit:"N",defaultValue:null},{symbol:"P",name:"Equivalent Dynamic Load",description:"Combined radial and axial load",unit:"N",defaultValue:null},{symbol:"p",name:"Life Exponent",description:"3 for ball bearings; 10/3 for roller bearings",unit:"dimensionless",defaultValue:3},{symbol:"n",name:"Rotational Speed",description:"Bearing speed in rpm",unit:"rpm",defaultValue:null}], resultVariable:{symbol:"L10",name:"Basic Rating Life",unit:"hours"} },

"lifting lug weld stress": { cat:"Mechanical", standard:"BS EN 1993-1-8", standardName:"Eurocode 3 ‚Äî Design of joints", description:"Shear stress in lifting lug weld under vertical load.", formula:"œÑ = F / (2 √ó a √ó l_weld)", variables:[{symbol:"F",name:"Lifting Force",description:"Applied lifting load",unit:"N",defaultValue:null},{symbol:"a",name:"Weld Throat",description:"Effective weld throat (0.707 √ó leg)",unit:"m",defaultValue:null},{symbol:"l_weld",name:"Weld Length",description:"Total weld length (both sides)",unit:"m",defaultValue:null}], resultVariable:{symbol:"œÑ",name:"Weld Shear Stress",unit:"Pa"} },

"pressure relief valve flow steam": { cat:"Pressure Vessels", standard:"ASME VIII Div.1 UG-131", standardName:"ASME Boiler and Pressure Vessel Code", description:"Required steam flow through a safety relief valve.", formula:"W = 51.45 √ó A √ó K_d √ó P1 √ó K_sh √ó K_n √ó K_b", variables:[{symbol:"A",name:"Orifice Area",description:"Required orifice area",unit:"in¬≤",defaultValue:null},{symbol:"K_d",name:"Discharge Coefficient",description:"0.975 for steam",unit:"dimensionless",defaultValue:0.975},{symbol:"P1",name:"Relieving Pressure",description:"Set pressure √ó 1.1 + 14.7 (psia)",unit:"psia",defaultValue:null},{symbol:"K_sh",name:"Superheat Correction",description:"From API 520 Table 7",unit:"dimensionless",defaultValue:1.0},{symbol:"K_n",name:"Napier Correction",description:"Correction for high pressure",unit:"dimensionless",defaultValue:1.0},{symbol:"K_b",name:"Backpressure Factor",description:"1.0 for conventional PRV",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"W",name:"Relieving Flow",unit:"lb/hr"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DRAINAGE / WATER ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"sewer design capacity": { cat:"Drainage", standard:"Sewers for Adoption 7th Ed / BS EN 752", standardName:"Drain and Sewer Systems Outside Buildings", description:"Design capacity of a circular pipe at 75% full using Manning.", formula:"Q_75 = 0.6136 √ó (1/n) √ó D^(8/3) √ó S^(1/2)", variables:[{symbol:"n",name:"Manning's n",description:"Roughness coefficient (PVC 0.010; concrete 0.013)",unit:"s/m^(1/3)",defaultValue:0.013},{symbol:"D",name:"Pipe Diameter",description:"Nominal pipe diameter",unit:"m",defaultValue:null},{symbol:"S",name:"Pipe Gradient",description:"Pipe gradient m/m",unit:"m/m",defaultValue:null}], resultVariable:{symbol:"Q_75",name:"75% Full Capacity",unit:"m¬≥/s"} },

"wastewater flow population equivalent": { cat:"Drainage", standard:"BS EN 12255", standardName:"Wastewater treatment plants", description:"Design wastewater flow from population equivalent.", formula:"Q_dry = PE √ó 200 / 86400", variables:[{symbol:"PE",name:"Population Equivalent",description:"Number of person-equivalents",unit:"PE",defaultValue:null}], resultVariable:{symbol:"Q_dry",name:"Dry Weather Flow",unit:"m¬≥/s"} },

"stormwater runoff rational method": { cat:"Drainage", standard:"FEH / BS EN 752", standardName:"Flood Estimation Handbook / Drain and Sewer Systems", description:"Peak stormwater runoff using rational method.", formula:"Q_peak = C √ó i √ó A / 360", variables:[{symbol:"C",name:"Runoff Coefficient",description:"0.9 impermeable; 0.3 grass; 0.6 mixed",unit:"dimensionless",defaultValue:0.7},{symbol:"i",name:"Rainfall Intensity",description:"Design rainfall intensity",unit:"mm/hr",defaultValue:null},{symbol:"A",name:"Catchment Area",description:"Drainage catchment area",unit:"ha",defaultValue:null}], resultVariable:{symbol:"Q_peak",name:"Peak Flow Rate",unit:"m¬≥/s"} },

"sustainable drainage attenuation": { cat:"Drainage", standard:"CIRIA C753", standardName:"SUDS Manual", description:"Required attenuation volume for stormwater management.", formula:"V_att = (Q_greenfield - Q_allowable) √ó t_critical", variables:[{symbol:"Q_greenfield",name:"Greenfield Runoff",description:"Runoff rate in greenfield conditions",unit:"m¬≥/s",defaultValue:null},{symbol:"Q_allowable",name:"Allowable Discharge",description:"Maximum permissible outflow rate",unit:"m¬≥/s",defaultValue:null},{symbol:"t_critical",name:"Critical Storm Duration",description:"Duration that maximises storage volume",unit:"s",defaultValue:3600}], resultVariable:{symbol:"V_att",name:"Required Attenuation Volume",unit:"m¬≥"} },

"pipe gradient self-cleansing": { cat:"Drainage", standard:"BS EN 752 / Sewers for Adoption", standardName:"Drain and Sewer Systems", description:"Minimum gradient for self-cleansing velocity in a gravity sewer.", formula:"S_min = (v_min √ó n / D^(2/3))¬≤", variables:[{symbol:"v_min",name:"Minimum Velocity",description:"Self-cleansing velocity (‚â•0.7 m/s for sewers)",unit:"m/s",defaultValue:0.7},{symbol:"n",name:"Manning's n",description:"Roughness coefficient",unit:"s/m^(1/3)",defaultValue:0.013},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter",unit:"m",defaultValue:null}], resultVariable:{symbol:"S_min",name:"Minimum Gradient",unit:"m/m"} },

"detention pond routing": { cat:"Drainage", standard:"CIRIA C753", standardName:"SUDS Manual", description:"Level pool routing storage equation.", formula:"S2 + O2√óŒît/2 = S1 + (I1+I2)√óŒît/2 - O1√óŒît/2", variables:[{symbol:"S1",name:"Initial Storage",description:"Storage volume at start of time step",unit:"m¬≥",defaultValue:null},{symbol:"O1",name:"Initial Outflow",description:"Outflow at start of time step",unit:"m¬≥/s",defaultValue:null},{symbol:"I1",name:"Inflow Start",description:"Inflow at start of time step",unit:"m¬≥/s",defaultValue:null},{symbol:"I2",name:"Inflow End",description:"Inflow at end of time step",unit:"m¬≥/s",defaultValue:null},{symbol:"Œît",name:"Time Step",description:"Routing time step",unit:"s",defaultValue:600}], resultVariable:{symbol:"S2_O2",name:"S2 + O2Œît/2 (solve for S2,O2)",unit:"m¬≥"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONCRETE ‚Äî EXPANDED
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"concrete mix water cement ratio": { cat:"Concrete", standard:"BS EN 206 / ACI 318", standardName:"Concrete ‚Äî Specification, performance", description:"Water-cement ratio for target compressive strength.", formula:"w/c = A / (f_c + B)", variables:[{symbol:"A",name:"Constant A",description:"Abrams law constant A ‚âà 96 MPa for OPC",unit:"MPa",defaultValue:96},{symbol:"f_c",name:"Target Strength",description:"Required 28-day compressive strength",unit:"MPa",defaultValue:null},{symbol:"B",name:"Constant B",description:"Abrams law constant B ‚âà 5.6 MPa",unit:"MPa",defaultValue:5.6}], resultVariable:{symbol:"w_c",name:"Water-Cement Ratio",unit:"dimensionless"} },

"concrete shrinkage free": { cat:"Concrete", standard:"BS EN 1992-1-1", standardName:"Eurocode 2", description:"Total drying shrinkage strain of concrete.", formula:"Œµ_cd = Œ≤_ds √ó k_h √ó Œµ_cd0", variables:[{symbol:"Œ≤_ds",name:"Time Development Factor",description:"Time-dependent factor from EC2 Fig 3.3",unit:"dimensionless",defaultValue:null},{symbol:"k_h",name:"Notional Size Factor",description:"From EC2 Table 3.3",unit:"dimensionless",defaultValue:null},{symbol:"Œµ_cd0",name:"Basic Drying Shrinkage",description:"From EC2 Table 3.2",unit:"dimensionless",defaultValue:0.00026}], resultVariable:{symbol:"Œµ_cd",name:"Drying Shrinkage Strain",unit:"dimensionless"} },

"concrete cover nominal": { cat:"Concrete", standard:"BS EN 1992-1-1 Cl.4.4", standardName:"Eurocode 2", description:"Nominal cover to reinforcement.", formula:"c_nom = c_min + Œîc_dev", variables:[{symbol:"c_min",name:"Minimum Cover",description:"Minimum cover for bond and durability (BS EN 1992-1-1)",unit:"mm",defaultValue:null},{symbol:"Œîc_dev",name:"Allowance in Design",description:"Construction tolerance (typically 10 mm)",unit:"mm",defaultValue:10}], resultVariable:{symbol:"c_nom",name:"Nominal Cover",unit:"mm"} },

"concrete elastic modulus": { cat:"Concrete", standard:"BS EN 1992-1-1", standardName:"Eurocode 2", description:"Modulus of elasticity of normal weight concrete.", formula:"E_cm = 22 √ó (f_cm/10)^0.3", variables:[{symbol:"f_cm",name:"Mean Compressive Strength",description:"Mean cylinder strength (f_ck + 8 MPa)",unit:"MPa",defaultValue:null}], resultVariable:{symbol:"E_cm",name:"Elastic Modulus",unit:"GPa"} },

"concrete tension lap length": { cat:"Concrete", standard:"BS EN 1992-1-1 Cl.8.7", standardName:"Eurocode 2", description:"Design lap length for tension reinforcement bars.", formula:"l_0 = Œ±_1 √ó Œ±_2 √ó Œ±_3 √ó Œ±_5 √ó Œ±_6 √ó l_b,rqd", variables:[{symbol:"Œ±_1",name:"Œ±‚ÇÅ Factor",description:"Bar shape (1.0 for straight bars)",unit:"dimensionless",defaultValue:1.0},{symbol:"Œ±_2",name:"Œ±‚ÇÇ Factor",description:"Concrete cover (1.0 if c ‚â• œÜ)",unit:"dimensionless",defaultValue:1.0},{symbol:"Œ±_6",name:"Œ±‚ÇÜ Factor",description:"Proportion lapped at section (1.5 if >50%)",unit:"dimensionless",defaultValue:1.5},{symbol:"l_b_rqd",name:"Basic Lap Length",description:"= (œÜ/4) √ó (œÉ_sd/f_bd)",unit:"mm",defaultValue:null}], resultVariable:{symbol:"l_0",name:"Design Lap Length",unit:"mm"} },

"concrete bond stress": { cat:"Concrete", standard:"BS EN 1992-1-1 Cl.8.4", standardName:"Eurocode 2", description:"Design ultimate bond stress for ribbed reinforcement bars.", formula:"f_bd = 2.25 √ó Œ∑1 √ó Œ∑2 √ó f_ctd", variables:[{symbol:"Œ∑1",name:"Bond Quality Factor",description:"1.0 good bond; 0.7 poor bond",unit:"dimensionless",defaultValue:1.0},{symbol:"Œ∑2",name:"Bar Diameter Factor",description:"1.0 for œÜ ‚â§ 32 mm",unit:"dimensionless",defaultValue:1.0},{symbol:"f_ctd",name:"Design Tensile Strength",description:"f_ctk,0.05 / Œ≥c",unit:"MPa",defaultValue:null}], resultVariable:{symbol:"f_bd",name:"Design Bond Stress",unit:"MPa"} },

"pile reinforcement tension": { cat:"Concrete", standard:"BS EN 1992-1-1", standardName:"Eurocode 2", description:"Tension anchorage length for pile reinforcement.", formula:"l_bd = l_b,rqd √ó Œ±_1 √ó Œ±_2 √ó Œ±_3 √ó Œ±_4 √ó Œ±_5", variables:[{symbol:"l_b_rqd",name:"Basic Anchorage Length",description:"= (œÜ/4) √ó (œÉ_sd/f_bd)",unit:"mm",defaultValue:null},{symbol:"product_Œ±",name:"Product of Œ± Factors",description:"From EC2 Table 8.2 (min 0.3)",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"l_bd",name:"Design Anchorage Length",unit:"mm"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MATERIALS / NDT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"charpy impact energy": { cat:"Materials", standard:"BS EN ISO 148-1", standardName:"Metallic materials ‚Äî Charpy pendulum impact test", description:"Absorbed impact energy in Charpy test ‚Äî used for ductile-brittle transition assessment.", formula:"KV = m √ó g √ó (h0 - h1)", variables:[{symbol:"m",name:"Hammer Mass",description:"Mass of pendulum hammer",unit:"kg",defaultValue:null},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"h0",name:"Initial Height",description:"Initial height of pendulum",unit:"m",defaultValue:null},{symbol:"h1",name:"Final Height",description:"Final height after impact",unit:"m",defaultValue:null}], resultVariable:{symbol:"KV",name:"Charpy Impact Energy",unit:"J"} },

"hardness to tensile strength": { cat:"Materials", standard:"ASTM E140 / BS EN ISO 6508", standardName:"Metallic materials ‚Äî Rockwell hardness", description:"Approximate UTS from Vickers hardness (steels).", formula:"UTS ‚âà 3.45 √ó HV", variables:[{symbol:"HV",name:"Vickers Hardness",description:"Measured Vickers hardness",unit:"HV",defaultValue:null}], resultVariable:{symbol:"UTS",name:"Approximate UTS",unit:"MPa"} },

"fracture toughness stress intensity": { cat:"Materials", standard:"BS EN ISO 12737", standardName:"Metallic materials ‚Äî Plane-strain fracture toughness", description:"Mode I stress intensity factor for edge crack in plate.", formula:"K_I = F √ó œÉ √ó ‚àö(œÄ √ó a)", variables:[{symbol:"F",name:"Geometry Factor",description:"Correction factor (1.12 for edge crack in infinite plate)",unit:"dimensionless",defaultValue:1.12},{symbol:"œÉ",name:"Applied Stress",description:"Remote applied tensile stress",unit:"Pa",defaultValue:null},{symbol:"a",name:"Crack Length",description:"Half crack length",unit:"m",defaultValue:null}], resultVariable:{symbol:"K_I",name:"Stress Intensity Factor",unit:"Pa¬∑m^0.5"} },

"fatigue crack growth paris": { cat:"Materials", standard:"BS 7910", standardName:"Guide to methods for assessing the acceptability of flaws in metallic structures", description:"Fatigue crack growth rate by Paris law.", formula:"da/dN = C √ó (ŒîK)^m", variables:[{symbol:"C",name:"Paris Constant C",description:"Material constant (steel: ~3√ó10‚Åª¬π¬≥)",unit:"m/cycle per (Pa‚àöm)^m",defaultValue:3e-13},{symbol:"ŒîK",name:"Stress Intensity Range",description:"ŒîK = K_max - K_min",unit:"Pa¬∑m^0.5",defaultValue:null},{symbol:"m",name:"Paris Exponent",description:"Material exponent (steel ~3)",unit:"dimensionless",defaultValue:3}], resultVariable:{symbol:"da_dN",name:"Crack Growth Rate",unit:"m/cycle"} },

"thermal expansion linear": { cat:"Materials", standard:"BS EN ISO 12004", standardName:"Metallic materials", description:"Linear thermal expansion of a material.", formula:"ŒîL = L0 √ó Œ± √ó ŒîT", variables:[{symbol:"L0",name:"Original Length",description:"Original length of member",unit:"m",defaultValue:null},{symbol:"Œ±",name:"Coefficient of Thermal Expansion",description:"Steel ~12√ó10‚Åª‚Å∂/¬∞C; Aluminium ~23√ó10‚Åª‚Å∂/¬∞C; Copper ~17√ó10‚Åª‚Å∂/¬∞C",unit:"1/¬∞C",defaultValue:0.000012},{symbol:"ŒîT",name:"Temperature Change",description:"Change in temperature",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"ŒîL",name:"Thermal Expansion",unit:"m"} },

"young modulus from tension test": { cat:"Materials", standard:"BS EN ISO 6892-1", standardName:"Metallic materials ‚Äî Tensile testing at room temperature", description:"Young's modulus from tensile test data.", formula:"E = stress / strain = (F/A) / (ŒîL/L0)", variables:[{symbol:"F",name:"Applied Force",description:"Force in elastic range",unit:"N",defaultValue:null},{symbol:"A",name:"Cross-sectional Area",description:"Original area",unit:"m¬≤",defaultValue:null},{symbol:"ŒîL",name:"Extension",description:"Measured elongation",unit:"m",defaultValue:null},{symbol:"L0",name:"Gauge Length",description:"Original gauge length",unit:"m",defaultValue:null}], resultVariable:{symbol:"E",name:"Young's Modulus",unit:"Pa"} },

"poisson ratio": { cat:"Materials", standard:"BS EN ISO 6892-1", standardName:"Metallic materials ‚Äî Tensile testing", description:"Poisson's ratio from lateral and axial strains.", formula:"ŒΩ = -Œµ_lateral / Œµ_axial", variables:[{symbol:"Œµ_lateral",name:"Lateral Strain",description:"Strain perpendicular to load (negative for tension)",unit:"dimensionless",defaultValue:null},{symbol:"Œµ_axial",name:"Axial Strain",description:"Strain in direction of load",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"ŒΩ",name:"Poisson's Ratio",unit:"dimensionless"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STRUCTURAL DYNAMICS / SEISMIC
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"seismic base shear eurocode": { cat:"Structural", standard:"BS EN 1998-1", standardName:"Eurocode 8 ‚Äî Design for seismic resistance", description:"Seismic base shear using lateral force method.", formula:"F_b = S_d(T1) √ó m √ó Œª", variables:[{symbol:"S_d",name:"Design Spectrum Value",description:"Ordinate from design spectrum at period T1",unit:"m/s¬≤",defaultValue:null},{symbol:"m",name:"Total Mass",description:"Total seismic mass of building",unit:"kg",defaultValue:null},{symbol:"Œª",name:"Correction Factor",description:"0.85 if T1 ‚â§ 2TC and more than 2 storeys; otherwise 1.0",unit:"dimensionless",defaultValue:0.85}], resultVariable:{symbol:"F_b",name:"Seismic Base Shear",unit:"N"} },

"period of vibration buildings": { cat:"Structural", standard:"BS EN 1998-1", standardName:"Eurocode 8 ‚Äî Design for seismic resistance", description:"Approximate fundamental period of vibration for a building.", formula:"T1 = Ct √ó H^(3/4)", variables:[{symbol:"Ct",name:"Building Coefficient",description:"0.085 steel MRF; 0.075 concrete MRF; 0.050 other frames; 0.075 RC walls",unit:"s/m^0.75",defaultValue:0.075},{symbol:"H",name:"Building Height",description:"Total height of building",unit:"m",defaultValue:null}], resultVariable:{symbol:"T1",name:"Fundamental Period",unit:"s"} },

"wind load pressure eurocode": { cat:"Structural", standard:"BS EN 1991-1-4", standardName:"Eurocode 1 ‚Äî Wind actions", description:"Peak velocity pressure at reference height.", formula:"q_p = 0.5 √ó œÅ √ó v_p¬≤", variables:[{symbol:"œÅ",name:"Air Density",description:"Air density (1.25 kg/m¬≥ standard)",unit:"kg/m¬≥",defaultValue:1.25},{symbol:"v_p",name:"Peak Wind Velocity",description:"Peak gust velocity at height z",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"q_p",name:"Peak Velocity Pressure",unit:"Pa"} },

"wind force on structure": { cat:"Structural", standard:"BS EN 1991-1-4", standardName:"Eurocode 1 ‚Äî Wind actions", description:"Total wind force on a structure.", formula:"F_w = cs√ócd √ó cf √ó q_p √ó A_ref", variables:[{symbol:"cs_cd",name:"Structural Factor",description:"cscd from EC1 dynamic analysis (‚âà1 for rigid structures)",unit:"dimensionless",defaultValue:1.0},{symbol:"cf",name:"Force Coefficient",description:"cf from EC1 charts based on geometry",unit:"dimensionless",defaultValue:1.3},{symbol:"q_p",name:"Peak Velocity Pressure",description:"At reference height",unit:"Pa",defaultValue:null},{symbol:"A_ref",name:"Reference Area",description:"Projected area perpendicular to wind",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"F_w",name:"Wind Force",unit:"N"} },

"snow load eurocode": { cat:"Structural", standard:"BS EN 1991-1-3", standardName:"Eurocode 1 ‚Äî Snow loads", description:"Snow load on a roof.", formula:"s = Œºi √ó Ce √ó Ct √ó sk", variables:[{symbol:"Œºi",name:"Snow Load Shape Coeff.",description:"Œº1 = 0.8 for flat roofs; increases for pitched",unit:"dimensionless",defaultValue:0.8},{symbol:"Ce",name:"Exposure Coefficient",description:"0.8 windy; 1.0 normal; 1.2 sheltered",unit:"dimensionless",defaultValue:1.0},{symbol:"Ct",name:"Thermal Coefficient",description:"1.0 unless heated roof",unit:"dimensionless",defaultValue:1.0},{symbol:"sk",name:"Characteristic Ground Snow Load",description:"From national annex map",unit:"kN/m¬≤",defaultValue:0.5}], resultVariable:{symbol:"s",name:"Roof Snow Load",unit:"kN/m¬≤"} },

"imposed load reduction eurocode": { cat:"Structural", standard:"BS EN 1991-1-1 Cl.6.3.1.2", standardName:"Eurocode 1 ‚Äî Densities, self-weight, imposed loads", description:"Reduction factor for imposed loads on large areas.", formula:"Œ±_A = 5/7 √ó œà0 + A0/A", variables:[{symbol:"œà0",name:"Combination Factor",description:"From EC1 National Annex (typically 0.7 for offices)",unit:"dimensionless",defaultValue:0.7},{symbol:"A0",name:"Reference Area",description:"10 m¬≤",unit:"m¬≤",defaultValue:10},{symbol:"A",name:"Loaded Area",description:"Area supported by member",unit:"m¬≤",defaultValue:null}], resultVariable:{symbol:"Œ±_A",name:"Area Reduction Factor",unit:"dimensionless"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PIPING / VALVES / FLOW MEASUREMENT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"valve pressure drop liquid": { cat:"Fluid Mechanics", standard:"IEC 60534-2-1", standardName:"Industrial-process control valves", description:"Pressure drop across a partially open liquid control valve.", formula:"ŒîP = (Q / (Kv √ó ‚àö(œÅ_rel)))¬≤ √ó 10‚Åµ", variables:[{symbol:"Q",name:"Flow Rate",description:"Actual flow rate",unit:"m¬≥/h",defaultValue:null},{symbol:"Kv",name:"Valve Kv",description:"Kv at given opening",unit:"m¬≥/h",defaultValue:null},{symbol:"œÅ_rel",name:"Relative Density",description:"Fluid specific gravity",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"ŒîP",name:"Pressure Drop",unit:"Pa"} },

"pipe flow two phase": { cat:"Fluid Mechanics", standard:"ASME B31.3", standardName:"Process Piping", description:"Two-phase flow quality (vapour fraction).", formula:"x = ·πÅ_vapour / ·πÅ_total", variables:[{symbol:"·πÅ_vapour",name:"Vapour Mass Flow",description:"Mass flow of vapour phase",unit:"kg/s",defaultValue:null},{symbol:"·πÅ_total",name:"Total Mass Flow",description:"Total combined mass flow",unit:"kg/s",defaultValue:null}], resultVariable:{symbol:"x",name:"Quality (Vapour Fraction)",unit:"dimensionless"} },

"flow nozzle discharge": { cat:"Fluid Mechanics", standard:"ISO 5167-3", standardName:"Flow nozzles", description:"Flow rate through a flow nozzle.", formula:"Q = Cd √ó (œÄ/4) √ó d¬≤ √ó ‚àö(2 √ó ŒîP / (œÅ √ó (1-(d/D)‚Å¥)))", variables:[{symbol:"Cd",name:"Discharge Coefficient",description:"Typically 0.95‚Äì0.99 for flow nozzles",unit:"dimensionless",defaultValue:0.97},{symbol:"d",name:"Throat Diameter",description:"Nozzle throat diameter",unit:"m",defaultValue:null},{symbol:"D",name:"Pipe Diameter",description:"Upstream pipe diameter",unit:"m",defaultValue:null},{symbol:"ŒîP",name:"Differential Pressure",description:"Measured pressure drop",unit:"Pa",defaultValue:null},{symbol:"œÅ",name:"Fluid Density",description:"Fluid density at conditions",unit:"kg/m¬≥",defaultValue:null}], resultVariable:{symbol:"Q",name:"Volumetric Flow Rate",unit:"m¬≥/s"} },

"ultrasonic flow meter": { cat:"Fluid Mechanics", standard:"OIML R 117", standardName:"Dynamic measuring systems for liquids", description:"Transit-time ultrasonic flowmeter velocity measurement.", formula:"v = (D / (2 √ó cos Œ∏)) √ó ((t_up - t_dn) / (t_up √ó t_dn))", variables:[{symbol:"D",name:"Pipe Diameter",description:"Internal pipe diameter",unit:"m",defaultValue:null},{symbol:"Œ∏",name:"Transducer Angle",description:"Angle of acoustic path to pipe axis",unit:"rad",defaultValue:0.785},{symbol:"t_up",name:"Upstream Travel Time",description:"Travel time against flow",unit:"s",defaultValue:null},{symbol:"t_dn",name:"Downstream Travel Time",description:"Travel time with flow",unit:"s",defaultValue:null}], resultVariable:{symbol:"v",name:"Flow Velocity",unit:"m/s"} },

"electromagnetic flow meter emf": { cat:"Fluid Mechanics", standard:"OIML R 117", standardName:"Dynamic measuring systems for liquids", description:"Principle of electromagnetic flowmeter.", formula:"E_emf = B √ó D √ó v", variables:[{symbol:"B",name:"Magnetic Flux Density",description:"Applied magnetic field",unit:"T",defaultValue:null},{symbol:"D",name:"Pipe Diameter",description:"Internal diameter of flow tube",unit:"m",defaultValue:null},{symbol:"v",name:"Mean Flow Velocity",description:"Average velocity across diameter",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"E_emf",name:"Induced EMF",unit:"V"} },

"vortex shedding strouhal": { cat:"Fluid Mechanics", standard:"ISO 11769", standardName:"Vortex flowmeters", description:"Vortex shedding frequency from a bluff body (Strouhal number).", formula:"f_v = St √ó v / d", variables:[{symbol:"St",name:"Strouhal Number",description:"Typically ~0.2 for cylinders",unit:"dimensionless",defaultValue:0.2},{symbol:"v",name:"Flow Velocity",description:"Upstream velocity",unit:"m/s",defaultValue:null},{symbol:"d",name:"Bluff Body Width",description:"Width of vortex shedder",unit:"m",defaultValue:null}], resultVariable:{symbol:"f_v",name:"Vortex Shedding Frequency",unit:"Hz"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PLUMBING / WATER SERVICES ‚Äî BS EN 806
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"simultaneous demand loading unit": { cat:"Plumbing", standard:"BS EN 806-3 / BS 6700", standardName:"Specifications for installations inside buildings conveying water", description:"Design flow from loading units for plumbing design.", formula:"Q = K √ó ‚àö(Œ£ LU)", variables:[{symbol:"K",name:"Empirical Constant",description:"K = 0.2 for medium commercial installations",unit:"dimensionless",defaultValue:0.2},{symbol:"LU",name:"Sum of Loading Units",description:"Total loading units for all outlets served",unit:"LU",defaultValue:null}], resultVariable:{symbol:"Q",name:"Design Flow Rate",unit:"L/s"} },

"hot water storage volume": { cat:"Plumbing", standard:"BS EN 12897", standardName:"Water supply ‚Äî Specification for indirectly heated unvented (closed) storage water heaters", description:"Minimum hot water storage volume for a building.", formula:"V_hwc = N √ó q_person √ó t_peak", variables:[{symbol:"N",name:"Number of Persons",description:"Expected peak occupancy",unit:"persons",defaultValue:null},{symbol:"q_person",name:"Hot Water Demand per Person",description:"Typical 45‚Äì60 L/person/day",unit:"L/person",defaultValue:50},{symbol:"t_peak",name:"Peak Duration Fraction",description:"Proportion of daily demand in peak hour (0.25‚Äì0.35)",unit:"dimensionless",defaultValue:0.3}], resultVariable:{symbol:"V_hwc",name:"Storage Volume",unit:"L"} },

"dead leg temperature drop": { cat:"Plumbing", standard:"CIBSE TM13 / BS 8558", standardName:"Avoiding Legionella", description:"Temperature drop in a dead leg. Max 500mm and 2-min flush per HTM 04-01.", formula:"T_outlet = T_supply - (L √ó U_pipe √ó (T_supply - T_amb) / (·πÅ √ó cp))", variables:[{symbol:"T_supply",name:"Supply Temperature",description:"Hot water supply temperature",unit:"¬∞C",defaultValue:60},{symbol:"L",name:"Dead Leg Length",description:"Length of dead leg pipework",unit:"m",defaultValue:null},{symbol:"U_pipe",name:"Heat Loss per Metre",description:"From insulation calculation W/(m¬∑K)",unit:"W/(m¬∑K)",defaultValue:10},{symbol:"T_amb",name:"Ambient Temperature",description:"Surrounding temperature",unit:"¬∞C",defaultValue:20},{symbol:"·πÅ",name:"Mass Flow Rate",description:"Water flow rate",unit:"kg/s",defaultValue:0.1},{symbol:"cp",name:"Specific Heat",description:"Water 4186 J/(kg¬∑K)",unit:"J/(kg¬∑K)",defaultValue:4186}], resultVariable:{symbol:"T_outlet",name:"Outlet Temperature",unit:"¬∞C"} },

"legionella risk index temperature": { cat:"Plumbing", standard:"CIBSE TM13 / L8 ACOP", standardName:"Legionnaires' disease ‚Äî Approved Code of Practice", description:"Legionella growth risk classification by temperature.", formula:"Growth Zone: 20‚Äì45¬∞C (peak at ~37¬∞C); No risk: <20¬∞C or >60¬∞C", variables:[], resultVariable:{symbol:"Risk",name:"Risk Classification",unit:"qualitative"} },

"cistern fill time": { cat:"Plumbing", standard:"BS 1212", standardName:"Float operated valves", description:"Time to fill a cistern from empty.", formula:"t_fill = V_cistern / Q_fill", variables:[{symbol:"V_cistern",name:"Cistern Volume",description:"Volume of cistern",unit:"L",defaultValue:null},{symbol:"Q_fill",name:"Inlet Flow Rate",description:"Flow rate through ball valve",unit:"L/s",defaultValue:null}], resultVariable:{symbol:"t_fill",name:"Fill Time",unit:"s"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STRUCTURAL STEEL ‚Äî BS EN 1993 SPECIFIC
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"steel section class check": { cat:"Structural", standard:"BS EN 1993-1-1 Table 5.2", standardName:"Eurocode 3 ‚Äî Classification of cross-sections", description:"Flange outstand classification for I-section (Class 1 or 2).", formula:"c/t ‚â§ 9Œµ (Class 1); ‚â§ 10Œµ (Class 2); Œµ = ‚àö(235/fy)", variables:[{symbol:"c",name:"Flange Outstand",description:"c = (b-tw)/2 - r",unit:"mm",defaultValue:null},{symbol:"t",name:"Flange Thickness",description:"Flange thickness",unit:"mm",defaultValue:null},{symbol:"Œµ",name:"Material Factor",description:"Œµ = ‚àö(235/fy); fy=275MPa: Œµ=0.92",unit:"dimensionless",defaultValue:0.92}], resultVariable:{symbol:"c_t_ratio",name:"c/t Ratio",unit:"dimensionless"} },

"steel tension capacity": { cat:"Structural", standard:"BS EN 1993-1-1 Cl.6.2.3", standardName:"Eurocode 3", description:"Design tension resistance of a steel cross-section.", formula:"N_pl,Rd = A √ó fy / Œ≥_M0", variables:[{symbol:"A",name:"Cross-sectional Area",description:"Gross area of cross-section",unit:"m¬≤",defaultValue:null},{symbol:"fy",name:"Yield Strength",description:"Nominal yield strength (S275=275, S355=355 MPa)",unit:"Pa",defaultValue:275000000},{symbol:"Œ≥_M0",name:"Partial Factor",description:"Œ≥M0 = 1.0 per EC3",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"N_pl_Rd",name:"Plastic Tension Resistance",unit:"N"} },

"steel compression resistance": { cat:"Structural", standard:"BS EN 1993-1-1 Cl.6.2.4", standardName:"Eurocode 3", description:"Design compression resistance of a cross-section (stocky column).", formula:"N_c,Rd = A √ó fy / Œ≥_M0", variables:[{symbol:"A",name:"Cross-sectional Area",description:"Gross area (Class 1, 2, 3) or effective area (Class 4)",unit:"m¬≤",defaultValue:null},{symbol:"fy",name:"Yield Strength",description:"Nominal yield strength",unit:"Pa",defaultValue:275000000},{symbol:"Œ≥_M0",name:"Partial Factor",description:"Œ≥M0 = 1.0",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"N_c_Rd",name:"Compression Resistance",unit:"N"} },

"steel shear resistance": { cat:"Structural", standard:"BS EN 1993-1-1 Cl.6.2.6", standardName:"Eurocode 3", description:"Plastic shear resistance of a steel section.", formula:"V_pl,Rd = A_v √ó (fy/‚àö3) / Œ≥_M0", variables:[{symbol:"A_v",name:"Shear Area",description:"Shear area from EC3 (for I-section: h√ótw approx)",unit:"m¬≤",defaultValue:null},{symbol:"fy",name:"Yield Strength",description:"Nominal yield strength",unit:"Pa",defaultValue:275000000},{symbol:"Œ≥_M0",name:"Partial Factor",description:"1.0",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"V_pl_Rd",name:"Plastic Shear Resistance",unit:"N"} },

"steel moment resistance plastic": { cat:"Structural", standard:"BS EN 1993-1-1 Cl.6.2.5", standardName:"Eurocode 3", description:"Plastic bending resistance of a Class 1 or 2 steel section.", formula:"M_pl,Rd = W_pl √ó fy / Œ≥_M0", variables:[{symbol:"W_pl",name:"Plastic Section Modulus",description:"From section tables",unit:"m¬≥",defaultValue:null},{symbol:"fy",name:"Yield Strength",description:"Nominal yield strength",unit:"Pa",defaultValue:275000000},{symbol:"Œ≥_M0",name:"Partial Factor",description:"1.0",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"M_pl_Rd",name:"Plastic Moment Resistance",unit:"N¬∑m"} },

"column buckling resistance": { cat:"Structural", standard:"BS EN 1993-1-1 Cl.6.3.1", standardName:"Eurocode 3 ‚Äî Flexural buckling", description:"Flexural buckling resistance of a compression member.", formula:"N_b,Rd = œá √ó A √ó fy / Œ≥_M1", variables:[{symbol:"œá",name:"Buckling Reduction Factor",description:"From EC3 buckling curves based on ŒªÃÑ",unit:"dimensionless",defaultValue:null},{symbol:"A",name:"Cross-sectional Area",description:"Gross area",unit:"m¬≤",defaultValue:null},{symbol:"fy",name:"Yield Strength",description:"Nominal yield strength",unit:"Pa",defaultValue:275000000},{symbol:"Œ≥_M1",name:"Partial Factor",description:"Œ≥M1 = 1.0",unit:"dimensionless",defaultValue:1.0}], resultVariable:{symbol:"N_b_Rd",name:"Buckling Resistance",unit:"N"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MEASUREMENT / UNCERTAINTY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"measurement uncertainty type a": { cat:"Metrology", standard:"ISO/IEC Guide 98-3 (GUM)", standardName:"Evaluation of measurement data ‚Äî Guide to the expression of uncertainty", description:"Type A standard uncertainty from repeated measurements.", formula:"u_A = s / ‚àön", variables:[{symbol:"s",name:"Standard Deviation",description:"Sample standard deviation",unit:"(same as measurand)",defaultValue:null},{symbol:"n",name:"Number of Measurements",description:"Number of observations",unit:"dimensionless",defaultValue:null}], resultVariable:{symbol:"u_A",name:"Type A Uncertainty",unit:"(same as measurand)"} },

"combined uncertainty": { cat:"Metrology", standard:"ISO/IEC Guide 98-3 (GUM)", standardName:"Evaluation of measurement data", description:"Combined standard uncertainty from independent components.", formula:"u_c = ‚àö(u1¬≤ + u2¬≤ + u3¬≤)", variables:[{symbol:"u1",name:"Uncertainty Component 1",description:"Standard uncertainty from source 1",unit:"(same as measurand)",defaultValue:null},{symbol:"u2",name:"Uncertainty Component 2",description:"Standard uncertainty from source 2",unit:"(same as measurand)",defaultValue:null},{symbol:"u3",name:"Uncertainty Component 3",description:"Standard uncertainty from source 3 (0 if unused)",unit:"(same as measurand)",defaultValue:0}], resultVariable:{symbol:"u_c",name:"Combined Standard Uncertainty",unit:"(same as measurand)"} },

"expanded uncertainty": { cat:"Metrology", standard:"ISO/IEC Guide 98-3 (GUM)", standardName:"Evaluation of measurement data", description:"Expanded uncertainty at 95% confidence level.", formula:"U = k √ó u_c", variables:[{symbol:"k",name:"Coverage Factor",description:"k = 2 for 95% confidence (normal distribution)",unit:"dimensionless",defaultValue:2},{symbol:"u_c",name:"Combined Uncertainty",description:"Combined standard uncertainty",unit:"(same as measurand)",defaultValue:null}], resultVariable:{symbol:"U",name:"Expanded Uncertainty (95%)",unit:"(same as measurand)"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WATER TREATMENT / QUALITY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"chlorine dose contact time": { cat:"Water Treatment", standard:"DWI Guidance / WHO Guidelines", standardName:"Guidelines for Drinking Water Quality", description:"CT value for disinfection (Chick-Watson).", formula:"CT = C √ó t", variables:[{symbol:"C",name:"Disinfectant Concentration",description:"Free chlorine residual",unit:"mg/L",defaultValue:null},{symbol:"t",name:"Contact Time",description:"Contact time at concentration C",unit:"min",defaultValue:null}], resultVariable:{symbol:"CT",name:"CT Value",unit:"mg¬∑min/L"} },

"bod removal activated sludge": { cat:"Water Treatment", standard:"BS EN 12255-1", standardName:"Wastewater treatment plants", description:"BOD removal efficiency in activated sludge system.", formula:"E = (BOD_in - BOD_out) / BOD_in √ó 100", variables:[{symbol:"BOD_in",name:"Influent BOD",description:"Incoming BOD concentration",unit:"mg/L",defaultValue:null},{symbol:"BOD_out",name:"Effluent BOD",description:"Treated effluent BOD",unit:"mg/L",defaultValue:null}], resultVariable:{symbol:"E",name:"BOD Removal Efficiency",unit:"%"} },

"sludge volume index": { cat:"Water Treatment", standard:"BS EN 14702-1", standardName:"Characterisation of sludges", description:"Sludge volume index ‚Äî indicates settling characteristics.", formula:"SVI = (V_30 √ó 1000) / MLSS", variables:[{symbol:"V_30",name:"30-min Settled Volume",description:"Settled sludge volume after 30 min (mL/L)",unit:"mL/L",defaultValue:null},{symbol:"MLSS",name:"Mixed Liquor Suspended Solids",description:"Concentration of MLSS",unit:"mg/L",defaultValue:null}], resultVariable:{symbol:"SVI",name:"Sludge Volume Index",unit:"mL/g"} },

"filter backwash velocity": { cat:"Water Treatment", standard:"BS EN 12904", standardName:"Products used for treatment of water intended for human consumption ‚Äî Sand and gravel", description:"Backwash velocity for granular filter media.", formula:"v_bw = 3 √ó v_min_fluidisation", variables:[{symbol:"v_min_fluidisation",name:"Minimum Fluidisation Velocity",description:"Velocity at which bed just fluidises",unit:"m/s",defaultValue:null}], resultVariable:{symbol:"v_bw",name:"Recommended Backwash Velocity",unit:"m/s"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONTROL / INSTRUMENTATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"pid controller output": { cat:"Control & Instrumentation", standard:"IEC 61511", standardName:"Functional safety ‚Äî Safety instrumented systems", description:"PID controller output equation.", formula:"u(t) = Kp √ó [e(t) + (1/Ti)√ó‚à´e dt + Td √ó de/dt]", variables:[{symbol:"Kp",name:"Proportional Gain",description:"Controller gain",unit:"dimensionless",defaultValue:null},{symbol:"e",name:"Error",description:"Setpoint minus process variable",unit:"(process units)",defaultValue:null},{symbol:"Ti",name:"Integral Time",description:"Reset time",unit:"s",defaultValue:null},{symbol:"Td",name:"Derivative Time",description:"Rate time",unit:"s",defaultValue:null}], resultVariable:{symbol:"u",name:"Controller Output",unit:"(control signal)"} },

"thermocouple emf type k": { cat:"Control & Instrumentation", standard:"IEC 60584-1", standardName:"Thermocouples ‚Äî Reference tables", description:"Approximate EMF output of Type K thermocouple.", formula:"E ‚âà 41.276 √ó T (ŒºV)", variables:[{symbol:"T",name:"Temperature",description:"Temperature relative to 0¬∞C cold junction",unit:"¬∞C",defaultValue:null}], resultVariable:{symbol:"E",name:"Thermocouple EMF",unit:"ŒºV"} },

"signal 4 20ma transmitter": { cat:"Control & Instrumentation", standard:"IEC 60381-1", standardName:"Analogue signals for process control systems", description:"Calculation of process value from 4‚Äì20 mA signal.", formula:"PV = (I - 4) / 16 √ó (PV_max - PV_min) + PV_min", variables:[{symbol:"I",name:"Loop Current",description:"Measured 4‚Äì20 mA signal",unit:"mA",defaultValue:null},{symbol:"PV_min",name:"Minimum Process Value",description:"Value at 4 mA",unit:"(process units)",defaultValue:null},{symbol:"PV_max",name:"Maximum Process Value",description:"Value at 20 mA",unit:"(process units)",defaultValue:null}], resultVariable:{symbol:"PV",name:"Process Variable",unit:"(process units)"} },

"safety integrity level probability": { cat:"Control & Instrumentation", standard:"IEC 61511", standardName:"Functional safety ‚Äî Safety instrumented systems", description:"Average Probability of Failure on Demand (PFDavg) for SIL classification.", formula:"PFDavg = Œª_D √ó TI / 2", variables:[{symbol:"Œª_D",name:"Dangerous Failure Rate",description:"Rate of dangerous failures",unit:"failures/hr",defaultValue:null},{symbol:"TI",name:"Test Interval",description:"Proof test interval",unit:"hr",defaultValue:8760}], resultVariable:{symbol:"PFDavg",name:"Average PFD",unit:"dimensionless"} },

"orifice beta ratio": { cat:"Control & Instrumentation", standard:"ISO 5167-2", standardName:"Orifice plates", description:"Beta ratio of an orifice plate.", formula:"Œ≤ = d / D", variables:[{symbol:"d",name:"Orifice Bore",description:"Orifice diameter",unit:"m",defaultValue:null},{symbol:"D",name:"Pipe Bore",description:"Pipe internal diameter",unit:"m",defaultValue:null}], resultVariable:{symbol:"Œ≤",name:"Beta Ratio",unit:"dimensionless"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TRANSPORT / TRAFFIC
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"stopping distance vehicle": { cat:"Transport", standard:"DMRB TD 9/93", standardName:"Highway Link Design", description:"Total stopping distance ‚Äî perception-reaction plus braking.", formula:"SD = v √ó t_r + v¬≤ / (2 √ó a)", variables:[{symbol:"v",name:"Vehicle Speed",description:"Initial speed",unit:"m/s",defaultValue:null},{symbol:"t_r",name:"Reaction Time",description:"Typically 2.0 s for design",unit:"s",defaultValue:2.0},{symbol:"a",name:"Deceleration Rate",description:"Typically 3.4 m/s¬≤ design standard",unit:"m/s¬≤",defaultValue:3.4}], resultVariable:{symbol:"SD",name:"Stopping Distance",unit:"m"} },

"road capacity lane": { cat:"Transport", standard:"DMRB TA 79/99", standardName:"Traffic appraisal of road schemes", description:"Theoretical capacity of a single highway lane.", formula:"q = k √ó v_space", variables:[{symbol:"k",name:"Traffic Density",description:"Vehicles per km",unit:"veh/km",defaultValue:null},{symbol:"v_space",name:"Space Mean Speed",description:"Speed averaged over distance",unit:"km/hr",defaultValue:null}], resultVariable:{symbol:"q",name:"Flow Rate",unit:"veh/hr"} },

"pavement design thickness": { cat:"Transport", standard:"HD 26/06 / Highways England", standardName:"Pavement Design", description:"Equivalent standard axles for pavement design.", formula:"ESAL = Œ£ (GVW_i / 80)^4 √ó N_i", variables:[{symbol:"GVW",name:"Gross Vehicle Weight",description:"Actual vehicle weight",unit:"kN",defaultValue:null},{symbol:"N_i",name:"Number of Passes",description:"Number of vehicle passes",unit:"passes",defaultValue:null}], resultVariable:{symbol:"ESAL",name:"Equivalent Standard Axle Loads",unit:"ESAL"} },

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MISCELLANEOUS ENGINEERING
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

"corrosion rate uniform": { cat:"Materials", standard:"ASTM G1", standardName:"Cleaning, degreasing, and electrolytic cleaning of specimens", description:"Uniform corrosion rate from weight loss coupon test.", formula:"CR = 87600 √ó W / (A √ó t √ó œÅ)", variables:[{symbol:"W",name:"Weight Loss",description:"Mass loss of coupon",unit:"mg",defaultValue:null},{symbol:"A",name:"Coupon Area",description:"Exposed surface area",unit:"cm¬≤",defaultValue:null},{symbol:"t",name:"Exposure Time",description:"Duration of test",unit:"hr",defaultValue:null},{symbol:"œÅ",name:"Material Density",description:"Density of test material",unit:"g/cm¬≥",defaultValue:7.85}], resultVariable:{symbol:"CR",name:"Corrosion Rate",unit:"mm/year"} },

"cathodic protection current density": { cat:"Materials", standard:"BS EN 12954", standardName:"Cathodic protection of buried metallic structures", description:"Required current density for cathodic protection of buried steel.", formula:"i_p = i_0 √ó exp(-k √ó E_p)", variables:[{symbol:"i_0",name:"Exchange Current Density",description:"Exchange current density for steel",unit:"A/m¬≤",defaultValue:0.01},{symbol:"k",name:"Tafel Constant",description:"Tafel constant",unit:"1/V",defaultValue:20},{symbol:"E_p",name:"Protection Potential",description:"Applied protection potential",unit:"V",defaultValue:-0.85}], resultVariable:{symbol:"i_p",name:"Protection Current Density",unit:"A/m¬≤"} },

"sieve analysis cumulative": { cat:"Geotechnical", standard:"BS EN ISO 17892-4", standardName:"Geotechnical investigation ‚Äî Particle-size analysis", description:"Percentage passing a given sieve size.", formula:"P = (M_passing / M_total) √ó 100", variables:[{symbol:"M_passing",name:"Mass Passing Sieve",description:"Cumulative mass passing this sieve",unit:"g",defaultValue:null},{symbol:"M_total",name:"Total Dry Mass",description:"Total dry mass of sample",unit:"g",defaultValue:null}], resultVariable:{symbol:"P",name:"Percentage Passing",unit:"%"} },

"concrete mix proportions": { cat:"Concrete", standard:"BS EN 206 / BRE Method", standardName:"Concrete ‚Äî Specification, performance, production and conformity", description:"Free water content for target workability.", formula:"W = W_nominal √ó (0.85 + 0.15 √ó (S_3 - S_1) / 100)", variables:[{symbol:"W_nominal",name:"Nominal Free Water Content",description:"From BRE Table 3 for aggregate type and target slump",unit:"kg/m¬≥",defaultValue:210},{symbol:"S_3",name:"Target Slump",description:"Design slump (mm)",unit:"mm",defaultValue:null},{symbol:"S_1",name:"Reference Slump",description:"Reference slump (75 mm)",unit:"mm",defaultValue:75}], resultVariable:{symbol:"W",name:"Free Water Content",unit:"kg/m¬≥"} },

"cable tray load capacity": { cat:"Electrical", standard:"BS EN 61537", standardName:"Cable management ‚Äî Cable tray systems and cable ladder systems", description:"Maximum load-carrying capacity of a cable tray span.", formula:"L_max = 8 √ó M_Rd / (q √ó Ls¬≤)", variables:[{symbol:"M_Rd",name:"Tray Moment Resistance",description:"Bending moment capacity from manufacturer",unit:"N¬∑m",defaultValue:null},{symbol:"q",name:"Cable Load",description:"Total distributed cable load per unit length",unit:"N/m",defaultValue:null},{symbol:"Ls",name:"Tray Span",description:"Distance between supports",unit:"m",defaultValue:null}], resultVariable:{symbol:"L_max",name:"Maximum Allowable Load",unit:"N/m"} },

"containment bund volume": { cat:"Environmental", standard:"CIRIA C736 / EA PPG2", standardName:"Bunding and secondary containment", description:"Minimum bund volume for secondary containment.", formula:"V_bund = 110% √ó V_largest_tank", variables:[{symbol:"V_largest",name:"Largest Tank Volume",description:"Volume of the single largest storage vessel",unit:"m¬≥",defaultValue:null}], resultVariable:{symbol:"V_bund",name:"Minimum Bund Volume",unit:"m¬≥"} },

"chimney draught": { cat:"Gas Engineering", standard:"BS EN 1443", standardName:"Chimneys ‚Äî General requirements", description:"Natural draught created by a chimney due to temperature difference.", formula:"ŒîP_draught = œÅ_air √ó g √ó H √ó (1 - T_air/T_flue)", variables:[{symbol:"œÅ_air",name:"Ambient Air Density",description:"Density of external air",unit:"kg/m¬≥",defaultValue:1.2},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81},{symbol:"H",name:"Chimney Height",description:"Height of chimney above appliance",unit:"m",defaultValue:null},{symbol:"T_air",name:"Ambient Temperature",description:"Absolute ambient temperature",unit:"K",defaultValue:293},{symbol:"T_flue",name:"Flue Gas Temperature",description:"Absolute flue gas temperature",unit:"K",defaultValue:null}], resultVariable:{symbol:"ŒîP_draught",name:"Chimney Draught",unit:"Pa"} },

"tank emptying time": { cat:"Fluid Mechanics", standard:"ISO 80000-4", standardName:"Mechanics", description:"Time to empty a tank through an orifice at the base (Torricelli).", formula:"t = (2 √ó A_tank / (Cd √ó A_orifice)) √ó (‚àöh_initial - ‚àöh_final) / ‚àö(2g)", variables:[{symbol:"A_tank",name:"Tank Cross-section Area",description:"Plan area of tank",unit:"m¬≤",defaultValue:null},{symbol:"Cd",name:"Discharge Coefficient",description:"Typically 0.6 for sharp-edged orifice",unit:"dimensionless",defaultValue:0.6},{symbol:"A_orifice",name:"Orifice Area",description:"Cross-sectional area of outlet",unit:"m¬≤",defaultValue:null},{symbol:"h_initial",name:"Initial Head",description:"Initial water depth above orifice centreline",unit:"m",defaultValue:null},{symbol:"h_final",name:"Final Head",description:"Final water depth (0 if completely empty)",unit:"m",defaultValue:0},{symbol:"g",name:"Gravitational Acceleration",description:"9.81 m/s¬≤",unit:"m/s¬≤",defaultValue:9.81}], resultVariable:{symbol:"t",name:"Emptying Time",unit:"s"} },

}; // end FORMULA_DB_EXTRA

// Merge into main database at runtime
if (typeof FORMULA_DB !== 'undefined') {
    Object.assign(FORMULA_DB, FORMULA_DB_EXTRA);
}

// Now compute after full merge
const CATEGORIES = [...new Set(Object.values(FORMULA_DB).map(f => f.cat))].sort();
const FORMULA_COUNT = Object.keys(FORMULA_DB).length;

// ‚îÄ‚îÄ State ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let aiCfg = { mode:null, apiKey:null, localModel:null, ready:false };
let webllmEngine = null;
let currentCalc  = null;
let selectedMode = null;

// ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
document.addEventListener('DOMContentLoaded', function() {
    const saved = localStorage.getItem('secalc_ai');
    if (saved) { try { aiCfg = JSON.parse(saved); } catch(e){} updateBadge(); }
    const qi = document.getElementById('queryInput');
    if (qi) qi.addEventListener('keypress', e => { if(e.key==='Enter') searchFormula(); });
});

// ‚îÄ‚îÄ Badge ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateBadge() {
    const badge = document.getElementById('aiBadge');
    const text  = document.getElementById('aiStatusText');
    const btn   = document.getElementById('aiActionBtn');
    if (!aiCfg.mode) {
        badge.className='ai-badge offline'; text.textContent='AI: Not Connected';
        btn.textContent='Connect AI'; btn.className='hdr-btn connect'; btn.onclick=openModal;
    } else if (aiCfg.mode==='local') {
        badge.className = aiCfg.ready ? 'ai-badge local' : 'ai-badge loading';
        text.textContent = aiCfg.ready ? `Local AI: ${aiCfg.localModel.split('-').slice(0,2).join(' ')}` : 'Local AI: Loading‚Ä¶';
        btn.textContent='Disconnect'; btn.className='hdr-btn disconnect'; btn.onclick=disconnectAI;
    } else {
        badge.className='ai-badge online'; text.textContent=`AI: ${aiCfg.mode.toUpperCase()}`;
        btn.textContent='Disconnect'; btn.className='hdr-btn disconnect'; btn.onclick=disconnectAI;
    }
}

// ‚îÄ‚îÄ Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openModal() {
    selectedMode=null;
    document.querySelectorAll('.provider-card').forEach(c=>c.classList.remove('selected'));
    document.getElementById('localModelSection').style.display='none';
    document.getElementById('cloudKeySection').style.display='none';
    document.getElementById('apiKeyInput').value='';
    document.getElementById('aiModal').classList.add('show');
}
function closeModal() { document.getElementById('aiModal').classList.remove('show'); }

function selectProvider(card) {
    document.querySelectorAll('.provider-card').forEach(c=>c.classList.remove('selected'));
    card.classList.add('selected');
    selectedMode = card.dataset.mode;
    document.getElementById('localModelSection').style.display = selectedMode==='local' ? 'block' : 'none';
    document.getElementById('cloudKeySection').style.display   = selectedMode!=='local' ? 'block' : 'none';
    if (selectedMode!=='local') {
        const labels = {anthropic:'Anthropic API Key', openai:'OpenAI API Key', groq:'Groq API Key'};
        document.getElementById('keyLabel').textContent = labels[selectedMode] || 'API Key';
    }
}

async function connectAI() {
    if (!selectedMode) { showToast('Please select a provider', false); return; }
    if (selectedMode==='local') {
        aiCfg = { mode:'local', localModel:document.getElementById('localModelSelect').value, apiKey:null, ready:false };
        localStorage.setItem('secalc_ai', JSON.stringify(aiCfg));
        closeModal(); updateBadge();
        await loadLocalModel();
    } else {
        const key = document.getElementById('apiKeyInput').value.trim();
        if (!key) { showToast('Please enter your API key', false); return; }
        aiCfg = { mode:selectedMode, apiKey:key, localModel:null, ready:true };
        localStorage.setItem('secalc_ai', JSON.stringify(aiCfg));
        closeModal(); updateBadge();
        showToast(`Connected to ${selectedMode.toUpperCase()}!`);
    }
}

function disconnectAI() {
    aiCfg={ mode:null, apiKey:null, localModel:null, ready:false };
    localStorage.removeItem('secalc_ai');
    webllmEngine=null; selectedMode=null;
    updateBadge(); showToast('AI disconnected');
}

// ‚îÄ‚îÄ Local Model (WebLLM) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadLocalModel() {
    const progress = document.getElementById('localProgress');
    const fill     = document.getElementById('progressFill');
    const label    = document.getElementById('progressLabel');
    progress.style.display='block'; updateBadge();

    try {
        label.textContent='Loading WebLLM library‚Ä¶';

        // Dynamically import WebLLM as ES module
        const webllm = await import('https://esm.run/@mlc-ai/web-llm');

        label.textContent=`Downloading ${aiCfg.localModel}‚Ä¶`;
        fill.style.width='5%';

        webllmEngine = await webllm.CreateMLCEngine(aiCfg.localModel, {
            initProgressCallback: (p) => {
                const pct = Math.round((p.progress||0)*100);
                fill.style.width = Math.max(5, pct)+'%';
                label.textContent = p.text || `${pct}% downloaded‚Ä¶`;
            }
        });

        aiCfg.ready=true;
        localStorage.setItem('secalc_ai', JSON.stringify(aiCfg));
        progress.style.display='none';
        updateBadge();
        showToast('Local AI ready ‚Äî fully private, runs on your device!');

    } catch(err) {
        progress.style.display='none';
        aiCfg={ mode:null, apiKey:null, localModel:null, ready:false };
        localStorage.removeItem('secalc_ai');
        updateBadge();
        showToast('Local AI failed: ' + err.message + ' ‚Äî Try Chrome/Edge 113+ with WebGPU enabled', false);
    }
}

// ‚îÄ‚îÄ AI Caller ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function callAI(prompt) {
    if (!aiCfg.mode || !aiCfg.ready) throw new Error('No AI connected');

    if (aiCfg.mode==='local') {
        if (!webllmEngine) throw new Error('Local model not loaded ‚Äî please reconnect');
        const r = await webllmEngine.chat.completions.create({
            messages:[
                {role:'system',content:'You are an expert mechanical and structural engineer. Always respond with valid JSON only, no markdown, no extra text.'},
                {role:'user',  content:prompt}
            ],
            temperature:0.1, max_tokens:1500
        });
        return r.choices[0].message.content;
    }

    let url, headers, payload;
    if (aiCfg.mode==='anthropic') {
        url='https://api.anthropic.com/v1/messages';
        headers={'Content-Type':'application/json','x-api-key':aiCfg.apiKey,'anthropic-version':'2023-06-01'};
        payload={model:'claude-sonnet-4-20250514',max_tokens:1500,
            messages:[{role:'user',content:prompt}]};
    } else if (aiCfg.mode==='openai') {
        url='https://api.openai.com/v1/chat/completions';
        headers={'Content-Type':'application/json','Authorization':'Bearer '+aiCfg.apiKey};
        payload={model:'gpt-4o',response_format:{type:'json_object'},
            messages:[{role:'system',content:'Expert engineer. JSON only.'},{role:'user',content:prompt}]};
    } else {
        url='https://api.groq.com/openai/v1/chat/completions';
        headers={'Content-Type':'application/json','Authorization':'Bearer '+aiCfg.apiKey};
        payload={model:'llama-3.1-70b-versatile',response_format:{type:'json_object'},
            messages:[{role:'system',content:'Expert engineer. JSON only.'},{role:'user',content:prompt}]};
    }

    const res = await fetch(url,{method:'POST',headers,body:JSON.stringify(payload)});
    if (!res.ok) { const e=await res.json().catch(()=>({})); throw new Error(e.error?.message||`HTTP ${res.status}`); }
    const data = await res.json();
    return aiCfg.mode==='anthropic' ? data.content[0].text : data.choices[0].message.content;
}

function parseJSON(raw) {
    const m = raw.match(/\{[\s\S]*\}/);
    if (!m) throw new Error('No JSON in AI response');
    return JSON.parse(m[0]);
}



// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INTENT MAP ‚Äî maps natural language queries to formula workflows
// Each entry: { keys: [formula keys to chain], description, note }
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const INTENT_MAP = [
    // PIPE / BEAM DEFLECTION
    { patterns: ['deflection of a pipe','pipe deflection','pipe sag','pipe bending','pipe span','pipe support spacing','pipe sagging between supports'],
      keys: ['beam deflection udl simply supported','second moment hollow circle','pipe internal area'],
      title: 'Pipe Deflection Between Supports',
      note: 'For a pipe spanning between supports under its own weight and contents. Step 1 calculates the pipe cross-section geometry (I), Step 2 calculates the weight loading (w), Step 3 calculates the mid-span deflection.' },

    { patterns: ['pipe deflection point load','pipe deflection concentrated'],
      keys: ['beam deflection point load midspan','second moment hollow circle'],
      title: 'Pipe Deflection Under Point Load',
      note: 'Deflection of a pipe span under a concentrated (point) load at mid-span.' },

    // PIPE SIZING / FLOW
    { patterns: ['pipe sizing','size a pipe','pipe diameter','what diameter pipe','select pipe size','pipe selection'],
      keys: ['pressure drop darcy weisbach','reynolds number','pipe internal area','pipe velocity from flow'],
      title: 'Pipe Sizing Workflow',
      note: 'Full pipe sizing: calculate required area from velocity, check Reynolds number, then verify pressure drop. Aim for velocity 1‚Äì3 m/s water, Re > 4000 turbulent.' },

    { patterns: ['pressure drop pipe','pipe pressure loss','friction loss pipe','pipe head loss'],
      keys: ['pressure drop darcy weisbach','swamee jain friction factor','reynolds number'],
      title: 'Pipe Pressure Drop Calculation',
      note: 'Step 1: Calculate Reynolds number. Step 2: Get friction factor. Step 3: Calculate pressure drop using Darcy-Weisbach.' },

    { patterns: ['flow rate pipe','water flow','pipe flow rate','flow in pipe'],
      keys: ['flow rate pipe continuity','reynolds number','pipe velocity from flow'],
      title: 'Pipe Flow Rate',
      note: 'Calculate flow rate from pipe geometry and velocity, then verify flow regime with Reynolds number.' },

    // HEAT TRANSFER
    { patterns: ['heat loss pipe','pipe heat loss','insulated pipe heat loss','pipe insulation'],
      keys: ['heat loss pipe insulated','pipe thermal expansion'],
      title: 'Insulated Pipe Heat Loss',
      note: 'Heat loss per metre from an insulated pipe, with thermal expansion check for the operating temperature range.' },

    { patterns: ['heat exchanger design','heat exchanger area','size a heat exchanger','heat exchanger sizing'],
      keys: ['heat exchanger duty','log mean temperature difference','heat exchanger area required'],
      title: 'Heat Exchanger Sizing',
      note: 'Step 1: Calculate LMTD. Step 2: Determine required duty. Step 3: Calculate required surface area A = Q / (U √ó LMTD).' },

    { patterns: ['u value','u-value','thermal transmittance','building fabric heat loss'],
      keys: ['u value calculation','overall heat transfer coefficient'],
      title: 'U-value / Thermal Transmittance',
      note: 'Calculate the overall thermal transmittance (U-value) for a wall, roof, or floor build-up. Sum L/k for each layer.' },

    { patterns: ['heat conduction wall','conduction through wall','wall heat loss'],
      keys: ['heat conduction fourier','thermal resistance wall','overall heat transfer coefficient'],
      title: 'Wall Heat Conduction',
      note: 'Fourier\'s law for conduction. Calculate resistance for each layer then overall U-value.' },

    // PUMP SELECTION
    { patterns: ['pump selection','select a pump','pump sizing','pump design','pump head','pump power','pump efficiency'],
      keys: ['pump head','pump power','pump efficiency','affinity law flow speed','net positive suction head'],
      title: 'Pump Selection Workflow',
      note: 'Step 1: Calculate required total head. Step 2: Calculate hydraulic power. Step 3: Check NPSHa > NPSHr. Step 4: Affinity laws if speed-controlled.' },

    { patterns: ['pump affinity','vsd pump','variable speed pump','pump speed change'],
      keys: ['affinity law flow speed','affinity law head speed','affinity law power speed'],
      title: 'Pump Affinity Laws (VSD)',
      note: 'All three affinity laws for speed change. Power saves as cube of speed ratio ‚Äî critical for VSD energy savings.' },

    // STRUCTURAL BEAM
    { patterns: ['beam design','steel beam','beam sizing','beam selection','ub section','uc section'],
      keys: ['bending moment simply supported udl','beam bending stress','beam deflection udl simply supported','steel moment resistance plastic'],
      title: 'Steel Beam Design Workflow',
      note: 'Step 1: Calculate design moment. Step 2: Check bending stress. Step 3: Verify deflection ‚â§ L/360 (AISC) or L/250 (BS EN). Step 4: Check moment resistance.' },

    { patterns: ['beam bending','bending stress beam','moment capacity beam'],
      keys: ['bending moment simply supported udl','beam bending stress','section modulus elastic'],
      title: 'Beam Bending Stress',
      note: 'Full bending stress check: moment ‚Üí section modulus ‚Üí stress.' },

    { patterns: ['cantilever','cantilever beam','cantilever deflection','cantilever moment'],
      keys: ['bending moment cantilever udl','beam shear stress','beam deflection udl simply supported'],
      title: 'Cantilever Beam',
      note: 'Maximum moment at fixed support, shear at support. Deflection formula differs from SS beam ‚Äî use specific cantilever formula.' },

    { patterns: ['column buckling','column design','strut buckling','euler buckling','slender column'],
      keys: ['euler buckling load','slenderness ratio','radius of gyration','column buckling resistance'],
      title: 'Column Buckling Design',
      note: 'Step 1: Calculate radius of gyration. Step 2: Slenderness ratio. Step 3: Euler critical load. Step 4: EC3/AISC buckling resistance with reduction factor.' },

    // PRESSURE VESSEL
    { patterns: ['pressure vessel thickness','vessel wall thickness','pressure vessel design','vessel shell thickness'],
      keys: ['vessel required thickness asme','vessel hoop stress barlow','vessel longitudinal stress'],
      title: 'Pressure Vessel Shell Design',
      note: 'ASME VIII Div.1 UG-27. Step 1: Required thickness. Step 2: Verify hoop stress < allowable. Step 3: Check longitudinal stress.' },

    { patterns: ['hoop stress','circumferential stress','pressure vessel stress','thin wall vessel'],
      keys: ['vessel hoop stress barlow','vessel longitudinal stress','direct stress'],
      title: 'Thin-Wall Pressure Vessel Stresses',
      note: 'Biaxial stress state: hoop stress = 2√ó longitudinal stress for closed-ended cylinders.' },

    // HVAC
    { patterns: ['cooling load','heat gain room','sensible heat gain','room cooling','air conditioning load'],
      keys: ['hvac sensible cooling load','hvac supply air flow rate','hvac room air changes','hvac outside air requirement'],
      title: 'Room Cooling Load & Air Flow',
      note: 'Step 1: Sensible cooling load. Step 2: Required supply air flow. Step 3: Check air changes per hour. Step 4: Minimum outside air.' },

    { patterns: ['duct sizing','duct design','ductwork','duct velocity','duct pressure drop'],
      keys: ['hvac duct velocity','hvac duct pressure loss','hvac duct equivalent diameter','rectangular duct hydraulic diameter'],
      title: 'Ductwork Sizing',
      note: 'Step 1: Hydraulic diameter for rectangular duct. Step 2: Check velocity (5‚Äì8 m/s typical supply). Step 3: Calculate pressure drop (aim 1 Pa/m).' },

    { patterns: ['boiler sizing','boiler output','boiler design','heating load'],
      keys: ['boiler heat output','specific heat sensible heat','hvac supply air flow rate'],
      title: 'Boiler / Heating Load',
      note: 'Calculate heat output required, then size boiler using flow/return temperatures and water flow rate.' },

    // ELECTRICAL
    { patterns: ['cable sizing','cable selection','cable size','select cable','cable rating'],
      keys: ['cable ampacity derating','cable voltage drop','protective conductor size','cable resistance ac'],
      title: 'Cable Sizing Workflow',
      note: 'Step 1: Derated current capacity (grouping, temperature). Step 2: Voltage drop check (‚â§3% lighting, ‚â§5% power per BS 7671). Step 3: Protective conductor size.' },

    { patterns: ['voltage drop cable','cable volt drop'],
      keys: ['cable voltage drop','cable ampacity derating','ohms law voltage'],
      title: 'Cable Voltage Drop',
      note: 'BS 7671 voltage drop. For 3-phase multiply result by ‚àö3.' },

    { patterns: ['motor power','motor sizing','electric motor','motor torque','motor efficiency'],
      keys: ['motor shaft power','motor efficiency','synchronous speed motor','motor slip'],
      title: 'Electric Motor',
      note: 'Shaft power, efficiency, and synchronous speed for induction motor selection.' },

    { patterns: ['power factor correction','reactive power','capacitor bank','pf correction'],
      keys: ['reactive power correction','apparent power','power factor','3 phase power'],
      title: 'Power Factor Correction',
      note: 'Step 1: Calculate existing apparent power and PF. Step 2: Calculate required kVAr to reach target PF.' },

    { patterns: ['3 phase power','three phase power','three-phase','three phase load'],
      keys: ['3 phase power','apparent power','power factor','ohms law current'],
      title: 'Three-Phase Power',
      note: 'Active, apparent, and reactive power for balanced three-phase system.' },

    // GEOTECHNICAL
    { patterns: ['foundation bearing','bearing capacity','shallow foundation','pad foundation','strip foundation'],
      keys: ['bearing capacity terzaghi','retaining wall overturning check','foundation settlement elastic'],
      title: 'Foundation Bearing Capacity',
      note: 'Terzaghi bearing capacity with overturning stability check and elastic settlement estimate.' },

    { patterns: ['retaining wall','earth pressure','wall design','cantilever wall'],
      keys: ['active earth pressure rankine','passive earth pressure rankine','retaining wall overturning check','at rest pressure coefficient'],
      title: 'Retaining Wall Earth Pressure',
      note: 'Active and passive Rankine pressures, Ka/Kp coefficients, and overturning stability check.' },

    { patterns: ['pile capacity','pile design','pile bearing','pile foundation'],
      keys: ['pile capacity end bearing','pile skin friction','pile total capacity'],
      title: 'Pile Foundation Capacity',
      note: 'Total pile resistance = end bearing + shaft friction. Apply EC7 partial factors to get design resistance.' },

    { patterns: ['consolidation settlement','clay settlement','primary consolidation','soil settlement'],
      keys: ['settlement consolidation','degree of consolidation','consolidation coefficient cv'],
      title: 'Consolidation Settlement',
      note: 'Step 1: Ultimate settlement. Step 2: Cv from oedometer. Step 3: Time for % consolidation.' },

    // DRAINAGE
    { patterns: ['drain sizing','sewer sizing','drainage pipe','gravity drain','foul sewer'],
      keys: ['manning velocity','sewer design capacity','pipe gradient self-cleansing'],
      title: 'Gravity Drain / Sewer Sizing',
      note: 'Manning\'s equation for velocity, 75% full capacity, and minimum self-cleansing gradient check.' },

    { patterns: ['stormwater','storm drain','surface water','runoff','rainfall runoff'],
      keys: ['stormwater runoff rational method','roof drainage area','sustainable drainage attenuation'],
      title: 'Stormwater Runoff & Drainage',
      note: 'Rational method for peak flow, roof drainage design, and SUDS attenuation volume.' },

    // ENERGY
    { patterns: ['pv solar','solar panel','photovoltaic','solar energy output','pv yield','solar generation'],
      keys: ['pv panel power output','photovoltaic annual yield','solar irradiance on tilted surface'],
      title: 'Photovoltaic System',
      note: 'Panel output at given conditions, annual yield estimate, and tilted surface irradiance.' },

    { patterns: ['wind turbine','wind energy','wind power','wind generator'],
      keys: ['wind turbine power','energy intensity'],
      title: 'Wind Turbine Power',
      note: 'Betz limit power equation. Practical Cp 0.35‚Äì0.45. Rotor area = œÄ √ó radius¬≤.' },

    { patterns: ['carbon emissions','co2 emissions','carbon footprint','operational carbon'],
      keys: ['operational carbon annual','embodied carbon material','carbon emissions energy'],
      title: 'Carbon Emissions',
      note: 'Operational carbon from energy use, plus embodied carbon from materials.' },

    { patterns: ['payback period','investment payback','roi energy','energy saving payback'],
      keys: ['payback period simple','net present value','whole life cost'],
      title: 'Energy Investment Appraisal',
      note: 'Simple payback, NPV, and whole life cost for energy efficiency measures.' },

    // ACOUSTICS
    { patterns: ['reverberation time','rt60','room acoustics','acoustic design'],
      keys: ['room reverberation time sabine','room reverberation eyring','noise level combination'],
      title: 'Room Acoustics',
      note: 'Sabine formula for rooms with low absorption; Eyring for higher absorption. Target RT60 depends on room use.' },

    { patterns: ['noise attenuation','noise barrier','sound barrier','noise level distance'],
      keys: ['noise attenuation distance','noise barrier insertion loss','sound pressure level'],
      title: 'Noise Attenuation',
      note: 'Inverse square law attenuation with distance, plus barrier insertion loss.' },

    // GAS
    { patterns: ['gas pipe sizing','natural gas pipe','gas distribution pipe','gas pipework'],
      keys: ['gas pipe sizing','gas pipe pressure drop low pressure','gas calorific value'],
      title: 'Gas Pipe Sizing',
      note: 'Sizing and pressure drop for natural gas distribution pipework.' },

    { patterns: ['steam system','steam pipe','steam flow','steam condensate'],
      keys: ['steam flow enthalpy','latent heat phase change','mass flow rate'],
      title: 'Steam System',
      note: 'Steam flow calculations using enthalpy and latent heat from steam tables.' },

    // FIRE
    { patterns: ['sprinkler system','fire sprinkler','automatic sprinkler'],
      keys: ['sprinkler system flow','sprinkler area of coverage','sprinkler system demand pressure','fire water storage tank'],
      title: 'Sprinkler System Design',
      note: 'BS EN 12845 / NFPA 13 sprinkler flow from K-factor, coverage area, demand pressure, and tank sizing.' },

    // COMBINED STRESS
    { patterns: ['combined stress','stress analysis','von mises','equivalent stress','biaxial stress'],
      keys: ['combined stress von mises','direct stress','beam bending stress','torsional shear stress solid shaft'],
      title: 'Combined Stress Analysis',
      note: 'Von Mises equivalent stress for combined axial, bending, and torsional loading.' },

    // FATIGUE
    { patterns: ['fatigue','fatigue life','cyclic loading','s-n curve','fatigue check'],
      keys: ['fatigue life basquin','fatigue crack growth paris','fracture toughness stress intensity'],
      title: 'Fatigue Assessment',
      note: 'S-N curve fatigue life (Basquin), Paris crack growth law, and fracture mechanics approach (BS 7910).' },

    // SHAFT / TORSION
    { patterns: ['shaft design','shaft torsion','shaft torque','torsional stress','shaft sizing'],
      keys: ['torsional shear stress solid shaft','twist angle shaft','polar moment of inertia solid shaft','mechanical power rotational'],
      title: 'Shaft Design Under Torsion',
      note: 'Torsional shear stress, angle of twist, and power transmission for solid or hollow shafts.' },
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INTENT RESOLVER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function resolveIntent(query) {
    const q = query.toLowerCase().trim();
    let bestMatch = null, bestScore = 0;
    for (const intent of INTENT_MAP) {
        for (const pattern of intent.patterns) {
            // Exact / contains match
            if (q.includes(pattern) || pattern.includes(q)) {
                const score = pattern.length; // longer pattern = more specific
                if (score > bestScore) { bestScore = score; bestMatch = intent; }
            }
            // Token overlap
            const pTokens = pattern.split(' ');
            const qTokens = q.split(/\s+/);
            const overlap = pTokens.filter(t => t.length > 3 && qTokens.some(qt => qt.includes(t) || t.includes(qt))).length;
            const overlapScore = overlap / pTokens.length;
            if (overlapScore >= 0.6 && overlap > bestScore * 0.5) {
                bestScore = Math.max(bestScore, overlap * 5);
                if (overlap * 5 >= bestScore) bestMatch = intent;
            }
        }
    }
    return bestScore > 0 ? bestMatch : null;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FORMULA EVALUATOR ‚Äî robust symbolic substitution
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function evaluateFormula(formula, inputs) {
    // Pull the RHS of the equation
    const parts = formula.split('=');
    if (parts.length < 2) throw new Error('Cannot parse formula');
    let expr = parts.slice(1).join('=').trim();

    // Replace symbol names (longest first to avoid partial replace)
    const syms = Object.keys(inputs).sort((a,b) => b.length - a.length);
    for (const sym of syms) {
        const val = inputs[sym];
        // Escape special regex chars, match whole token
        const re = new RegExp('(?<![A-Za-z_])' + sym.replace(/[.*+?^${}()|[\]\\]/g,'\\$&') + '(?![A-Za-z_0-9])', 'g');
        expr = expr.replace(re, `(${val})`);
    }

    // Unicode math to JS
    expr = expr
        .replace(/√ó/g, '*').replace(/√∑/g, '/')
        .replace(/‚Å∞/g,'**0').replace(/¬π/g,'**1').replace(/¬≤/g,'**2')
        .replace(/¬≥/g,'**3').replace(/‚Å¥/g,'**4').replace(/‚Åµ/g,'**5')
        .replace(/‚Å∂/g,'**6').replace(/‚Å∑/g,'**7').replace(/‚Å∏/g,'**8')
        .replace(/‚Åπ/g,'**9')
        .replace(/\^(\d+\.?\d*)/g,'**$1')
        .replace(/‚àö\(([^)]+)\)/g,'Math.sqrt($1)')
        .replace(/‚àö([A-Za-z0-9_.]+)/g,'Math.sqrt($1)')
        .replace(/ln\(/g,'Math.log(')
        .replace(/log10\(/g,'Math.log10(')
        .replace(/log\(/g,'Math.log10(')
        .replace(/sin\(/g,'Math.sin(')
        .replace(/cos\(/g,'Math.cos(')
        .replace(/tan\(/g,'Math.tan(')
        .replace(/atan\(/g,'Math.atan(')
        .replace(/exp\(/g,'Math.exp(')
        .replace(/œÄ/g, 'Math.PI')
        .replace(/pi/gi, 'Math.PI')
        .replace(/·πÅ/g, 'm_dot')
        .replace(/Œ£[A-Za-z_]+/g, match => inputs[match.slice(1)] ?? match);

    // Replace any remaining standalone named symbols that are in inputs but not yet subbed
    for (const sym of syms) {
        const re2 = new RegExp('(?<![0-9.\\*\\/\\+\\-\\(])' + sym.replace(/[.*+?^${}()|[\]\\]/g,'\\$&').replace(/[_]/g, '_?') + '(?![A-Za-z_0-9\\*])', 'g');
        expr = expr.replace(re2, `(${inputs[sym]})`);
    }

    try {
        const result = Function('"use strict"; return (' + expr + ')')();
        if (!isFinite(result)) throw new Error(`Result is not finite (got ${result}). Check inputs.`);
        return result;
    } catch(e) {
        throw new Error(`Could not evaluate: ${expr.substring(0,80)} ‚Äî ${e.message}`);
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SEARCH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function searchFormula() {
    const q = document.getElementById('queryInput').value.trim();
    if (!q) return;
    setLoading(true, 'Searching ' + FORMULA_COUNT + ' formulas‚Ä¶');
    document.getElementById('resultsSection').classList.remove('visible');

    // 1. Try intent map first (multi-formula workflows)
    const intent = resolveIntent(q);
    if (intent) {
        const formulaList = intent.keys.map(k => FORMULA_DB[k]).filter(Boolean);
        if (formulaList.length > 0) {
            setLoading(false);
            displayMultiFormula(intent, formulaList);
            return;
        }
    }

    // 2. Single formula DB search
    const hits = searchDB(q);
    if (hits.length > 0) {
        const top = hits[0];
        // If top hit has a natural workflow, promote it to multi
        const autoIntent = resolveIntent(top.key.replace(/-/g,' '));
        if (autoIntent && autoIntent.keys.length > 1) {
            const formulaList = autoIntent.keys.map(k => FORMULA_DB[k]).filter(Boolean);
            if (formulaList.length > 0) {
                setLoading(false);
                displayMultiFormula(autoIntent, formulaList);
                return;
            }
        }
        currentCalc = { ...top.formula, source: 'Built-in Database (' + (top.formula.standard||'') + ')' };
        setLoading(false);
        displayResults(currentCalc, hits.slice(1, 6));
        return;
    }

    // 3. AI fallback
    if (!aiCfg.mode || !aiCfg.ready) {
        setLoading(false);
        const r = document.getElementById('resultsSection');
        r.innerHTML = `<div class="error-msg"><strong>Not found in the ${FORMULA_COUNT}-formula database.</strong>
            <div style="margin-top:0.75rem;padding:0.875rem;background:#fef3c7;border:1px solid #fde68a;border-radius:6px;display:flex;align-items:center;gap:1rem;flex-wrap:wrap">
                <p style="flex:1;color:#92400e;font-size:0.875rem">üí° Connect an AI (local or cloud) to search any engineering formula</p>
                <button style="background:#d97706;padding:0.45rem 1rem;font-size:0.82rem" onclick="openModal()">Connect AI</button>
            </div></div>`;
        r.classList.add('visible'); return;
    }
    const std  = document.getElementById('preferredStandard').value;
    const spec = document.getElementById('specificFormula').value.trim();
    setLoading(true, `Asking ${aiCfg.mode==='local'?'local AI':aiCfg.mode.toUpperCase()}‚Ä¶`);
    try {
        const raw = await callAI(
`Engineering expert. User request: "${q}".${std?` Preferred standard: ${std}.`:''}${spec?` Use formula: ${spec}.`:''}
Return ONLY this JSON (no markdown):
{"standard":"","standardName":"","description":"","formula":"","formulaDescription":"","variables":[{"symbol":"","name":"","description":"","unit":"","defaultValue":null}],"resultVariable":{"symbol":"","name":"","unit":""}}`
        );
        currentCalc = { ...parseJSON(raw), source: aiCfg.mode==='local'?`Local AI (${aiCfg.localModel.split('-')[0]})`:`AI (${aiCfg.mode})` };
        displayResults(currentCalc, []);
    } catch(e) {
        const r = document.getElementById('resultsSection');
        r.innerHTML = `<div class="error-msg"><strong>AI Error:</strong> ${e.message}</div>`;
        r.classList.add('visible');
    } finally { setLoading(false); }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MULTI-FORMULA DISPLAY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function displayMultiFormula(intent, formulaList) {
    const r = document.getElementById('resultsSection');
    const ai = aiCfg.mode && aiCfg.ready;

    // Store all formulas for multi-calc
    currentMultiCalc = formulaList.map((f, i) => ({ ...f, _idx: i }));
    currentCalc = formulaList[0]; // fallback for single-formula features

    const stepsHtml = formulaList.map((f, i) => {
        const inputs = f.variables.map((v, vi) => `
            <div class="input-field">
                <label class="input-label">${v.name} <span style="color:#64748b">(${v.symbol})</span></label>
                <div class="input-with-unit">
                    <input type="number" id="multi_${i}_${vi}" step="any"
                           placeholder="${v.defaultValue != null ? 'Default: '+v.defaultValue : 'Enter value'}"
                           value="${v.defaultValue != null ? v.defaultValue : ''}">
                    <span class="unit-label">${v.unit}</span>
                </div>
                <small style="color:#64748b;font-size:0.78rem;margin-top:0.15rem;display:block">${v.description}</small>
            </div>`).join('');

        return `
        <div class="multi-step" id="step_${i}">
            <div class="multi-step-header">
                <span class="step-number">Step ${i + 1}</span>
                <span class="step-title">${f.description ? f.description.split('.')[0] : (f.key||'').replace(/-/g,' ')}</span>
                <span class="step-standard">${f.standard || ''}</span>
            </div>
            <div class="multi-step-formula">
                <span style="font-weight:600;color:#1e293b;font-size:0.82rem">Formula: </span>
                <code style="font-size:0.88rem;color:#2563eb">${f.formula}</code>
            </div>
            <p style="font-size:0.8rem;color:#64748b;margin:0.3rem 0 0.75rem">${f.formulaDescription || ''}</p>
            <div class="multi-inputs">${inputs}</div>
            <button class="multi-calc-btn" onclick="calculateStep(${i})">
                ‚ñ∂ Calculate ${f.resultVariable.name} (${f.resultVariable.symbol})
            </button>
            <div id="multi_result_${i}" class="multi-result-box" style="display:none"></div>
        </div>`;
    }).join('');

    const aiBtn = (label, icon, cls, fn) => ai
        ? `<button class="action-btn ${cls}" onclick="${fn}">${icon} ${label}</button>`
        : `<button class="action-btn btn-locked" onclick="openModal()">${icon} ${label} üîí</button>`;

    r.innerHTML = `
        <div class="multi-workflow-header">
            <div style="display:flex;align-items:center;gap:0.75rem;flex-wrap:wrap;margin-bottom:0.5rem">
                <span style="font-size:1.25rem">üîó</span>
                <div>
                    <div style="font-size:1.05rem;font-weight:700;color:#1e293b">${intent.title}</div>
                    <div style="font-size:0.8rem;color:#64748b;margin-top:2px">${formulaList.length} formulas ¬∑ ${formulaList.map(f=>f.standard).filter((v,i,a)=>a.indexOf(v)===i).join(' ¬∑ ')}</div>
                </div>
                <button onclick="calculateAll()" style="margin-left:auto;background:#2563eb;color:white;padding:0.5rem 1.2rem;border:none;border-radius:6px;cursor:pointer;font-weight:600;font-size:0.85rem">‚ö° Calculate All</button>
            </div>
            <div style="background:#f0f9ff;border:1px solid #bae6fd;border-radius:6px;padding:0.75rem;font-size:0.82rem;color:#0c4a6e">
                üí° <strong>Workflow:</strong> ${intent.note}
            </div>
        </div>

        <div style="margin:1rem 0">
            ${stepsHtml}
        </div>

        <div class="action-buttons">
            ${aiBtn('Derivation from First Principles','üìö','btn-green','showDerivation()')}
            ${aiBtn('Relationship Graphs','üìä','btn-blue','generateGraphs()')}
            ${aiBtn('Verify with Worked Example','‚úì','btn-amber','verifyFormula()')}
        </div>
        ${!ai?`<p style="color:#64748b;font-size:0.8rem;margin-top:0.5rem">üîí AI features ‚Äî <a href="#" onclick="openModal();return false;" style="color:#2563eb">connect an AI provider</a></p>`:''}
        <div id="derivationBox"></div><div id="graphBox"></div><div id="verifyBox"></div>

        <div class="export-section">
            <h4>üíæ Export</h4>
            <div class="export-grid">
                <button class="export-btn" onclick="exportTxt()">üìÑ Export Report (.txt)</button>
                <button class="export-btn" onclick="exportCSV()">üìä Export CSV</button>
                <button class="export-btn" onclick="window.print()">üñ®Ô∏è Print</button>
            </div>
        </div>`;
    r.classList.add('visible');
}

let currentMultiCalc = [];
let multiResults = {};

function calculateStep(stepIdx) {
    const f = currentMultiCalc[stepIdx];
    if (!f) return;
    const inputs = {};
    let missing = [];

    f.variables.forEach((v, vi) => {
        const el = document.getElementById(`multi_${stepIdx}_${vi}`);
        const val = el ? parseFloat(el.value) : NaN;
        if (isNaN(val)) {
            // Try to auto-fill from a previous step's result
            const prev = findPreviousResult(v.symbol, v.name, stepIdx);
            if (prev !== null) {
                if (el) el.value = prev;
                inputs[v.symbol] = prev;
                // Visual hint
                if (el) el.style.borderColor = '#10b981';
            } else {
                missing.push(v.name);
                if (el) el.style.borderColor = '#dc2626';
            }
        } else {
            if (el) el.style.borderColor = '#e2e8f0';
            inputs[v.symbol] = val;
        }
    });

    const box = document.getElementById(`multi_result_${stepIdx}`);
    box.style.display = 'block';

    if (missing.length > 0) {
        box.innerHTML = `<div class="error-msg">‚ö† Please fill in: <strong>${missing.join(', ')}</strong></div>`;
        return;
    }

    try {
        const result = evaluateFormula(f.formula, inputs);
        multiResults[f.resultVariable.symbol] = result;
        multiResults[f.resultVariable.name] = result;
        // Also store under common aliases
        storeResultAliases(f.resultVariable.symbol, f.resultVariable.name, result);

        box.innerHTML = `
            <div class="result-box">
                <div class="result-label">${f.resultVariable.name}</div>
                <div class="result-value" style="font-size:1.6rem">${fmt(result)}</div>
                <div class="result-unit">${f.resultVariable.unit}</div>
                <div class="result-steps" style="font-size:0.78rem;margin-top:0.4rem">
                    ${f.formula} = <strong>${fmt(result)} ${f.resultVariable.unit}</strong>
                </div>
            </div>`;

        // Auto-propagate to downstream steps
        propagateResult(f.resultVariable.symbol, result, stepIdx);

        // Highlight next step
        const nextStep = document.getElementById(`step_${stepIdx + 1}`);
        if (nextStep) {
            nextStep.style.borderColor = '#2563eb';
            nextStep.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    } catch(e) {
        box.innerHTML = `<div class="error-msg"><strong>Calculation error:</strong> ${e.message}</div>`;
    }
}

function calculateAll() {
    for (let i = 0; i < currentMultiCalc.length; i++) {
        calculateStep(i);
    }
}

// Find a result from a previous step that matches this variable
function findPreviousResult(symbol, name, currentStepIdx) {
    if (multiResults[symbol] !== undefined) return multiResults[symbol];
    if (multiResults[name] !== undefined) return multiResults[name];
    // Fuzzy match on result variable names
    for (const [key, val] of Object.entries(multiResults)) {
        if (key.toLowerCase() === symbol.toLowerCase()) return val;
        if (symbol.length > 2 && key.toLowerCase().includes(symbol.toLowerCase())) return val;
    }
    return null;
}

function storeResultAliases(symbol, name, value) {
    multiResults[symbol] = value;
    multiResults[name] = value;
    // Common aliases
    const aliases = {
        'A': ['area','cross-sectional area','pipe area'],
        'I': ['second moment of area','moment of inertia'],
        'Q': ['flow rate','volumetric flow rate'],
        'v': ['velocity','flow velocity'],
        'Re': ['reynolds number'],
        'f': ['friction factor','darcy friction factor'],
        'ŒîP': ['pressure drop','pressure difference'],
        'H': ['head','pump head','total head'],
        'Nu': ['nusselt number'],
        'h': ['heat transfer coefficient'],
    };
    if (aliases[symbol]) {
        aliases[symbol].forEach(a => { multiResults[a] = value; });
    }
}

// Auto-fill matching inputs in later steps
function propagateResult(symbol, value, fromStepIdx) {
    for (let si = fromStepIdx + 1; si < currentMultiCalc.length; si++) {
        const f = currentMultiCalc[si];
        f.variables.forEach((v, vi) => {
            if (v.symbol === symbol || v.symbol.toLowerCase() === symbol.toLowerCase()) {
                const el = document.getElementById(`multi_${si}_${vi}`);
                if (el && !el.value) {
                    el.value = value;
                    el.style.borderColor = '#10b981';
                    el.title = `Auto-filled from Step ${fromStepIdx + 1} result`;
                }
            }
        });
    }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SINGLE FORMULA DISPLAY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function displayResults(d, related=[]) {
    const r = document.getElementById('resultsSection');
    const ai = aiCfg.mode && aiCfg.ready;
    currentMultiCalc = [];

    const varHtml = d.variables.map(v =>
        `<div class="variable-item"><strong>${v.symbol}</strong> ‚Äî ${v.name} (${v.unit}): ${v.description}</div>`
    ).join('');

    const inpHtml = d.variables.map((v, i) => `
        <div class="input-field">
            <label class="input-label">${v.name} <span style="color:#64748b">(${v.symbol})</span></label>
            <div class="input-with-unit">
                <input type="number" id="inp_${i}" step="any"
                       placeholder="${v.defaultValue != null ? 'Default: '+v.defaultValue : 'Enter value'}"
                       value="${v.defaultValue != null ? v.defaultValue : ''}">
                <span class="unit-label">${v.unit}</span>
            </div>
            <small style="color:#64748b;font-size:0.78rem;margin-top:0.2rem;display:block">${v.description}</small>
        </div>`).join('');

    const relatedHtml = related.length > 0 ? `
        <div style="margin-bottom:1.5rem;padding:1rem;background:#f0f9ff;border-radius:8px;border:1px solid #bae6fd">
            <div style="font-size:0.82rem;font-weight:600;color:#0369a1;margin-bottom:0.6rem">üîó Related Formulas</div>
            <div style="display:flex;flex-wrap:wrap;gap:0.5rem">
                ${related.map(h=>`<span class="example-tag" style="cursor:pointer" onclick="loadFormula('${h.key}')">${h.formula.cat}: ${h.key.replace(/-/g,' ')}</span>`).join('')}
            </div>
        </div>` : '';

    const aiBtn = (label, icon, cls, fn) => ai
        ? `<button class="action-btn ${cls}" onclick="${fn}">${icon} ${label}</button>`
        : `<button class="action-btn btn-locked" onclick="openModal()">${icon} ${label} üîí</button>`;

    r.innerHTML = `
        ${relatedHtml}
        <div class="standard-info">
            <div style="display:flex;align-items:center;gap:0.6rem;margin-bottom:0.5rem;flex-wrap:wrap">
                <span style="background:#dbeafe;color:#1e40af;padding:0.2rem 0.6rem;border-radius:99px;font-size:0.75rem;font-weight:600">${d.cat||'Engineering'}</span>
                <span style="background:#f1f5f9;color:#475569;padding:0.2rem 0.6rem;border-radius:99px;font-size:0.75rem">${d.standard}</span>
            </div>
            <div class="standard-header">
                <div class="standard-title">${d.standardName}</div>
                <div class="copy-btns">
                    <button class="copy-btn" onclick="copyRef()">üìã Copy Reference</button>
                    <button class="copy-btn" onclick="copyFormula()">üìê Copy Formula</button>
                </div>
            </div>
            <div class="standard-description">${d.description}</div>
            <strong style="color:#1e293b;font-size:0.875rem">Formula:</strong>
            <div class="formula-box" id="formulaBox">${d.formula}</div>
            <p style="color:#64748b;font-size:0.82rem;margin-top:0.4rem">${d.formulaDescription}</p>
            <div class="variables-list" style="margin-top:0.75rem">
                <strong style="color:#1e293b;font-size:0.875rem;display:block;margin-bottom:0.4rem">Variables:</strong>
                ${varHtml}
            </div>
        </div>

        <div class="action-buttons">
            ${aiBtn('Derivation from First Principles','üìö','btn-green','showDerivation()')}
            ${aiBtn('Relationship Graphs','üìä','btn-blue','generateGraphs()')}
            ${aiBtn('Verify with Worked Example','‚úì','btn-amber','verifyFormula()')}
        </div>
        ${!ai?`<p style="color:#64748b;font-size:0.8rem;margin-top:0.5rem">üîí AI features ‚Äî <a href="#" onclick="openModal();return false;" style="color:#2563eb">connect an AI provider</a></p>`:''}
        <div id="derivationBox"></div><div id="graphBox"></div><div id="verifyBox"></div>

        <div class="calculator-section">
            <div class="calc-header">üßÆ Interactive Calculator</div>
            ${inpHtml}
            <button onclick="calculate()" style="width:100%;margin-top:0.5rem">Calculate</button>
            <div id="resultBox"></div>
        </div>

        <div class="export-section">
            <h4>üíæ Export</h4>
            <div class="export-grid">
                <button class="export-btn" onclick="exportTxt()">üìÑ Export Report (.txt)</button>
                <button class="export-btn" onclick="exportCSV()">üìä Export CSV</button>
                <button class="export-btn" onclick="window.print()">üñ®Ô∏è Print</button>
            </div>
        </div>

        <div class="meta-section">
            <div class="meta-row"><span class="meta-label">Source</span><span>${d.source||'Built-in'}</span></div>
            <div class="meta-row"><span class="meta-label">Category</span><span>${d.cat||'‚Äî'}</span></div>
            <div class="meta-row"><span class="meta-label">Standard</span><span>${d.standard}</span></div>
            <div class="meta-row"><span class="meta-label">Generated</span><span>${new Date().toLocaleString()}</span></div>
        </div>`;
    r.classList.add('visible');
}

function loadFormula(key) {
    const f = FORMULA_DB[key];
    if (!f) return;
    currentCalc = { ...f, source:'Built-in Database' };
    const intent = resolveIntent(key.replace(/-/g,' '));
    if (intent && intent.keys.length > 1) {
        const formulaList = intent.keys.map(k => FORMULA_DB[k]).filter(Boolean);
        displayMultiFormula(intent, formulaList);
    } else {
        displayResults(currentCalc, searchDB(key).slice(1,5));
    }
    document.getElementById('resultsSection').scrollIntoView({behavior:'smooth'});
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SINGLE FORMULA CALCULATOR (uses new evaluator)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calculate() {
    const inputs = {}; let missing = [];
    currentCalc.variables.forEach((v, i) => {
        const el = document.getElementById(`inp_${i}`);
        const val = parseFloat(el.value);
        if (isNaN(val)) { el.style.borderColor = '#dc2626'; missing.push(v.name); }
        else { el.style.borderColor = '#e2e8f0'; inputs[v.symbol] = val; }
    });
    const box = document.getElementById('resultBox');
    if (missing.length > 0) {
        box.innerHTML = `<div class="error-msg">Please fill in: <strong>${missing.join(', ')}</strong></div>`;
        return;
    }
    try {
        const result = evaluateFormula(currentCalc.formula, inputs);
        box.innerHTML = `
            <div class="result-box">
                <div class="result-label">${currentCalc.resultVariable.name}</div>
                <div class="result-value">${fmt(result)}</div>
                <div class="result-unit">${currentCalc.resultVariable.unit}</div>
                <div class="result-steps">Formula: ${currentCalc.formula}</div>
            </div>`;
    } catch(e) {
        box.innerHTML = `<div class="error-msg"><strong>Error:</strong> ${e.message}</div>`;
    }
}
function fmt(n) {
    if (n === 0) return '0';
    if (Math.abs(n) < 0.001 || Math.abs(n) > 999999) return n.toExponential(4);
    return parseFloat(n.toPrecision(5)).toString();
}

// ‚îÄ‚îÄ AI Features ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function showDerivation() {
    const box=document.getElementById('derivationBox');
    box.innerHTML='<div class="loading"><div class="spinner"></div><p>Deriving from first principles‚Ä¶</p></div>';
    try {
        const d=parseJSON(await callAI(
`Derive: ${currentCalc.formula} (${currentCalc.standard}).
Return JSON only: {"fundamentalPrinciples":[{"name":"","description":""}],"derivationSteps":[{"stepNumber":1,"title":"","explanation":"","equation":""}],"assumptions":[""],"references":[{"type":"","citation":""}]}`
        ));
        box.innerHTML=`<div class="derivation-content">
            <h3 style="color:#1e293b;margin-bottom:1rem;font-weight:700">üìê Derivation from First Principles</h3>
            <h4 style="color:#1e293b;margin-bottom:0.5rem">Fundamental Principles</h4>
            <ul class="step-list">${d.fundamentalPrinciples.map(p=>`<li><strong>${p.name}:</strong> ${p.description}</li>`).join('')}</ul>
            <h4 style="color:#1e293b;margin:1rem 0 0.5rem">Steps</h4>
            ${d.derivationSteps.map(s=>`<div class="derivation-step"><h4>Step ${s.stepNumber}: ${s.title}</h4><p>${s.explanation}</p><div class="derivation-eq">${s.equation}</div></div>`).join('')}
            <h4 style="color:#1e293b;margin:1rem 0 0.5rem">Assumptions</h4>
            <ul class="step-list">${d.assumptions.map(a=>`<li>${a}</li>`).join('')}</ul>
            <h4 style="color:#1e293b;margin:1rem 0 0.5rem">References</h4>
            <ul class="step-list">${d.references.map(r=>`<li><strong>${r.type}:</strong> ${r.citation}</li>`).join('')}</ul>
        </div>`;
    } catch(e){ box.innerHTML=`<div class="error-msg">Derivation error: ${e.message}</div>`; }
}

async function generateGraphs() {
    const box=document.getElementById('graphBox');
    box.innerHTML='<div class="loading"><div class="spinner"></div><p>Generating graphs‚Ä¶</p></div>';
    try {
        const {graphs}=parseJSON(await callAI(
`Formula: ${currentCalc.formula}, variables: ${JSON.stringify(currentCalc.variables)}.
Show how result changes as each key variable varies, holding others constant at realistic engineering values.
Return JSON only: {"graphs":[{"title":"","xVariable":{"symbol":"","name":"","unit":""},"yVariable":{"symbol":"","name":"","unit":""},"baseValues":{},"xValues":[],"yValues":[]}]}`
        ));
        let html='<div class="graph-section"><h3>üìä Variable Relationships</h3>';
        graphs.forEach((g,i)=>{
            html+=`<div style="margin-bottom:1.5rem"><h4 style="color:#475569;font-size:0.9rem;margin-bottom:0.25rem">${g.title}</h4>
                <p style="font-size:0.78rem;color:#64748b;margin-bottom:0.5rem">Held constant: ${Object.entries(g.baseValues).map(([k,v])=>`${k}=${v}`).join(', ')}</p>
                <div class="graph-container"><canvas id="ch_${i}"></canvas></div></div>`;
        });
        html+='</div>';
        box.innerHTML=html;
        graphs.forEach((g,i)=>new Chart(document.getElementById(`ch_${i}`).getContext('2d'),{type:'line',
            data:{labels:g.xValues.map(String),datasets:[{label:`${g.yVariable.name} (${g.yVariable.unit})`,data:g.yValues,borderColor:'#2563eb',backgroundColor:'rgba(37,99,235,0.08)',borderWidth:2.5,pointRadius:4,tension:0.4}]},
            options:{responsive:true,plugins:{legend:{position:'top'}},scales:{x:{title:{display:true,text:`${g.xVariable.name} (${g.xVariable.unit})`},grid:{color:'rgba(0,0,0,0.05)'}},y:{title:{display:true,text:`${g.yVariable.name} (${g.yVariable.unit})`},grid:{color:'rgba(0,0,0,0.05)'}}}}
        }));
    } catch(e){ box.innerHTML=`<div class="error-msg">Graph error: ${e.message}</div>`; }
}

async function verifyFormula() {
    const box=document.getElementById('verifyBox');
    box.innerHTML='<div class="loading"><div class="spinner"></div><p>Searching for a published worked example‚Ä¶</p></div>';
    try {
        const v=parseJSON(await callAI(
`Find a well-known published worked example for formula: ${currentCalc.formula} (${currentCalc.standard}).
Return JSON only: {"source":"","exampleInputs":{},"exampleResult":0,"exampleUnit":"","calculationSteps":[],"verification":"matches or differs","notes":""}`
        ));
        const mc=v.verification.toLowerCase().includes('match');
        box.innerHTML=`<div class="verification-section">
            <h3>üîç Formula Verification</h3>
            <div class="verification-content">
                <strong>Source:</strong> ${v.source}
                <div class="verify-example">
                    <strong>Example Inputs:</strong><br>${Object.entries(v.exampleInputs).map(([k,val])=>`${k} = ${val}`).join('<br>')}
                    <br><strong>Expected Result:</strong> ${v.exampleResult} ${v.exampleUnit}
                </div>
                <strong>Calculation Steps:</strong>
                <ol style="padding-left:1.25rem;margin:0.5rem 0;font-size:0.875rem;color:#475569">
                    ${v.calculationSteps.map(s=>`<li style="margin:0.3rem 0">${s}</li>`).join('')}
                </ol>
                <div class="${mc?'verify-match':'verify-mismatch'}">${mc?'‚úì Formula Verified':'‚ö† Result Differs'}</div>
                ${v.notes?`<p style="margin-top:0.75rem;font-size:0.82rem;color:#64748b">${v.notes}</p>`:''}
            </div>
        </div>`;
    } catch(e){ box.innerHTML=`<div class="error-msg">Verification error: ${e.message}</div>`; }
}

// ‚îÄ‚îÄ Utilities ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function useExample(t){document.getElementById('queryInput').value=t;searchFormula();}
function toggleAdvanced(){const c=document.getElementById('advContent'),i=document.getElementById('advIcon');c.classList.toggle('open');i.textContent=c.classList.contains('open')?'‚ñº':'‚ñ∂';}
function setLoading(on,msg=''){document.getElementById('loadingSection').style.display=on?'block':'none';document.getElementById('loadingMsg').textContent=msg;document.getElementById('searchBtn').disabled=on;}
function showToast(msg,ok=true){const t=document.getElementById('toast');document.getElementById('toastMsg').textContent=msg;t.className='toast show '+(ok?'success':'fail');setTimeout(()=>t.classList.remove('show'),4000);}

function copyRef(){if(!currentCalc)return;navigator.clipboard.writeText(`${currentCalc.standard} ‚Äî ${currentCalc.standardName}\n${currentCalc.description}\n\nFormula: ${currentCalc.formula}\nGenerated: ${new Date().toLocaleString()}\nShan's Engineering Calculator`).then(()=>showToast('Reference copied!')).catch(()=>showToast('Copy failed',false));}
function copyFormula(){const el=document.getElementById('formulaBox');if(!el)return;navigator.clipboard.writeText(el.textContent).then(()=>showToast('Formula copied!')).catch(()=>showToast('Copy failed',false));}

function exportTxt(){if(!currentCalc)return;const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([`SHAN'S ENGINEERING CALCULATOR\n${'='.repeat(40)}\n\nStandard: ${currentCalc.standard} ‚Äî ${currentCalc.standardName}\nDescription: ${currentCalc.description}\n\nFormula: ${currentCalc.formula}\n${currentCalc.formulaDescription}\n\nVariables:\n${currentCalc.variables.map(v=>`  ${v.symbol} = ${v.name} (${v.unit}) ‚Äî ${v.description}`).join('\n')}\n\nGenerated: ${new Date().toLocaleString()}\nSource: ${currentCalc.source||'Built-in'}`],{type:'text/plain'}));a.download='engineering-calc-report.txt';a.click();showToast('Report exported!');}
function exportCSV(){if(!currentCalc)return;const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([`Standard,${currentCalc.standard}\nName,"${currentCalc.standardName}"\nFormula,"${currentCalc.formula}"\n\nSymbol,Name,Unit,Description\n${currentCalc.variables.map(v=>`${v.symbol},"${v.name}",${v.unit},"${v.description}"`).join('\n')}`],{type:'text/csv'}));a.download='engineering-calc.csv';a.click();showToast('CSV exported!');}

// ‚îÄ‚îÄ Formula Browser Init ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleBrowser() {
    const body  = document.getElementById('browserBody');
    const arrow = document.getElementById('browserArrow');
    const open  = body.style.display === 'none';
    body.style.display  = open ? 'block' : 'none';
    arrow.textContent   = open ? '‚ñº' : '‚ñ∂';
    if (open) initBrowserContent();
}

let browserInitialised = false;
function initBrowserContent() {
    if (browserInitialised) return;
    browserInitialised = true;
    const stats = document.getElementById('dbStats');
    const tabs  = document.getElementById('categoryTabs');
    if (stats) stats.textContent = `${FORMULA_COUNT} formulas across ${CATEGORIES.length} engineering disciplines`;

    let activeCat = CATEGORIES[0];

    function renderCards(cat) {
        const grid = document.getElementById('formulaGrid');
        if (!grid) return;
        const entries = Object.entries(FORMULA_DB).filter(([,f]) => f.cat === cat);
        grid.innerHTML = entries.map(([key,f]) => `
            <div class="formula-card" onclick="quickLoad('${key}')">
                <div class="formula-card-title">${key.replace(/-/g,' ').replace(/\b\w/g,c=>c.toUpperCase())}</div>
                <div class="formula-card-standard">${f.standard}</div>
                <div class="formula-card-formula">${f.formula}</div>
            </div>`).join('');
    }

    if (tabs) {
        CATEGORIES.forEach(cat => {
            const btn = document.createElement('button');
            btn.className = 'cat-tab' + (cat === activeCat ? ' active' : '');
            btn.textContent = cat;
            btn.onclick = () => {
                activeCat = cat;
                tabs.querySelectorAll('.cat-tab').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderCards(cat);
            };
            tabs.appendChild(btn);
        });
        renderCards(activeCat);
    }
}

function quickLoad(key) {
    const f = FORMULA_DB[key];
    if (!f) return;
    currentCalc = { ...f, source:'Built-in Database' };
    document.getElementById('queryInput').value = key;
    displayResults(currentCalc, searchDB(key).slice(1,5));
    document.getElementById('resultsSection').scrollIntoView({behavior:'smooth'});
}

// Autocomplete
document.addEventListener('DOMContentLoaded', function() {
    // Autocomplete
    const qi = document.getElementById('queryInput');
    if (qi) {
        qi.addEventListener('input', function() {
            const q = this.value.trim();
            let list = document.getElementById('autocompleteList');
            if (!list) {
                list = document.createElement('div');
                list.id = 'autocompleteList';
                list.style.cssText = 'position:absolute;background:white;border:1px solid #e2e8f0;border-radius:6px;box-shadow:0 4px 12px rgba(0,0,0,0.1);z-index:100;max-height:220px;overflow-y:auto;width:100%;top:100%;left:0';
                this.parentElement.style.position='relative';
                this.parentElement.appendChild(list);
            }
            if (q.length < 2) { list.innerHTML=''; return; }
            const hits = searchDB(q).slice(0,8);
            list.innerHTML = hits.map(h=>`
                <div onclick="quickLoad('${h.key}');document.getElementById('autocompleteList').innerHTML=''"
                     style="padding:0.6rem 0.875rem;cursor:pointer;border-bottom:1px solid #f1f5f9;font-size:0.85rem"
                     onmouseover="this.style.background='#eff6ff'" onmouseout="this.style.background='white'">
                    <span style="font-weight:500;color:#1e293b">${h.key.replace(/-/g,' ')}</span>
                    <span style="color:#64748b;font-size:0.75rem;margin-left:0.5rem">${h.formula.standard}</span>
                    <span style="float:right;background:#dbeafe;color:#1e40af;padding:0.1rem 0.4rem;border-radius:99px;font-size:0.7rem">${h.formula.cat}</span>
                </div>`).join('');
        });
    }

    document.addEventListener('click', e => {
        const list = document.getElementById('autocompleteList');
        if (list && !e.target.closest('#queryInput')) list.innerHTML='';
    });

    // Set browser stats text (cards render lazily on first open)
    const stats = document.getElementById('dbStats');
    if (stats) stats.textContent = `${FORMULA_COUNT} formulas ¬∑ ${CATEGORIES.length} categories`;
});

</script>
</body>
</html>
